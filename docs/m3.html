<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 3 Module III | Introduction to Data Analysis with R and the Tidyverse</title>
  <meta name="description" content="Textbook accompanying the Introductory Course on Data Analysis in R using Tidyverse." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content=" 3 Module III | Introduction to Data Analysis with R and the Tidyverse" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://allanvc.github.io/book_IDART_en/img/cover_dark_v2.jpg" />
  <meta property="og:description" content="Textbook accompanying the Introductory Course on Data Analysis in R using Tidyverse." />
  <meta name="github-repo" content="allanvc/book_IADR-T" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 3 Module III | Introduction to Data Analysis with R and the Tidyverse" />
  
  <meta name="twitter:description" content="Textbook accompanying the Introductory Course on Data Analysis in R using Tidyverse." />
  <meta name="twitter:image" content="https://allanvc.github.io/book_IDART_en/img/cover_dark_v2.jpg" />

<meta name="author" content="Allan Quadros, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="img/apple-touch-icon.png" />
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="m2.html"/>
<link rel="next" href="m4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.3/leaflet.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Data Analysis with R and the Tidyverse</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i>Why R?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-organization"><i class="fa fa-check"></i>Course Organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="m1.html"><a href="m1.html"><i class="fa fa-check"></i><b>1</b> Module I</a>
<ul>
<li class="chapter" data-level="1.1" data-path="m1.html"><a href="m1.html#first-steps"><i class="fa fa-check"></i><b>1.1</b> First Steps</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="m1.html"><a href="m1.html#brief-history"><i class="fa fa-check"></i><b>1.1.1</b> Brief History</a></li>
<li class="chapter" data-level="1.1.2" data-path="m1.html"><a href="m1.html#installing-r"><i class="fa fa-check"></i><b>1.1.2</b> Installing <strong>R</strong></a></li>
<li class="chapter" data-level="1.1.3" data-path="m1.html"><a href="m1.html#installing-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> Installing <strong>RStudio</strong></a></li>
<li class="chapter" data-level="1.1.4" data-path="m1.html"><a href="m1.html#installing-rtools-on-windows"><i class="fa fa-check"></i><b>1.1.4</b> Installing <strong>RTools</strong> on Windows</a></li>
<li class="chapter" data-level="1.1.5" data-path="m1.html"><a href="m1.html#basic-functionalities-of-r-and-rstudio"><i class="fa fa-check"></i><b>1.1.5</b> Basic Functionalities of R and RStudio</a></li>
<li class="chapter" data-level="1.1.6" data-path="m1.html"><a href="m1.html#r-language-structure"><i class="fa fa-check"></i><b>1.1.6</b> R Language Structure</a></li>
<li class="chapter" data-level="1.1.7" data-path="m1.html"><a href="m1.html#how-to-get-help"><i class="fa fa-check"></i><b>1.1.7</b> How to get help</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="m1.html"><a href="m1.html#r-language-object-structure"><i class="fa fa-check"></i><b>1.2</b> R Language Object Structure</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="m1.html"><a href="m1.html#vectors"><i class="fa fa-check"></i><b>1.2.1</b> Vectors</a></li>
<li class="chapter" data-level="1.2.2" data-path="m1.html"><a href="m1.html#dataframes"><i class="fa fa-check"></i><b>1.2.2</b> Dataframes</a></li>
<li class="chapter" data-level="1.2.3" data-path="m1.html"><a href="m1.html#module-references"><i class="fa fa-check"></i><b>1.2.3</b> Module References</a></li>
<li class="chapter" data-level="1.2.4" data-path="m1.html"><a href="m1.html#exercises"><i class="fa fa-check"></i><b>1.2.4</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="m2.html"><a href="m2.html"><i class="fa fa-check"></i><b>2</b> Module II</a>
<ul>
<li class="chapter" data-level="2.1" data-path="m2.html"><a href="m2.html#reading-data-in-r"><i class="fa fa-check"></i><b>2.1</b> Reading Data in R</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="m2.html"><a href="m2.html#the-tidyverse"><i class="fa fa-check"></i><b>2.1.1</b> The Tidyverse</a></li>
<li class="chapter" data-level="2.1.2" data-path="m2.html"><a href="m2.html#reading-and-exporting-data-using-readr"><i class="fa fa-check"></i><b>2.1.2</b> Reading and Exporting Data using <code>readr</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="m2.html"><a href="m2.html#writing-and-exporting-data"><i class="fa fa-check"></i><b>2.1.3</b> Writing and exporting data</a></li>
<li class="chapter" data-level="2.1.4" data-path="m2.html"><a href="m2.html#reading-data-from-stata-sas-and-spss"><i class="fa fa-check"></i><b>2.1.4</b> Reading data from Stata, SAS and SPSS</a></li>
<li class="chapter" data-level="2.1.5" data-path="m2.html"><a href="m2.html#section-references"><i class="fa fa-check"></i><b>2.1.5</b> Section References</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="m2.html"><a href="m2.html#data-manipulation-with-dplyr"><i class="fa fa-check"></i><b>2.2</b> Data Manipulation with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="m2.html"><a href="m2.html#filtering-rows-with-filter"><i class="fa fa-check"></i><b>2.2.1</b> Filtering rows with <code>filter()</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="m2.html"><a href="m2.html#ordering-rows-with-arrange"><i class="fa fa-check"></i><b>2.2.2</b> Ordering rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="2.2.3" data-path="m2.html"><a href="m2.html#selecting-columns-with-select"><i class="fa fa-check"></i><b>2.2.3</b> Selecting columns with <code>select()</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="m2.html"><a href="m2.html#adding-new-columns-with-mutate"><i class="fa fa-check"></i><b>2.2.4</b> Adding new columns with <code>mutate()</code></a></li>
<li class="chapter" data-level="2.2.5" data-path="m2.html"><a href="m2.html#modifying-entries-with-mutate-or-transmute-case_when"><i class="fa fa-check"></i><b>2.2.5</b> Modifying entries with <code>mutate()</code> or <code>transmute()</code> + <code>case_when()</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="m2.html"><a href="m2.html#summarizing-values-with-summarise"><i class="fa fa-check"></i><b>2.2.6</b> Summarizing values with <code>summarise()</code></a></li>
<li class="chapter" data-level="2.2.7" data-path="m2.html"><a href="m2.html#dplyr-structure"><i class="fa fa-check"></i><b>2.2.7</b> <code>dplyr</code> Structure</a></li>
<li class="chapter" data-level="2.2.8" data-path="m2.html"><a href="m2.html#using-the-pipe"><i class="fa fa-check"></i><b>2.2.8</b> Using the Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.2.9" data-path="m2.html"><a href="m2.html#section-references-1"><i class="fa fa-check"></i><b>2.2.9</b> Section References</a></li>
<li class="chapter" data-level="2.2.10" data-path="m2.html"><a href="m2.html#exercises-1"><i class="fa fa-check"></i><b>2.2.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="m2.html"><a href="m2.html#graphics-with-ggplot2"><i class="fa fa-check"></i><b>2.3</b> Graphics with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="m2.html"><a href="m2.html#introduction"><i class="fa fa-check"></i><b>2.3.1</b> Introduction</a></li>
<li class="chapter" data-level="2.3.2" data-path="m2.html"><a href="m2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>2.3.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="2.3.3" data-path="m2.html"><a href="m2.html#data"><i class="fa fa-check"></i><b>2.3.3</b> Data</a></li>
<li class="chapter" data-level="2.3.4" data-path="m2.html"><a href="m2.html#the-ggplot-function"><i class="fa fa-check"></i><b>2.3.4</b> The <code>ggplot()</code> function</a></li>
<li class="chapter" data-level="2.3.5" data-path="m2.html"><a href="m2.html#aesthetics-aesthetic-elements-of-graphics"><i class="fa fa-check"></i><b>2.3.5</b> Aesthetics (aesthetic elements of graphics)</a></li>
<li class="chapter" data-level="2.3.6" data-path="m2.html"><a href="m2.html#examples-for-aesthetics"><i class="fa fa-check"></i><b>2.3.6</b> Examples for <em>aesthetics</em></a></li>
<li class="chapter" data-level="2.3.7" data-path="m2.html"><a href="m2.html#geoms"><i class="fa fa-check"></i><b>2.3.7</b> Geoms</a></li>
<li class="chapter" data-level="2.3.8" data-path="m2.html"><a href="m2.html#examples-for-geoms"><i class="fa fa-check"></i><b>2.3.8</b> Examples for <em>Geoms</em></a></li>
<li class="chapter" data-level="2.3.9" data-path="m2.html"><a href="m2.html#facetting"><i class="fa fa-check"></i><b>2.3.9</b> Facetting</a></li>
<li class="chapter" data-level="2.3.10" data-path="m2.html"><a href="m2.html#titles-labels-themes-and-legends"><i class="fa fa-check"></i><b>2.3.10</b> Titles, labels, themes and legends</a></li>
<li class="chapter" data-level="2.3.11" data-path="m2.html"><a href="m2.html#changing-colors-and-color-palette"><i class="fa fa-check"></i><b>2.3.11</b> Changing colors and color palette</a></li>
<li class="chapter" data-level="2.3.12" data-path="m2.html"><a href="m2.html#plot-area-and-theme"><i class="fa fa-check"></i><b>2.3.12</b> Plot Area and Theme</a></li>
<li class="chapter" data-level="2.3.13" data-path="m2.html"><a href="m2.html#section-references-2"><i class="fa fa-check"></i><b>2.3.13</b> Section References</a></li>
<li class="chapter" data-level="2.3.14" data-path="m2.html"><a href="m2.html#exercises-2"><i class="fa fa-check"></i><b>2.3.14</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="m3.html"><a href="m3.html"><i class="fa fa-check"></i><b>3</b> Module III</a>
<ul>
<li class="chapter" data-level="3.1" data-path="m3.html"><a href="m3.html#accessing-relational-databases-with-dbplyr"><i class="fa fa-check"></i><b>3.1</b> Accessing Relational Databases with <code>dbplyr</code></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="m3.html"><a href="m3.html#introduction-1"><i class="fa fa-check"></i><b>3.1.1</b> Introduction</a></li>
<li class="chapter" data-level="3.1.2" data-path="m3.html"><a href="m3.html#connecting-to-a-database"><i class="fa fa-check"></i><b>3.1.2</b> Connecting to a database</a></li>
<li class="chapter" data-level="3.1.3" data-path="m3.html"><a href="m3.html#generating-queries"><i class="fa fa-check"></i><b>3.1.3</b> Generating queries</a></li>
<li class="chapter" data-level="3.1.4" data-path="m3.html"><a href="m3.html#section-references-3"><i class="fa fa-check"></i><b>3.1.4</b> Section References</a></li>
<li class="chapter" data-level="3.1.5" data-path="m3.html"><a href="m3.html#exercises-3"><i class="fa fa-check"></i><b>3.1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="m3.html"><a href="m3.html#data-manipulation-with-two-table-verbs---dplyr"><i class="fa fa-check"></i><b>3.2</b> Data Manipulation with <em>Two-table verbs</em> - <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="m3.html"><a href="m3.html#mutating-joins"><i class="fa fa-check"></i><b>3.2.1</b> <em>Mutating joins</em></a></li>
<li class="chapter" data-level="3.2.2" data-path="m3.html"><a href="m3.html#filtering-joins"><i class="fa fa-check"></i><b>3.2.2</b> <em>Filtering joins</em></a></li>
<li class="chapter" data-level="3.2.3" data-path="m3.html"><a href="m3.html#section-references-4"><i class="fa fa-check"></i><b>3.2.3</b> Section References</a></li>
<li class="chapter" data-level="3.2.4" data-path="m3.html"><a href="m3.html#exercises-4"><i class="fa fa-check"></i><b>3.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="m3.html"><a href="m3.html#geographic-data-analysis-in-r"><i class="fa fa-check"></i><b>3.3</b> Geographic Data Analysis in <strong>R</strong></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="m3.html"><a href="m3.html#introduction-2"><i class="fa fa-check"></i><b>3.3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.3.2" data-path="m3.html"><a href="m3.html#map-production-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Map Production in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="m3.html"><a href="m3.html#exporting-geographic-data"><i class="fa fa-check"></i><b>3.3.3</b> Exporting geographic data</a></li>
<li class="chapter" data-level="3.3.4" data-path="m3.html"><a href="m3.html#section-references-5"><i class="fa fa-check"></i><b>3.3.4</b> Section References</a></li>
<li class="chapter" data-level="3.3.5" data-path="m3.html"><a href="m3.html#exercises-5"><i class="fa fa-check"></i><b>3.3.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="m4.html"><a href="m4.html"><i class="fa fa-check"></i><b>4</b> Module IV</a>
<ul>
<li class="chapter" data-level="4.1" data-path="m4.html"><a href="m4.html#string-manipulation-in-r-with-stringr"><i class="fa fa-check"></i><b>4.1</b> String Manipulation in R with <code>stringr</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="m4.html"><a href="m4.html#introduction-3"><i class="fa fa-check"></i><b>4.1.1</b> Introduction</a></li>
<li class="chapter" data-level="4.1.2" data-path="m4.html"><a href="m4.html#operations-with-individual-characters"><i class="fa fa-check"></i><b>4.1.2</b> Operations with individual characters</a></li>
<li class="chapter" data-level="4.1.3" data-path="m4.html"><a href="m4.html#pattern-matching"><i class="fa fa-check"></i><b>4.1.3</b> Pattern matching</a></li>
<li class="chapter" data-level="4.1.4" data-path="m4.html"><a href="m4.html#section-references-6"><i class="fa fa-check"></i><b>4.1.4</b> Section References</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="m4.html"><a href="m4.html#regular-expressions-regex"><i class="fa fa-check"></i><b>4.2</b> Regular Expressions (REGEX)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="m4.html"><a href="m4.html#introduction-4"><i class="fa fa-check"></i><b>4.2.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2.2" data-path="m4.html"><a href="m4.html#regex-examples-using-stringr"><i class="fa fa-check"></i><b>4.2.2</b> REGEX Examples using <code>stringr</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="m4.html"><a href="m4.html#section-references-7"><i class="fa fa-check"></i><b>4.2.3</b> Section References</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="m4.html"><a href="m4.html#reports-and-reproducible-research-with-rmarkdown"><i class="fa fa-check"></i><b>4.3</b> Reports and Reproducible Research with <code>rmarkdown</code></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="m4.html"><a href="m4.html#introduction-5"><i class="fa fa-check"></i><b>4.3.1</b> Introduction</a></li>
<li class="chapter" data-level="4.3.2" data-path="m4.html"><a href="m4.html#header"><i class="fa fa-check"></i><b>4.3.2</b> Header</a></li>
<li class="chapter" data-level="4.3.3" data-path="m4.html"><a href="m4.html#text-formatting"><i class="fa fa-check"></i><b>4.3.3</b> Text Formatting</a></li>
<li class="chapter" data-level="4.3.4" data-path="m4.html"><a href="m4.html#inserting-external-figures"><i class="fa fa-check"></i><b>4.3.4</b> Inserting external figures</a></li>
<li class="chapter" data-level="4.3.5" data-path="m4.html"><a href="m4.html#inserting-links"><i class="fa fa-check"></i><b>4.3.5</b> Inserting links</a></li>
<li class="chapter" data-level="4.3.6" data-path="m4.html"><a href="m4.html#mathematical-formulas"><i class="fa fa-check"></i><b>4.3.6</b> Mathematical formulas</a></li>
<li class="chapter" data-level="4.3.7" data-path="m4.html"><a href="m4.html#code-insertion-and-execution"><i class="fa fa-check"></i><b>4.3.7</b> Code insertion and execution</a></li>
<li class="chapter" data-level="4.3.8" data-path="m4.html"><a href="m4.html#more-sophisticated-tables"><i class="fa fa-check"></i><b>4.3.8</b> More sophisticated tables</a></li>
<li class="chapter" data-level="4.3.9" data-path="m4.html"><a href="m4.html#section-references-8"><i class="fa fa-check"></i><b>4.3.9</b> Section References</a></li>
<li class="chapter" data-level="4.3.10" data-path="m4.html"><a href="m4.html#exercises-6"><i class="fa fa-check"></i><b>4.3.10</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Analysis with R and the Tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="m3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number"> 3</span> Module III<a href="m3.html#m3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="accessing-relational-databases-with-dbplyr" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Accessing Relational Databases with <code>dbplyr</code><a href="m3.html#accessing-relational-databases-with-dbplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-1" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Introduction<a href="m3.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The content of this chapter was adapted from the <code>dbplyr</code> <em>vignette</em> and the article <em>Databases using R</em> by Edgar Ruiz, package author and member of <strong>RStudio</strong>. <code>dbplyr</code> allows combining the easy data manipulation grammar provided by <code>dplyr</code> with access to SQL relational databases without actually needing to use <strong>SQL</strong> commands.</p>
<p>Using databases is inevitable for those whose work involves data analysis. At this point, as users of the <code>R</code> language, instinct leads us to adopt an <em>approach</em> with databases in the same way we would read a <code>.txt</code> or <code>.csv</code> data file: we would try to read all the data at once or parts of it until forming the entire dataset. The goal would be to “return” to the database as little as possible, so that our <em>queries</em> would extract as much data as possible. After that, we would spend several cycles analyzing that data saved in our computer’s memory. We would follow roughly this scheme:</p>
<!-- \newline -->
<p><img src="fig/todaydb.png" alt="R &amp; Database Access NOT optimized" />
Source: <em>Databases using R</em>, Edgar Ruiz</p>
<p>This approach has some problems:</p>
<ul>
<li><p>the volume of data we would have to work with would be very large. Therefore, we would spend some time thinking about how to minimize resource consumption and time to arrive at the subset of data we actually need to work with;</p></li>
<li><p>to save resources, we would opt to directly use an external SQL client, work the data as much as possible to then extract what interests us and only then use <strong>R</strong>;</p></li>
<li><p>we would need to know SQL in depth to make as many queries as possible using a “<em>client</em>” of <em>SQL Server</em> for example. We would save different scripts so we could repeat the queries again;</p></li>
</ul>
<p>What would be the best approach then?</p>
<p><img src="fig/betterdb.png" alt="R &amp; Database Access optimized" />
Source: <em>Databases using R</em>, Edgar Ruiz</p>
<p>With <code>dbplyr</code>, the task of accessing relational databases would be <strong>EXTREMELY</strong> optimized, because:</p>
<ul>
<li><p>1st) You don’t need to know SQL syntax to access data. Just knowing <strong>R</strong> and having a slight notion of SQL and you can already make a considerable number of data manipulations;</p></li>
<li><p>2nd) You will only need RStudio and no longer an external SQL client to make <em>queries</em>;</p></li>
<li><p>3rd) The code you would need in the first approach will be cut in half with the second</p></li>
<li><p>4th) Instead of spending hours thinking about which database you really need to import, we can analyze the data within the SQL server;</p></li>
<li><p>5th) Instead of using your computer’s memory, you’ll use the SQL server <em>engine</em>, because <code>dbplyr</code> together with <code>dplyr</code> will send <em>queries</em> to the server;</p></li>
<li><ol start="6" style="list-style-type: decimal">
<li>Manipulating data with <strong>R</strong> commands (and even more with <code>dplyr</code>) is much easier than manipulating data with SQL commands. So, you can investigate and manipulate data much more easily just with R to only save the result on your computer at the end</li>
</ol></li>
</ul>
<p>Before we start, you need to install and load the following packages: <code>DBI</code> and <code>dbplyr</code>. <code>DBI</code> is a <em>backend</em> that allows <code>dplyr</code> to communicate with various types of SQL databases using the same code. However, when installing and loading <code>dbplyr</code>, the <code>DBI</code> package will also be automatically loaded.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="m3.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;dbplyr&quot;)</span></span>
<span id="cb285-2"><a href="m3.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbplyr)</span></code></pre></div>
<p>In addition to <code>dbplyr</code> (and <code>DBI</code>), we’ll need a specific <em>backend</em> or <em>driver</em> for the type of SQL server we’re going to access. The most common are:</p>
<ul>
<li><strong>RMySQL</strong> connects to MySQL and MariaDB;</li>
<li><strong>RPostgreSQL</strong> connects to Postgres and Redshift;</li>
<li><strong>RSQLite</strong> embeds an embedded SQLite database (very useful for training);</li>
<li><strong>odbc</strong> connects to various commercial databases (SQL Server, for example) using the <em>open connectivity protocol</em>;</li>
<li><strong>bigrquery</strong> connects to Google’s BigQuery.</li>
</ul>
<p>These <em>backends</em> are also implemented as R packages.</p>
<p>For the examples in this handout, we’ll use <code>RSQLite</code>, because we’ll need to emulate a SQL-type database.</p>
</div>
<div id="connecting-to-a-database" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Connecting to a database<a href="m3.html#connecting-to-a-database" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To be able to work with a database together with <code>dplyr</code>, we must first establish a connection with this database, using <code>DBI::dbConnect()</code>. We thus create a connection object within R that will make the link in our RStudio session and the database.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="m3.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;RSQLite&quot;)</span></span>
<span id="cb286-2"><a href="m3.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb286-3"><a href="m3.html#cb286-3" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(<span class="at">drv =</span> RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">path =</span> <span class="st">&quot;:memory:&quot;</span>)</span></code></pre></div>
<p>The <code>drv</code> argument of <em>DBI::dbConnect()</em> can vary from database to database, but the first argument is always the <em>driver</em> of the type of database to which you will connect. It would be <code>RSQLite::SQLite()</code> for SQLite, <code>RMySQL::MySQL()</code> for MySQL, <code>RPostgreSQL::PostgreSQL()</code> for PostgreSQL, <code>odbc::odbc()</code> for SQL Server and <code>bigrquery::bigquery()</code> for Google BigQuery. SQLite only needs one more argument: the path to the database. In our case, we use the special <em>string</em> <code>[:memory:]</code> which will make SQLite build a temporary database in our computer’s memory.</p>
<p>However, most databases don’t “live” in a file, but on a server. This means that in real life your code would be more like:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="m3.html#cb287-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RMySQL<span class="sc">::</span><span class="fu">MySQL</span>(), </span>
<span id="cb287-2"><a href="m3.html#cb287-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">host =</span> <span class="st">&quot;database.company.com&quot;</span>,</span>
<span id="cb287-3"><a href="m3.html#cb287-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">user =</span> <span class="st">&quot;username&quot;</span>,</span>
<span id="cb287-4"><a href="m3.html#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">password =</span> rstudioapi<span class="sc">::</span><span class="fu">askForPassword</span>(<span class="st">&quot;Database password&quot;</span>)</span>
<span id="cb287-5"><a href="m3.html#cb287-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>TIP:</strong> In real life, when creating the connection object with the actual relational server, you would see a connections tab in RStudio, with the respective <em>schemas</em> and/or tables present on the server. It’s like a <em>Global Environment</em> of the database:</p>
<div class="figure">
<img src="fig/rstudio_connections.png" alt="" />
<p class="caption">RStudio <em>Connections</em> Tab</p>
</div>
<p>The temporary database we created earlier doesn’t have any data tables yet. Let’s start by copying a sample dataset. We’ll use the <code>mtcars</code> dataset that comes built-in with R, using the <code>copy_to()</code> function. Although this isn’t the most recommended way to put data into a database, it’s quite useful and easy to use in demonstrations:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="m3.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb288-2"><a href="m3.html#cb288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-3"><a href="m3.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the built-in mtcars dataset</span></span>
<span id="cb288-4"><a href="m3.html#cb288-4" aria-hidden="true" tabindex="-1"></a>cars_data <span class="ot">&lt;-</span> mtcars</span></code></pre></div>
<p>Once done, we can add the data to our fictional relational database:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="m3.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(con, cars_data, <span class="st">&quot;cars_db&quot;</span>,</span>
<span id="cb289-2"><a href="m3.html#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">temporary =</span> <span class="cn">FALSE</span>, </span>
<span id="cb289-3"><a href="m3.html#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">indexes =</span> <span class="fu">list</span>(</span>
<span id="cb289-4"><a href="m3.html#cb289-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cyl&quot;</span>, </span>
<span id="cb289-5"><a href="m3.html#cb289-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;gear&quot;</span></span>
<span id="cb289-6"><a href="m3.html#cb289-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb289-7"><a href="m3.html#cb289-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>copy_to()</code> function has some additional arguments that allow us to provide indexes for the table. We then create indexes that will allow us to quickly process data by <code>cyl</code> and <code>gear</code>. Creating write indexes is a key point for good database performance when sending <em>queries</em>. However, this is beyond the scope of this course.</p>
<p>Once we’ve copied the data to the server, we can reference (we’re not importing yet) this table in <strong>R</strong> using the <code>tbl()</code> function, which extracts the table called <code>"cars_db"</code> from the database.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="m3.html#cb290-1" aria-hidden="true" tabindex="-1"></a>cars_db <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">&quot;cars_db&quot;</span>)</span></code></pre></div>
<p>If we print the newly created reference, we’ll see it looks like a <em>tibble</em>, although it’s portrayed as a list in the <em>Global Environment</em>.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="m3.html#cb291-1" aria-hidden="true" tabindex="-1"></a>cars_db </span></code></pre></div>
<pre><code>## # Source:   table&lt;`cars_db`&gt; [?? x 11]
## # Database: sqlite 3.46.0 []
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
##  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
##  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
##  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
##  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
##  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
## 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
## # ℹ more rows</code></pre>
<p>The only difference is the reference that the data is in a SQLite database.</p>
</div>
<div id="generating-queries" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Generating queries<a href="m3.html#generating-queries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To interact with a database we usually use <em>SQL - Structured Query Language</em>. SQL is over 40 years old and is used in practically all existing databases. The goal of <code>dbplyr</code> is to automatically generate code in <em>SQL</em> so that we’re not forced to use it. However, <code>dbplyr</code> doesn’t do everything that SQL language does. It focuses on the declarative <strong>SELECT</strong> and derivatives, which we consider sufficient for the scope of this course.</p>
<p>See how, most of the time, we don’t need to know anything about SQL and can continue using the <code>dplyr</code> verbs we’re already familiar with.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="m3.html#cb293-1" aria-hidden="true" tabindex="-1"></a>cars_db <span class="sc">%&gt;%</span> <span class="fu">select</span>(mpg, cyl, hp)</span></code></pre></div>
<pre><code>## # Source:   SQL [?? x 3]
## # Database: sqlite 3.46.0 []
##      mpg   cyl    hp
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6   110
##  2  21       6   110
##  3  22.8     4    93
##  4  21.4     6   110
##  5  18.7     8   175
##  6  18.1     6   105
##  7  14.3     8   245
##  8  24.4     4    62
##  9  22.8     4    95
## 10  19.2     6   123
## # ℹ more rows</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="m3.html#cb295-1" aria-hidden="true" tabindex="-1"></a>cars_db <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mpg <span class="sc">&gt;</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## # Source:   SQL [?? x 11]
## # Database: sqlite 3.46.0 []
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6 160     110  3.9   2.62  16.5     0     1     4     4
##  2  21       6 160     110  3.9   2.88  17.0     0     1     4     4
##  3  22.8     4 108      93  3.85  2.32  18.6     1     1     4     1
##  4  21.4     6 258     110  3.08  3.22  19.4     1     0     3     1
##  5  24.4     4 147.     62  3.69  3.19  20       1     0     4     2
##  6  22.8     4 141.     95  3.92  3.15  22.9     1     0     4     2
##  7  32.4     4  78.7    66  4.08  2.2   19.5     1     1     4     1
##  8  30.4     4  75.7    52  4.93  1.62  18.5     1     1     4     2
##  9  33.9     4  71.1    65  4.22  1.84  19.9     1     1     4     1
## 10  21.5     4 120.     97  3.7   2.46  20.0     1     0     3     1
## # ℹ more rows</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="m3.html#cb297-1" aria-hidden="true" tabindex="-1"></a>cars_db <span class="sc">%&gt;%</span> </span>
<span id="cb297-2"><a href="m3.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb297-3"><a href="m3.html#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_mpg =</span> <span class="fu">mean</span>(mpg, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # Source:   SQL [3 x 2]
## # Database: sqlite 3.46.0 []
##     cyl avg_mpg
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1     4    26.7
## 2     6    19.7
## 3     8    15.1</code></pre>
<p>However, in the long run it’s highly recommended that you learn at least the basics of SQL. SQL is a quite important <em>skill</em> for any data scientist or people who deal with data routinely.</p>
<p>The most important difference between ordinary dataframes and <em>queries</em> to remote databases is that our <strong>R</strong> code is translated to <em>SQL</em> language and <strong>executed in the database</strong>, not in <strong>R</strong>. When working with <em>databases</em>, <code>dplyr</code> tries to be as lazy as possible. <code>dplyr</code> relies on a concept widely used in R, which is <em>lazy evaluation</em>:</p>
<ul>
<li><p>It never brings data to <strong>R</strong> unless we explicitly request it to do so;</p></li>
<li><p>It “delays” doing any task until the last moment: it collects all commands and sends to the database in a single step.</p></li>
</ul>
<p>See the following example:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="m3.html#cb299-1" aria-hidden="true" tabindex="-1"></a>by_cyl_db <span class="ot">&lt;-</span> cars_db <span class="sc">%&gt;%</span> </span>
<span id="cb299-2"><a href="m3.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb299-3"><a href="m3.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb299-4"><a href="m3.html#cb299-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_mpg =</span> <span class="fu">mean</span>(mpg, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb299-5"><a href="m3.html#cb299-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb299-6"><a href="m3.html#cb299-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-7"><a href="m3.html#cb299-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_mpg)) <span class="sc">%&gt;%</span></span>
<span id="cb299-8"><a href="m3.html#cb299-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code></pre></div>
<p>It’s surprising what we’re going to say now, but all this code doesn’t touch the database at any time; not until we request it, for example by doing a <strong>printing</strong> of the created object <code>by_cyl_db</code>. Only then does <code>dplyr</code> generate the <em>SQL</em> code and request the results from the database on the SQL server. Still, it tries to minimize what will be printed, bringing only a few lines and not everything. See:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="m3.html#cb300-1" aria-hidden="true" tabindex="-1"></a>by_cyl_db</span></code></pre></div>
<pre><code>## # Source:     SQL [3 x 3]
## # Database:   sqlite 3.46.0 []
## # Ordered by: desc(avg_mpg)
##     cyl avg_mpg     n
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
## 1     4    26.7    11
## 2     6    19.7     7
## 3     8    15.1    14</code></pre>
<p>Behind the scenes, <code>dbplyr</code>/<code>dplyr</code> is translating the code in <strong>R</strong> to <em>SQL</em> code. If you want to see (and learn) the SQL code being sent to the server, use <code>show_query()</code>:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="m3.html#cb302-1" aria-hidden="true" tabindex="-1"></a>by_cyl_db <span class="sc">%&gt;%</span> <span class="fu">show_query</span>()</span></code></pre></div>
<pre><code>## &lt;SQL&gt;
## SELECT `cyl`, AVG(`mpg`) AS `avg_mpg`, COUNT(*) AS `n`
## FROM `cars_db`
## GROUP BY `cyl`
## HAVING (COUNT(*) &gt; 5.0)
## ORDER BY `avg_mpg` DESC</code></pre>
<p>For those more familiar with SQL, the code above probably wouldn’t be what you would write, but it accomplishes the mission. See <code>vignette("SQL-translation")</code>.</p>
<p>Even with <code>dbplyr</code>/<code>dplyr</code>, we’ll still do some iterations and attempts until we discover what we’ll really need from the data. However, we’ll do it much faster. Once we know exactly our goal, we can use <code>collect()</code> to bring all the data into a (local) <em>tibble</em> on our machine:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="m3.html#cb304-1" aria-hidden="true" tabindex="-1"></a>by_cyl_final <span class="ot">&lt;-</span> by_cyl_db <span class="sc">%&gt;%</span> <span class="fu">collect</span>()</span>
<span id="cb304-2"><a href="m3.html#cb304-2" aria-hidden="true" tabindex="-1"></a>by_cyl_final</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##     cyl avg_mpg     n
##   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
## 1     4    26.7    11
## 2     6    19.7     7
## 3     8    15.1    14</code></pre>
<p><code>collect()</code> requires the database to work and therefore the operation may take some time to complete. On the other hand, <code>dbplyr</code> tries to prevent you from accidentally making computationally expensive <em>queries</em>:</p>
<ul>
<li><p>There’s usually no way to determine how many rows a <em>query</em> will return until we actually execute it. Unlike when working with databases on our PC, the <code>nrow()</code> command always returns <code>NA</code> when firing against relational databases;</p></li>
<li><p>Since we can’t find the last few rows without executing the query of all data, we can’t use <code>tail()</code>, which prints the <span class="math inline">\(n\)</span> last rows of a tibble or dataframe.</p></li>
</ul>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="m3.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(by_cyl_db)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="m3.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(by_cyl_db)</span></code></pre></div>
<pre><code>## Error in `tail()`:
## ! `tail()` is not supported on database backends.</code></pre>
<hr />
</div>
<div id="section-references-3" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Section References<a href="m3.html#section-references-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Wickham, H.; Ruiz, E. (2019). <em>dbplyr: A ‘dplyr’ Back End for Databases</em>. R package version 1.4.0. URL <a href="https://CRAN.R-project.org/package=dbplyr">https://CRAN.R-project.org/package=dbplyr</a>.</p></li>
<li><p>____. (2020). <em>dbplyr vignette: Introduction</em>. URL <a href="http://dbplyr.tidyverse.org">http://dbplyr.tidyverse.org</a>.</p></li>
<li><p>Ruiz, E. (2017). <em>Databases using R</em>. RViews-RStudio. May 05, 2017. Available at: <a href="https://rviews.rstudio.com/2017/05/17/databases-using-r/">https://rviews.rstudio.com/2017/05/17/databases-using-r/</a></p></li>
</ul>
</div>
<div id="exercises-3" class="section level3 hasAnchor" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Exercises<a href="m3.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Practice using the database connection skills learned with a local SQLite database. Create your own sample dataset, upload it to the database, and practice writing queries using <code>dplyr</code> verbs.</p></li>
<li><p>Explore the SQL code generated by <code>dbplyr</code> for different operations. Use <code>show_query()</code> to see how your R code is translated to SQL.</p></li>
</ol>
<hr />
<hr />
</div>
</div>
<div id="data-manipulation-with-two-table-verbs---dplyr" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Data Manipulation with <em>Two-table verbs</em> - <code>dplyr</code><a href="m3.html#data-manipulation-with-two-table-verbs---dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data analysis, most of the time, involves more than one database. In practice, they are databases from different sources that contribute to reaching a final result. Thus, we need flexible tools to combine them. In the <code>dplyr</code> package, there are three families of verbs that work with two tables at once:</p>
<ul>
<li><em>mutating joins</em>, which add new variables to a table from matching rows in another;</li>
<li><em>filtering joins</em>, which filter observations from a table if these observations match an observation in another table;</li>
<li><em>set operations</em>, which combine observations in datasets if they are elements of the informed set.</li>
</ul>
<p>These items assume your data is in <em>tidy data</em> format, i.e., rows are observations and columns are variables.</p>
<p>All <em>two-table verbs</em> (or two-table functions) work similarly: the first two arguments are <code>x</code> and <code>y</code> and provide the two tables we want to compare and combine. The <em>output</em> will always be a new table with the same object type as <code>x</code>.</p>
<div id="mutating-joins" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> <em>Mutating joins</em><a href="m3.html#mutating-joins" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Mutating joins</em> allow us to combine variables from multiple tables. We’ll use some datasets from the <code>nycflights13</code> package which includes data from 336,776 flights (tibble <code>flights</code>), weather conditions (tibble <code>weather</code>) and aircraft (tibble <code>planes</code>) that landed and took off from 3 airports (tibble <code>airports</code>) in New York in 2013. The data comes from the <em>US Bureau of Transportation Statistics</em>.</p>
<p>Initially we’ll use the <code>flights</code> dataset. Let’s separate some columns from the original tibble into another. Then we’ll try to join the two based on the airline name.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="m3.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;nycflights13&quot;</span>)</span>
<span id="cb310-2"><a href="m3.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb310-3"><a href="m3.html#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="m3.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop unimportant variables so it&#39;s easier to understand the join results.</span></span>
<span id="cb310-5"><a href="m3.html#cb310-5" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year<span class="sc">:</span>day, hour, origin, dest, tailnum, carrier)</span>
<span id="cb310-6"><a href="m3.html#cb310-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-7"><a href="m3.html#cb310-7" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb310-8"><a href="m3.html#cb310-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airlines)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 9
##     year month   day  hour origin dest  tailnum carrier name                    
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
##  1  2013     1     1     5 EWR    IAH   N14228  UA      United Air Lines Inc.   
##  2  2013     1     1     5 LGA    IAH   N24211  UA      United Air Lines Inc.   
##  3  2013     1     1     5 JFK    MIA   N619AA  AA      American Airlines Inc.  
##  4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue Airways         
##  5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air Lines Inc.    
##  6  2013     1     1     5 EWR    ORD   N39463  UA      United Air Lines Inc.   
##  7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue Airways         
##  8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJet Airlines Inc.
##  9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue Airways         
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American Airlines Inc.  
## # ℹ 336,766 more rows</code></pre>
<div id="controlling-how-tables-match-in-mutating-joins" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Controlling how tables match in <em>mutating joins</em><a href="m3.html#controlling-how-tables-match-in-mutating-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Along with the <code>x</code> and <code>y</code> arguments, each <em>mutating join</em> also receives a <code>by</code> argument which is used as an index to match between tables. There are several ways to specify this argument.
Let’s see examples of how to specify the <code>by</code> parameter, using some tables from <code>nycflights13</code>.</p>
<ul>
<li>1st way) <code>NULL</code>: the <em>default</em>. <code>dplyr</code> will use all variables that appear in both tables. We call this a <strong>natural join</strong>. In the following example, the <code>flights</code> and <code>weather</code> tables will be “joined” based on common variables: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code> and <code>origin</code>.</li>
</ul>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="m3.html#cb312-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(weather)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(year, month, day, hour, origin)`</code></pre>
<pre><code>## # A tibble: 336,776 × 18
##     year month   day  hour origin dest  tailnum carrier  temp  dewp humid wind_dir wind_speed
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA       39.0  28.0  64.4      260       12.7
##  2  2013     1     1     5 LGA    IAH   N24211  UA       39.9  25.0  54.8      250       15.0
##  3  2013     1     1     5 JFK    MIA   N619AA  AA       39.0  27.0  61.6      260       15.0
##  4  2013     1     1     5 JFK    BQN   N804JB  B6       39.0  27.0  61.6      260       15.0
##  5  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8      260       16.1
##  6  2013     1     1     5 EWR    ORD   N39463  UA       39.0  28.0  64.4      260       12.7
##  7  2013     1     1     6 EWR    FLL   N516JB  B6       37.9  28.0  67.2      240       11.5
##  8  2013     1     1     6 LGA    IAD   N829AS  EV       39.9  25.0  54.8      260       16.1
##  9  2013     1     1     6 JFK    MCO   N593JB  B6       37.9  27.0  64.3      260       13.8
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA       39.9  25.0  54.8      260       16.1
## # ℹ 336,766 more rows
## # ℹ 5 more variables: wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ul>
<li>2nd way) <code>by = "var1"</code> or <code>by = c("var1", "var2", "var3")</code>: a character vector. Operates as if it were a <em>natural join</em>, but uses only some of the common variables. For example, <code>flights</code> and <code>planes</code> have a <code>year</code> variable, but they mean different things in each tibble/dataframe. So, we want to specify a column we know means the same thing in both tibbles and can serve as an index for <em>matching</em>. Let’s use <code>tailnum</code> which is the plane’s (tail) number.</li>
</ul>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="m3.html#cb315-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 16
##    year.x month   day  hour origin dest  tailnum carrier year.y type  manufacturer model engines seats
##     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
##  1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixe… BOEING       737-…       2   149
##  2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixe… BOEING       737-…       2   149
##  3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixe… BOEING       757-…       2   178
##  4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixe… AIRBUS       A320…       2   200
##  5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixe… BOEING       757-…       2   178
##  6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixe… BOEING       737-…       2   191
##  7   2013     1     1     6 EWR    FLL   N516JB  B6        2000 Fixe… AIRBUS INDU… A320…       2   200
##  8   2013     1     1     6 LGA    IAD   N829AS  EV        1998 Fixe… CANADAIR     CL-6…       2    55
##  9   2013     1     1     6 JFK    MCO   N593JB  B6        2004 Fixe… AIRBUS       A320…       2   200
## 10   2013     1     1     6 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt;  &lt;NA&gt;         &lt;NA&gt;       NA    NA
## # ℹ 336,766 more rows
## # ℹ 2 more variables: speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
<p>Note that when joining all columns from both tibbles, <code>dplyr</code> adds a suffix to the second <code>year</code> variable.</p>
<ul>
<li>3rd way) <code>by = c("var1" = "var3")</code>: a named character vector. This will match variable <code>var1</code> in table <code>x</code> with variable <code>var3</code> in table <code>y</code>. Variables from source table <code>x</code> will be used in the <em>output</em>.</li>
</ul>
<p>Each flight has an origin and destination airport. So we need to specify which of these variables from the <code>flights</code> dataset we want to match with the <code>faa</code> column from the <code>airports</code> dataset.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="m3.html#cb317-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(airports, <span class="fu">c</span>(<span class="st">&quot;dest&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 15
##     year month   day  hour origin dest  tailnum carrier name         lat   lon   alt    tz dst   tzone
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA      George Bu…  30.0 -95.3    97    -6 A     Amer…
##  2  2013     1     1     5 LGA    IAH   N24211  UA      George Bu…  30.0 -95.3    97    -6 A     Amer…
##  3  2013     1     1     5 JFK    MIA   N619AA  AA      Miami Intl  25.8 -80.3     8    -5 A     Amer…
##  4  2013     1     1     5 JFK    BQN   N804JB  B6      &lt;NA&gt;        NA    NA      NA    NA &lt;NA&gt;  &lt;NA&gt; 
##  5  2013     1     1     6 LGA    ATL   N668DN  DL      Hartsfiel…  33.6 -84.4  1026    -5 A     Amer…
##  6  2013     1     1     5 EWR    ORD   N39463  UA      Chicago O…  42.0 -87.9   668    -6 A     Amer…
##  7  2013     1     1     6 EWR    FLL   N516JB  B6      Fort Laud…  26.1 -80.2     9    -5 A     Amer…
##  8  2013     1     1     6 LGA    IAD   N829AS  EV      Washingto…  38.9 -77.5   313    -5 A     Amer…
##  9  2013     1     1     6 JFK    MCO   N593JB  B6      Orlando I…  28.4 -81.3    96    -5 A     Amer…
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      Chicago O…  42.0 -87.9   668    -6 A     Amer…
## # ℹ 336,766 more rows</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="m3.html#cb319-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(airports, <span class="fu">c</span>(<span class="st">&quot;origin&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 336,776 × 15
##     year month   day  hour origin dest  tailnum carrier name         lat   lon   alt    tz dst   tzone
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1  2013     1     1     5 EWR    IAH   N14228  UA      Newark Li…  40.7 -74.2    18    -5 A     Amer…
##  2  2013     1     1     5 LGA    IAH   N24211  UA      La Guardia  40.8 -73.9    22    -5 A     Amer…
##  3  2013     1     1     5 JFK    MIA   N619AA  AA      John F Ke…  40.6 -73.8    13    -5 A     Amer…
##  4  2013     1     1     5 JFK    BQN   N804JB  B6      John F Ke…  40.6 -73.8    13    -5 A     Amer…
##  5  2013     1     1     6 LGA    ATL   N668DN  DL      La Guardia  40.8 -73.9    22    -5 A     Amer…
##  6  2013     1     1     5 EWR    ORD   N39463  UA      Newark Li…  40.7 -74.2    18    -5 A     Amer…
##  7  2013     1     1     6 EWR    FLL   N516JB  B6      Newark Li…  40.7 -74.2    18    -5 A     Amer…
##  8  2013     1     1     6 LGA    IAD   N829AS  EV      La Guardia  40.8 -73.9    22    -5 A     Amer…
##  9  2013     1     1     6 JFK    MCO   N593JB  B6      John F Ke…  40.6 -73.8    13    -5 A     Amer…
## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      La Guardia  40.8 -73.9    22    -5 A     Amer…
## # ℹ 336,766 more rows</code></pre>
</div>
<div id="types-of-mutating-joins" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Types of <em>mutating joins</em><a href="m3.html#types-of-mutating-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are 4 types of <em>mutating join</em>, which differ by behavior in rows where <strong>no</strong> <em>matching</em> occurs between databases.</p>
<p>Let’s create two dataframes and then we’ll see examples of each case.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="m3.html#cb321-1" aria-hidden="true" tabindex="-1"></a>(df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   x y
## 1 1 2
## 2 2 1</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="m3.html#cb323-1" aria-hidden="true" tabindex="-1"></a>(df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">a =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="st">&quot;a&quot;</span>))</span></code></pre></div>
<pre><code>##   x  a b
## 1 1 10 a
## 2 3 10 a</code></pre>
<ul>
<li><code>inner_join(x, y)</code>: includes only observations that have correspondence in both <code>x</code> and <code>y</code> (i.e., equal rows in dataframes).</li>
</ul>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="m3.html#cb325-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(df2)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>##   x y  a b
## 1 1 2 10 a</code></pre>
<p>Note that the <code>by</code> argument was omitted. Thus, the function’s behavior was the <em>default</em>. Column <code>x</code> was used as an index to join the two data frames. Equal rows for variable <code>x</code> in both dataframes are brought in full (i.e., all columns are presented).</p>
<ul>
<li><code>left_join(x, y)</code>: includes all observations in <code>x</code>, regardless of whether there’s <em>matching</em> between tables. This is the most used type of <em>join</em>, because it guarantees we won’t lose any information from our primary table <code>x</code>.</li>
</ul>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="m3.html#cb328-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>##   x y  a    b
## 1 1 2 10    a
## 2 2 1 NA &lt;NA&gt;</code></pre>
<ul>
<li><code>right_join(x, y)</code>: includes all observations from table <code>y</code>. It’s equivalent to <code>left_join(**y**, **x**)</code>, but variable ordering will be different in the latter case:</li>
</ul>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="m3.html#cb331-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(df2)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>##   x  y  a b
## 1 1  2 10 a
## 2 3 NA 10 a</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="m3.html#cb334-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df1)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>##   x  a b  y
## 1 1 10 a  2
## 2 3 10 a NA</code></pre>
<ul>
<li><code>full_join()</code>: includes all observations from table <code>x</code> and <code>y</code>:</li>
</ul>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="m3.html#cb337-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(df2)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>##   x  y  a    b
## 1 1  2 10    a
## 2 2  1 NA &lt;NA&gt;
## 3 3 NA 10    a</code></pre>
<p>The <em>left</em>, <em>right</em> and <em>full joins</em> are collectively known as <strong>outer joins</strong>. When a row from one table has no correspondence in the other table, in an <strong>outer join</strong>, new variables are filled with <em>missing values</em> (<code>NA</code>).</p>
<p>Although <em>mutating joins</em> exist to add new variables, in some cases they can generate new observations. If a match isn’t unique, a <em>join</em> will add rows for all possible combinations (Cartesian product) of matching observations. This is an important observation, because often when performing a join between two tables, we don’t understand why the table resulting from the <em>join</em> has more observations than the two original tables.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="m3.html#cb340-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb340-2"><a href="m3.html#cb340-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">z =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb340-3"><a href="m3.html#cb340-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-4"><a href="m3.html#cb340-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(df2)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(x)`</code></pre>
<pre><code>## Warning in left_join(., df2): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 1 of `x` matches multiple rows in `y`.
## ℹ Row 1 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship = &quot;many-to-many&quot;` to silence this
##   warning.</code></pre>
<pre><code>##   x y z
## 1 1 1 a
## 2 1 1 b
## 3 1 2 a
## 4 1 2 b
## 5 2 3 a</code></pre>
</div>
</div>
<div id="filtering-joins" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> <em>Filtering joins</em><a href="m3.html#filtering-joins" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Filtering joins</strong> “match” observations in the same way as <em>mutating joins</em>, but <strong>affect observations themselves and not variables</strong>. There are two types of <em>filtering joins</em>:</p>
<ul>
<li><code>semi_join()</code> <strong>KEEPS</strong> all observations in <code>x</code> that have correspondence in <code>y</code>;</li>
<li><code>anti_join()</code> <strong>REMOVES</strong> all observations in <code>x</code> that have correspondence in <code>y</code>.</li>
</ul>
<p>These joins are very useful for identifying “mismatches” between tables. For example, there are several flights in the <code>flights</code> dataset that don’t have matches regarding <code>tailnum</code> in the <code>planes</code> dataset:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="m3.html#cb344-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb344-2"><a href="m3.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb344-3"><a href="m3.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 722 × 2
##    tailnum     n
##    &lt;chr&gt;   &lt;int&gt;
##  1 &lt;NA&gt;     2512
##  2 N725MQ    575
##  3 N722MQ    513
##  4 N723MQ    507
##  5 N713MQ    483
##  6 N735MQ    396
##  7 N0EGMQ    371
##  8 N534MQ    364
##  9 N542MQ    363
## 10 N531MQ    349
## # ℹ 712 more rows</code></pre>
<p>If you’re concerned about which observations our <em>join</em> will <em>match</em>, it’s suggested to start with a <code>semi_join()</code> or <code>anti_join()</code> for the following reason: these <em>joins</em> never duplicate observations, they only remove or keep them in the same number.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="m3.html#cb346-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb346-2"><a href="m3.html#cb346-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">z =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb346-3"><a href="m3.html#cb346-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-4"><a href="m3.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Four rows to start with:</span></span>
<span id="cb346-5"><a href="m3.html#cb346-5" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="m3.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And we get four rows after the join</span></span>
<span id="cb348-2"><a href="m3.html#cb348-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(df2, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## Warning in inner_join(., df2, by = &quot;x&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 1 of `x` matches multiple rows in `y`.
## ℹ Row 1 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship = &quot;many-to-many&quot;` to silence this
##   warning.</code></pre>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="m3.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># But only two rows actually match</span></span>
<span id="cb351-2"><a href="m3.html#cb351-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="sc">%&gt;%</span> <span class="fu">semi_join</span>(df2, <span class="at">by =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Finally, it’s worth mentioning functions that would be useful if you had to work with 3 or more tables. Read about <code>purrr::reduce()</code> or <code>Reduce()</code>, as described in <em>“Advanced R”</em>, to iteratively combine and expand your knowledge of <em>two-table verbs</em> to handle a larger number of tables.</p>
<p>The content of this chapter was adapted from the <em>two-table verbs</em> vignette, available at <a href="http://dplyr.tidyverse.org/articles/two-table.html">http://dplyr.tidyverse.org/articles/two-table.html</a>.</p>
<hr />
</div>
<div id="section-references-4" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Section References<a href="m3.html#section-references-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Wickham H.; François, R.; Henry, L.; Müller K. (2019). <em>dplyr: A Grammar of Data Manipulation</em>. R package version 0.8.1. URL <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p></li>
<li><p>Wickham H.; François, R.; Henry, L.; Müller K. (2020). <em>dplyr vignette: Two-table</em>. Article. Available at: <a href="http://dplyr.tidyverse.org/articles/two-table.html">http://dplyr.tidyverse.org/articles/two-table.html</a>.</p></li>
<li><p>Wickham, H.; Grolemund, G. (2016). <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. O’Reilly Media. december 2016. 522 pages. Available at: <a href="https://www.r4ds.co.nz">https://www.r4ds.co.nz</a>.</p></li>
</ul>
</div>
<div id="exercises-4" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Exercises<a href="m3.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Try to replicate each of the <em>joins</em> presented in this section using the <code>nycflights13</code> datasets. Practice joining <code>flights</code> with different tables like <code>airports</code>, <code>airlines</code>, <code>weather</code>, and <code>planes</code>.</p></li>
<li><p>Create your own small datasets and practice all four types of joins (<code>inner_join</code>, <code>left_join</code>, <code>right_join</code>, <code>full_join</code>). Pay attention to how each handles non-matching rows.</p></li>
<li><p>Use <code>anti_join()</code> to find flights in the <code>flights</code> dataset that don’t have weather information in the <code>weather</code> dataset.</p></li>
</ol>
<hr />
<hr />
</div>
</div>
<div id="geographic-data-analysis-in-r" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Geographic Data Analysis in <strong>R</strong><a href="m3.html#geographic-data-analysis-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction-2" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Introduction<a href="m3.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In recent decades there has been a real revolution in geocomputation techniques. Thanks to this great advance, geographic data analysis is no longer restricted to those who have access to expensive hardware and software. In a way, we can say that <strong>R</strong> also contributed to this advance. Although the language had some limitations regarding geocomputation in the early years of language development, recently several <strong>R</strong> packages have taken geocomputation to a new level, especially regarding <strong>reproducibility</strong>.</p>
<p>While software based on Geographic Information Systems (GIS), which has Geography as its base discipline and focus on graphical interfaces, leaves something to be desired in the reproducibility of generated maps, <strong>R</strong>, which is based on Statistics and Computing through command line and programming, makes geographic data analysis much more fluid and capable of reproduction by other users and developers.</p>
<p>In this section, we’ll present some of the main packages and techniques used for map production using <strong>R</strong>.</p>
<div id="geographic-data-models-vector-vs-raster" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Geographic data models: <em>vector</em> vs <em>raster</em><a href="m3.html#geographic-data-models-vector-vs-raster" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the field of geocomputation, we need to know how to differentiate the two main types of geographic data: <em>vector</em> and <em>raster</em>.</p>
<p>Geographic data in <strong>vector</strong> form uses <em>points</em>, <em>lines</em> and <em>polygons</em> to represent a map. In this case, object edges (e.g. States, Municipalities, Countries) are well defined.</p>
<div class="figure"><span style="display:block;" id="fig:vector-example"></span>
<img src="IDART_en_files/figure-html/vector-example-1.png" alt="Example of vector plot" width="2400" />
<p class="caption">
Figure 3.1: Example of vector plot
</p>
</div>
<p>Data in <strong>raster</strong> format divides a map’s surface into cells of constant sizes. Datasets in <em>raster</em> format are commonly used to generate maps as background images (<em>background</em>). <em>Raster</em> models have been used practically since the origin of Remote Sensing devices and satellites.</p>
<p>In this course, we’ll focus on geographic data models in <strong><em>vector</em></strong>, which is the predominant data model in Social Sciences. This is because spatial arrangements produced by humans tend to have discrete and well-defined boundaries. The <em>raster</em> model is more used in environmental or earth sciences due to the use of data from remote sensing.</p>
<p>Now that we know the conceptual differences between the main geographic data models, let’s get practical.</p>
</div>
</div>
<div id="map-production-in-r" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Map Production in R<a href="m3.html#map-production-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="shapefiles" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> <em>Shapefiles</em><a href="m3.html#shapefiles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><em>Shapefiles</em> are files that follow the geographic data model in <em>vector</em>, containing graphic elements in the format of <em>point</em>, <em>line</em> and/or <em>polygons</em> that can be worked together with geographic coordinates to describe a specific phenomenon, such as population size, disease incidence, unemployment rates, etc. From this information, it’s possible to construct a map.</p>
<p>A <em>shapefile</em> normally contains three main files <code>.shp</code>, <code>.shx</code>, <code>.dbf</code>. There are several places from which you can obtain <em>shapefiles</em> for map making.</p>
<p>If your goal is to obtain <em>shapefiles</em> for US territorial boundaries, you can get them from these sources:</p>
<ul>
<li><p><strong>US Census Bureau - TIGER/Line Shapefiles</strong>: <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html">https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html</a></p></li>
<li><p><strong>Natural Earth Data</strong>: <a href="https://www.naturalearthdata.com/downloads/">https://www.naturalearthdata.com/downloads/</a></p></li>
<li><p><strong>GADM</strong>: <a href="https://gadm.org/download_country_v3.html">https://gadm.org/download_country_v3.html</a></p></li>
</ul>
<p><strong>TIP:</strong> The <code>spData</code> package already includes geographic data for US states, which makes our work easier for educational purposes.</p>
<p>We’ll focus on demonstrating how to work with <em>shapefiles</em> using the <code>spData</code> package that already has ready-made data. For any other data source, procedures will be practically the same.</p>
</div>
<div id="map-of-us-states" class="section level4 hasAnchor" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> Map of US States<a href="m3.html#map-of-us-states" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="obtaining-and-reading-the-file" class="section level5 hasAnchor" number="3.3.2.2.1">
<h5><span class="header-section-number">3.3.2.2.1</span> Obtaining and reading the file<a href="m3.html#obtaining-and-reading-the-file" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s use the <code>spData</code> package which already contains the territorial mesh of US states. We’ll also need the <code>sf</code> package to work with spatial data.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="m3.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading necessary packages</span></span>
<span id="cb353-2"><a href="m3.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb353-3"><a href="m3.html#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spData)</span>
<span id="cb353-4"><a href="m3.html#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb353-5"><a href="m3.html#cb353-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb353-6"><a href="m3.html#cb353-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-7"><a href="m3.html#cb353-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading US states data</span></span>
<span id="cb353-8"><a href="m3.html#cb353-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;us_states&quot;</span>)</span>
<span id="cb353-9"><a href="m3.html#cb353-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-10"><a href="m3.html#cb353-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting to sf object (simple features)</span></span>
<span id="cb353-11"><a href="m3.html#cb353-11" aria-hidden="true" tabindex="-1"></a>shp_us_states <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(us_states)</span>
<span id="cb353-12"><a href="m3.html#cb353-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-13"><a href="m3.html#cb353-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the data structure</span></span>
<span id="cb353-14"><a href="m3.html#cb353-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shp_us_states)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 6 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -114.8136 ymin: 24.55868 xmax: -71.78699 ymax: 42.04964
## Geodetic CRS:  NAD83
##   GEOID        NAME   REGION             AREA total_pop_10 total_pop_15
## 1    01     Alabama    South 133709.27 [km^2]      4712651      4830620
## 2    04     Arizona     West 295281.25 [km^2]      6246816      6641928
## 3    08    Colorado     West 269573.06 [km^2]      4887061      5278906
## 4    09 Connecticut Norteast  12976.59 [km^2]      3545837      3593222
## 5    12     Florida    South 151052.01 [km^2]     18511620     19645772
## 6    13     Georgia    South 152725.21 [km^2]      9468815     10006693
##                         geometry
## 1 MULTIPOLYGON (((-88.20006 3...
## 2 MULTIPOLYGON (((-114.7196 3...
## 3 MULTIPOLYGON (((-109.0501 4...
## 4 MULTIPOLYGON (((-73.48731 4...
## 5 MULTIPOLYGON (((-81.81169 2...
## 6 MULTIPOLYGON (((-85.60516 3...</code></pre>
<p>Note that in addition to state names, region they belong to (<code>REGION</code>), area, total population and other variables, this special dataframe has a column called <code>geom</code>. This column has the vector geometric elements for map making in the <em>vector</em> data model mentioned earlier.</p>
</div>
<div id="plotting-the-map" class="section level5 hasAnchor" number="3.3.2.2.2">
<h5><span class="header-section-number">3.3.2.2.2</span> Plotting the Map<a href="m3.html#plotting-the-map" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>Using ggplot2 (Recommended Method)</strong></p>
<p>The most reliable way to create maps in R is using <code>ggplot2</code> with <code>geom_sf()</code>. This approach handles complex geometries better and produces professional-looking maps:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="m3.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shp_us_states) <span class="sc">+</span></span>
<span id="cb355-2"><a href="m3.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb355-3"><a href="m3.html#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;United States - State Boundaries&quot;</span>) <span class="sc">+</span></span>
<span id="cb355-4"><a href="m3.html#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/ggplot-basic-map-1.png" width="2400" /></p>
<p>Very simple to make maps in <strong>R</strong>, right?</p>
<p><strong>Alternative: Using base R plot()</strong></p>
<p>If you prefer base R graphics, here’s how to do it with proper configuration:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="m3.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This requires proper graphics device setup</span></span>
<span id="cb356-2"><a href="m3.html#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb356-3"><a href="m3.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(shp_us_states), </span>
<span id="cb356-4"><a href="m3.html#cb356-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;United States - State Boundaries&quot;</span>,</span>
<span id="cb356-5"><a href="m3.html#cb356-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb356-6"><a href="m3.html#cb356-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb356-7"><a href="m3.html#cb356-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</div>
<div id="adding-data-to-the-map" class="section level5 hasAnchor" number="3.3.2.2.3">
<h5><span class="header-section-number">3.3.2.2.3</span> Adding data to the map<a href="m3.html#adding-data-to-the-map" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Normally, when doing geographic analyses, our goal is to represent some phenomenon occurring in the territory, such as unemployment rate behavior by state.</p>
<p>Let’s create simulated unemployment rate data for US states in the year 2020:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="m3.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb357-2"><a href="m3.html#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="m3.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating unemployment rate data</span></span>
<span id="cb357-4"><a href="m3.html#cb357-4" aria-hidden="true" tabindex="-1"></a>unemployment_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb357-5"><a href="m3.html#cb357-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">NAME =</span> shp_us_states<span class="sc">$</span>NAME,</span>
<span id="cb357-6"><a href="m3.html#cb357-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">unemployment_rate =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">nrow</span>(shp_us_states), <span class="at">min =</span> <span class="fl">3.5</span>, <span class="at">max =</span> <span class="fl">8.5</span>), <span class="dv">1</span>)</span>
<span id="cb357-7"><a href="m3.html#cb357-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb357-8"><a href="m3.html#cb357-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-9"><a href="m3.html#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unemployment_data)</span></code></pre></div>
<pre><code>##          NAME unemployment_rate
## 1     Alabama               4.9
## 2     Arizona               7.4
## 3    Colorado               5.5
## 4 Connecticut               7.9
## 5     Florida               8.2
## 6     Georgia               3.7</code></pre>
<p>Now we must join this data to the dataframe containing the boundaries of US states. Let’s use the <code>left_join()</code> function from <code>dplyr</code>. We’ll join the tables based on the column containing state names.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="m3.html#cb359-1" aria-hidden="true" tabindex="-1"></a>shape_data_join <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shp_us_states, </span>
<span id="cb359-2"><a href="m3.html#cb359-2" aria-hidden="true" tabindex="-1"></a>                             unemployment_data, </span>
<span id="cb359-3"><a href="m3.html#cb359-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by =</span> <span class="st">&quot;NAME&quot;</span>)</span>
<span id="cb359-4"><a href="m3.html#cb359-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-5"><a href="m3.html#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the result</span></span>
<span id="cb359-6"><a href="m3.html#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shape_data_join[, <span class="fu">c</span>(<span class="st">&quot;NAME&quot;</span>, <span class="st">&quot;REGION&quot;</span>, <span class="st">&quot;unemployment_rate&quot;</span>)])</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -114.8136 ymin: 24.55868 xmax: -71.78699 ymax: 42.04964
## Geodetic CRS:  NAD83
##          NAME   REGION unemployment_rate                       geometry
## 1     Alabama    South               4.9 MULTIPOLYGON (((-88.20006 3...
## 2     Arizona     West               7.4 MULTIPOLYGON (((-114.7196 3...
## 3    Colorado     West               5.5 MULTIPOLYGON (((-109.0501 4...
## 4 Connecticut Norteast               7.9 MULTIPOLYGON (((-73.48731 4...
## 5     Florida    South               8.2 MULTIPOLYGON (((-81.81169 2...
## 6     Georgia    South               3.7 MULTIPOLYGON (((-85.60516 3...</code></pre>
</div>
<div id="creating-a-choropleth-map-with-ggplot2" class="section level5 hasAnchor" number="3.3.2.2.4">
<h5><span class="header-section-number">3.3.2.2.4</span> Creating a Choropleth Map with ggplot2<a href="m3.html#creating-a-choropleth-map-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Now let’s create a professional choropleth map showing unemployment rates:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="m3.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shape_data_join) <span class="sc">+</span></span>
<span id="cb361-2"><a href="m3.html#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> unemployment_rate), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb361-3"><a href="m3.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb361-4"><a href="m3.html#cb361-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">&quot;Unemployment</span><span class="sc">\n</span><span class="st">Rate (%)&quot;</span>,</span>
<span id="cb361-5"><a href="m3.html#cb361-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb361-6"><a href="m3.html#cb361-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment Rate by State, 2020&quot;</span>,</span>
<span id="cb361-7"><a href="m3.html#cb361-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Simulated data for educational purposes&quot;</span>,</span>
<span id="cb361-8"><a href="m3.html#cb361-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: Simulated data&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-9"><a href="m3.html#cb361-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb361-10"><a href="m3.html#cb361-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb361-11"><a href="m3.html#cb361-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb361-12"><a href="m3.html#cb361-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb361-13"><a href="m3.html#cb361-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/choropleth-ggplot-1.png" width="3000" /></p>
<p><strong>Alternative visualization with discrete colors:</strong></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="m3.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb362-2"><a href="m3.html#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="m3.html#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create discrete categories</span></span>
<span id="cb362-4"><a href="m3.html#cb362-4" aria-hidden="true" tabindex="-1"></a>shape_data_join <span class="ot">&lt;-</span> shape_data_join <span class="sc">%&gt;%</span></span>
<span id="cb362-5"><a href="m3.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemployment_category =</span> <span class="fu">cut</span>(unemployment_rate, </span>
<span id="cb362-6"><a href="m3.html#cb362-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb362-7"><a href="m3.html#cb362-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;3-4%&quot;</span>, <span class="st">&quot;4-5%&quot;</span>, <span class="st">&quot;5-6%&quot;</span>, </span>
<span id="cb362-8"><a href="m3.html#cb362-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&quot;6-7%&quot;</span>, <span class="st">&quot;7-8%&quot;</span>, <span class="st">&quot;8-9%&quot;</span>),</span>
<span id="cb362-9"><a href="m3.html#cb362-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb362-10"><a href="m3.html#cb362-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-11"><a href="m3.html#cb362-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shape_data_join) <span class="sc">+</span></span>
<span id="cb362-12"><a href="m3.html#cb362-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> unemployment_category), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb362-13"><a href="m3.html#cb362-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>,</span>
<span id="cb362-14"><a href="m3.html#cb362-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Unemployment</span><span class="sc">\n</span><span class="st">Rate&quot;</span>,</span>
<span id="cb362-15"><a href="m3.html#cb362-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="st">&quot;grey90&quot;</span>) <span class="sc">+</span></span>
<span id="cb362-16"><a href="m3.html#cb362-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment Rate by State, 2020&quot;</span>,</span>
<span id="cb362-17"><a href="m3.html#cb362-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Simulated data for educational purposes&quot;</span>) <span class="sc">+</span></span>
<span id="cb362-18"><a href="m3.html#cb362-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb362-19"><a href="m3.html#cb362-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb362-20"><a href="m3.html#cb362-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb362-21"><a href="m3.html#cb362-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/choropleth-discrete-1.png" width="3000" /></p>
<p><strong>TIP:</strong> With <code>ggplot2</code> and <code>geom_sf()</code>, we can use all the familiar <code>ggplot2</code> functions to customize our maps!</p>
</div>
<div id="adding-more-data-to-the-map" class="section level5 hasAnchor" number="3.3.2.2.5">
<h5><span class="header-section-number">3.3.2.2.5</span> Adding more data to the map<a href="m3.html#adding-more-data-to-the-map" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s add GDP growth data and create a more complex visualization:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="m3.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb363-2"><a href="m3.html#cb363-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-3"><a href="m3.html#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating GDP growth data</span></span>
<span id="cb363-4"><a href="m3.html#cb363-4" aria-hidden="true" tabindex="-1"></a>gdp_growth_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb363-5"><a href="m3.html#cb363-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">NAME =</span> shp_us_states<span class="sc">$</span>NAME,</span>
<span id="cb363-6"><a href="m3.html#cb363-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gdp_growth =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">nrow</span>(shp_us_states), <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">max =</span> <span class="dv">5</span>), <span class="dv">1</span>)</span>
<span id="cb363-7"><a href="m3.html#cb363-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb363-8"><a href="m3.html#cb363-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-9"><a href="m3.html#cb363-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with existing data</span></span>
<span id="cb363-10"><a href="m3.html#cb363-10" aria-hidden="true" tabindex="-1"></a>shape_data_join2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(shape_data_join, </span>
<span id="cb363-11"><a href="m3.html#cb363-11" aria-hidden="true" tabindex="-1"></a>                              gdp_growth_data, </span>
<span id="cb363-12"><a href="m3.html#cb363-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="st">&quot;NAME&quot;</span>)</span>
<span id="cb363-13"><a href="m3.html#cb363-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-14"><a href="m3.html#cb363-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shape_data_join2[, <span class="fu">c</span>(<span class="st">&quot;NAME&quot;</span>, <span class="st">&quot;unemployment_rate&quot;</span>, <span class="st">&quot;gdp_growth&quot;</span>)])</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -114.8136 ymin: 24.55868 xmax: -71.78699 ymax: 42.04964
## Geodetic CRS:  NAD83
##          NAME unemployment_rate gdp_growth                       geometry
## 1     Alabama               4.9       -2.3 MULTIPOLYGON (((-88.20006 3...
## 2     Arizona               7.4       -1.3 MULTIPOLYGON (((-114.7196 3...
## 3    Colorado               5.5        2.9 MULTIPOLYGON (((-109.0501 4...
## 4 Connecticut               7.9        3.8 MULTIPOLYGON (((-73.48731 4...
## 5     Florida               8.2        3.3 MULTIPOLYGON (((-81.81169 2...
## 6     Georgia               3.7       -0.3 MULTIPOLYGON (((-85.60516 3...</code></pre>
<p>Now let’s create a bivariate map showing both unemployment and GDP growth:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="m3.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get state centroids for bubble plot</span></span>
<span id="cb365-2"><a href="m3.html#cb365-2" aria-hidden="true" tabindex="-1"></a>state_centers <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">st_centroid</span>(shape_data_join2))</span>
<span id="cb365-3"><a href="m3.html#cb365-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-4"><a href="m3.html#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the base map with unemployment rate</span></span>
<span id="cb365-5"><a href="m3.html#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shape_data_join2) <span class="sc">+</span></span>
<span id="cb365-6"><a href="m3.html#cb365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> unemployment_rate), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb365-7"><a href="m3.html#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, </span>
<span id="cb365-8"><a href="m3.html#cb365-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Unemployment</span><span class="sc">\n</span><span class="st">Rate (%)&quot;</span>,</span>
<span id="cb365-9"><a href="m3.html#cb365-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb365-10"><a href="m3.html#cb365-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add bubbles for GDP growth</span></span>
<span id="cb365-11"><a href="m3.html#cb365-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> state_centers, </span>
<span id="cb365-12"><a href="m3.html#cb365-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">size =</span> <span class="fu">abs</span>(gdp_growth),</span>
<span id="cb365-13"><a href="m3.html#cb365-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> gdp_growth <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb365-14"><a href="m3.html#cb365-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb365-15"><a href="m3.html#cb365-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span></span>
<span id="cb365-16"><a href="m3.html#cb365-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">&quot;GDP Growth</span><span class="sc">\n</span><span class="st">(absolute %)&quot;</span>,</span>
<span id="cb365-17"><a href="m3.html#cb365-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb365-18"><a href="m3.html#cb365-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb365-19"><a href="m3.html#cb365-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Positive&quot;</span>),</span>
<span id="cb365-20"><a href="m3.html#cb365-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;GDP Growth</span><span class="sc">\n</span><span class="st">Direction&quot;</span>) <span class="sc">+</span></span>
<span id="cb365-21"><a href="m3.html#cb365-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment Rate and GDP Growth by State, 2020&quot;</span>,</span>
<span id="cb365-22"><a href="m3.html#cb365-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Fill color shows unemployment rate; bubble size shows GDP growth magnitude&quot;</span>,</span>
<span id="cb365-23"><a href="m3.html#cb365-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: Simulated data for educational purposes&quot;</span>) <span class="sc">+</span></span>
<span id="cb365-24"><a href="m3.html#cb365-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb365-25"><a href="m3.html#cb365-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb365-26"><a href="m3.html#cb365-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb365-27"><a href="m3.html#cb365-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/bivariate-map-1.png" width="3600" /></p>
</div>
<div id="focusing-on-a-specific-region-florida-and-neighboring-states" class="section level5 hasAnchor" number="3.3.2.2.6">
<h5><span class="header-section-number">3.3.2.2.6</span> Focusing on a specific region: Florida and neighboring states<a href="m3.html#focusing-on-a-specific-region-florida-and-neighboring-states" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>As an additional example, let’s create a map focused on Florida and neighboring states. This is particularly relevant since this course is being taught at the University of North Florida (UNF) in Jacksonville.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="m3.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting Florida and neighboring states</span></span>
<span id="cb366-2"><a href="m3.html#cb366-2" aria-hidden="true" tabindex="-1"></a>southeast_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Florida&quot;</span>, <span class="st">&quot;Georgia&quot;</span>, <span class="st">&quot;Alabama&quot;</span>, <span class="st">&quot;South Carolina&quot;</span>)</span>
<span id="cb366-3"><a href="m3.html#cb366-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-4"><a href="m3.html#cb366-4" aria-hidden="true" tabindex="-1"></a>shape_southeast <span class="ot">&lt;-</span> shape_data_join2 <span class="sc">%&gt;%</span></span>
<span id="cb366-5"><a href="m3.html#cb366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME <span class="sc">%in%</span> southeast_states)</span>
<span id="cb366-6"><a href="m3.html#cb366-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-7"><a href="m3.html#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating regional map with ggplot2</span></span>
<span id="cb366-8"><a href="m3.html#cb366-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> shape_southeast) <span class="sc">+</span></span>
<span id="cb366-9"><a href="m3.html#cb366-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> unemployment_rate), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb366-10"><a href="m3.html#cb366-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> NAME), <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, </span>
<span id="cb366-11"><a href="m3.html#cb366-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb366-12"><a href="m3.html#cb366-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb366-13"><a href="m3.html#cb366-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">&quot;Unemployment</span><span class="sc">\n</span><span class="st">Rate (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb366-14"><a href="m3.html#cb366-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Unemployment in Southeast US States, 2020&quot;</span>,</span>
<span id="cb366-15"><a href="m3.html#cb366-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Focus: Florida and neighboring states&quot;</span>,</span>
<span id="cb366-16"><a href="m3.html#cb366-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Simulated for educational purposes&quot;</span>) <span class="sc">+</span></span>
<span id="cb366-17"><a href="m3.html#cb366-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb366-18"><a href="m3.html#cb366-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb366-19"><a href="m3.html#cb366-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb366-20"><a href="m3.html#cb366-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/florida-map-1.png" width="2400" /></p>
<p><strong>Adding UNF marker to Florida map:</strong></p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="m3.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get only Florida</span></span>
<span id="cb367-2"><a href="m3.html#cb367-2" aria-hidden="true" tabindex="-1"></a>florida <span class="ot">&lt;-</span> shape_southeast <span class="sc">%&gt;%</span> <span class="fu">filter</span>(NAME <span class="sc">==</span> <span class="st">&quot;Florida&quot;</span>)</span>
<span id="cb367-3"><a href="m3.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="m3.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create UNF location point</span></span>
<span id="cb367-5"><a href="m3.html#cb367-5" aria-hidden="true" tabindex="-1"></a>unf_location <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(<span class="fu">st_point</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">81.6557</span>, <span class="fl">30.3322</span>)), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb367-6"><a href="m3.html#cb367-6" aria-hidden="true" tabindex="-1"></a>unf_location <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="at">name =</span> <span class="st">&quot;UNF&quot;</span>, <span class="at">geometry =</span> unf_location)</span>
<span id="cb367-7"><a href="m3.html#cb367-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-8"><a href="m3.html#cb367-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb367-9"><a href="m3.html#cb367-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> florida, <span class="fu">aes</span>(<span class="at">fill =</span> unemployment_rate), </span>
<span id="cb367-10"><a href="m3.html#cb367-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb367-11"><a href="m3.html#cb367-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> unf_location, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb367-12"><a href="m3.html#cb367-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">data =</span> unf_location, <span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Jacksonville</span><span class="sc">\n</span><span class="st">(UNF)&quot;</span>), </span>
<span id="cb367-13"><a href="m3.html#cb367-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">nudge_x =</span> <span class="dv">1</span>, <span class="at">nudge_y =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>) <span class="sc">+</span></span>
<span id="cb367-14"><a href="m3.html#cb367-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb367-15"><a href="m3.html#cb367-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">&quot;Unemployment</span><span class="sc">\n</span><span class="st">Rate (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb367-16"><a href="m3.html#cb367-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Florida Unemployment Rate, 2020&quot;</span>,</span>
<span id="cb367-17"><a href="m3.html#cb367-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;University of North Florida location marked&quot;</span>,</span>
<span id="cb367-18"><a href="m3.html#cb367-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Data: Simulated for educational purposes&quot;</span>) <span class="sc">+</span></span>
<span id="cb367-19"><a href="m3.html#cb367-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb367-20"><a href="m3.html#cb367-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb367-21"><a href="m3.html#cb367-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb367-22"><a href="m3.html#cb367-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="IDART_en_files/figure-html/florida-unf-map-1.png" width="2400" /></p>
</div>
<div id="creating-interactive-maps-with-leaflet" class="section level5 hasAnchor" number="3.3.2.2.7">
<h5><span class="header-section-number">3.3.2.2.7</span> Creating interactive maps with leaflet<a href="m3.html#creating-interactive-maps-with-leaflet" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>For interactive maps that can be shared online or embedded in websites, <code>leaflet</code> is an excellent choice:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="m3.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb368-2"><a href="m3.html#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="m3.html#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple interactive map centered on Jacksonville, FL</span></span>
<span id="cb368-4"><a href="m3.html#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb368-5"><a href="m3.html#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap tiles</span></span>
<span id="cb368-6"><a href="m3.html#cb368-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="at">lng =</span> <span class="sc">-</span><span class="fl">81.6557</span>, <span class="at">lat =</span> <span class="fl">30.3322</span>, <span class="at">zoom =</span> <span class="dv">11</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-7"><a href="m3.html#cb368-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng =</span> <span class="sc">-</span><span class="fl">81.6557</span>, <span class="at">lat =</span> <span class="fl">30.3322</span>, </span>
<span id="cb368-8"><a href="m3.html#cb368-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">popup =</span> <span class="st">&quot;&lt;b&gt;University of North Florida&lt;/b&gt;&lt;br/&gt;Jacksonville, FL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-9"><a href="m3.html#cb368-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> <span class="sc">-</span><span class="fl">81.6557</span>, <span class="at">lat =</span> <span class="fl">30.3322</span>,</span>
<span id="cb368-10"><a href="m3.html#cb368-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">radius =</span> <span class="dv">50</span>,</span>
<span id="cb368-11"><a href="m3.html#cb368-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb368-12"><a href="m3.html#cb368-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fillOpacity =</span> <span class="fl">0.2</span>,</span>
<span id="cb368-13"><a href="m3.html#cb368-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">popup =</span> <span class="st">&quot;UNF Campus Area&quot;</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-7767cfe14a1accdeb7fb" style="width:2400px;height:1800px;"></div>
<script type="application/json" data-for="htmlwidget-7767cfe14a1accdeb7fb">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[30.3322,-81.6557,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"<b>University of North Florida<\/b><br/>Jacksonville, FL",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[30.3322,-81.6557,50,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":0.5,"fill":true,"fillColor":"blue","fillOpacity":0.2},null,null,"UNF Campus Area",null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[30.3322,-81.6557],11,[]],"limits":{"lat":[30.3322,30.3322],"lng":[-81.6557,-81.6557]}},"evals":[],"jsHooks":[]}</script>
<p>We can also create an interactive choropleth map showing our unemployment data:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="m3.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb369-2"><a href="m3.html#cb369-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-3"><a href="m3.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For leaflet, we need to transform to WGS84 (EPSG:4326)</span></span>
<span id="cb369-4"><a href="m3.html#cb369-4" aria-hidden="true" tabindex="-1"></a>shape_leaflet <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(shape_data_join2, <span class="dv">4326</span>)</span>
<span id="cb369-5"><a href="m3.html#cb369-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-6"><a href="m3.html#cb369-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color palette</span></span>
<span id="cb369-7"><a href="m3.html#cb369-7" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorNumeric</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>, </span>
<span id="cb369-8"><a href="m3.html#cb369-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">domain =</span> shape_leaflet<span class="sc">$</span>unemployment_rate)</span>
<span id="cb369-9"><a href="m3.html#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="m3.html#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interactive map</span></span>
<span id="cb369-11"><a href="m3.html#cb369-11" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(shape_leaflet) <span class="sc">%&gt;%</span></span>
<span id="cb369-12"><a href="m3.html#cb369-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb369-13"><a href="m3.html#cb369-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb369-14"><a href="m3.html#cb369-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(unemployment_rate),</span>
<span id="cb369-15"><a href="m3.html#cb369-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb369-16"><a href="m3.html#cb369-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb369-17"><a href="m3.html#cb369-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb369-18"><a href="m3.html#cb369-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb369-19"><a href="m3.html#cb369-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightOptions =</span> <span class="fu">highlightOptions</span>(</span>
<span id="cb369-20"><a href="m3.html#cb369-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight =</span> <span class="dv">3</span>,</span>
<span id="cb369-21"><a href="m3.html#cb369-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;#666&quot;</span>,</span>
<span id="cb369-22"><a href="m3.html#cb369-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">fillOpacity =</span> <span class="fl">0.9</span>,</span>
<span id="cb369-23"><a href="m3.html#cb369-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">bringToFront =</span> <span class="cn">TRUE</span></span>
<span id="cb369-24"><a href="m3.html#cb369-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb369-25"><a href="m3.html#cb369-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="sc">~</span><span class="fu">paste0</span>(NAME, <span class="st">&quot;: &quot;</span>, unemployment_rate, <span class="st">&quot;%&quot;</span>),</span>
<span id="cb369-26"><a href="m3.html#cb369-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;&lt;strong&gt;&quot;</span>, NAME, <span class="st">&quot;&lt;/strong&gt;&lt;br/&gt;&quot;</span>,</span>
<span id="cb369-27"><a href="m3.html#cb369-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Unemployment: &quot;</span>, unemployment_rate, <span class="st">&quot;%&lt;br/&gt;&quot;</span>,</span>
<span id="cb369-28"><a href="m3.html#cb369-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;GDP Growth: &quot;</span>, gdp_growth, <span class="st">&quot;%&quot;</span>)</span>
<span id="cb369-29"><a href="m3.html#cb369-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb369-30"><a href="m3.html#cb369-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal, </span>
<span id="cb369-31"><a href="m3.html#cb369-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="sc">~</span>unemployment_rate, </span>
<span id="cb369-32"><a href="m3.html#cb369-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">opacity =</span> <span class="fl">0.7</span>, </span>
<span id="cb369-33"><a href="m3.html#cb369-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Unemployment Rate (%)&quot;</span>,</span>
<span id="cb369-34"><a href="m3.html#cb369-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="st">&quot;bottomright&quot;</span>)</span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-886b93cfa78bf452b527" style="width:2400px;height:1800px;"></div>
<script type="application/json" data-for="htmlwidget-886b93cfa78bf452b527">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addPolygons","args":[[[[{"lng":[-88.2000643142902,-88.20295931006918,-87.42861327924435,-86.86214737930814,-85.60516501577332,-85.470472,-85.304489,-85.1844,-85.12218900000001,-85.10533700000001,-85.00709999999999,-84.96343,-85.001874,-84.891841,-85.05874900000001,-85.053815,-85.141831,-85.12553,-85.05816900000001,-85.04498599999999,-85.09248700000001,-85.107516,-85.03561500000001,-85.00249903705659,-85.89363176119984,-86.51999746662474,-87.59893714490568,-87.63494300000001,-87.53261439057883,-87.40696915598102,-87.44659365241912,-87.42958398278492,-87.51832418565655,-87.656888,-87.755516,-87.90634300000001,-87.90171100000001,-87.936717,-88.008396,-88.100874,-88.107274,-88.20449499999999,-88.332277,-88.39502299999999,-88.43898,-88.47322699999999,-88.403789,-88.330934,-88.210741,-88.097888,-88.2000643142902],"lat":[34.99563395700627,35.00802794331506,35.00279445154329,34.99195553481417,34.98467800221,34.328238,33.482882,32.861317,32.773353,32.644835,32.523868,32.422544,32.322015,32.263398,32.136018,32.013502,31.839261,31.694965,31.620227,31.51823,31.362881,31.186451,31.108192,31.00068179370384,30.99345341345252,30.99322269779202,30.99742196336502,30.865857,30.74346565780042,30.67514532667165,30.52705573799588,30.40649193624166,30.28043522289347,30.249709,30.291217,30.40938,30.550879,30.657432,30.684956,30.50975,30.377246,30.362102,30.38844,30.369425,31.246896,31.893856,32.44977,33.073125,34.029199,34.892202,34.99563395700627]}]],[[{"lng":[-114.719633,-114.539093,-114.468971,-114.50613,-114.670803,-114.707896,-114.677032,-114.722872,-114.62964,-114.558898,-114.496489,-114.533679,-114.460264,-114.415908,-114.254141,-114.138282,-114.342615,-114.47162,-114.630682,-114.633487,-114.572747,-114.595931,-114.677643,-114.653406,-114.689407,-114.71211,-114.667194,-114.731159,-114.736165,-114.572031,-114.372106,-114.238799,-114.15413,-114.046838,-114.0506,-112.966471,-112.35769,-111.412784,-110.50069,-110.47019,-109.625668,-109.045223,-109.046183,-109.0460242,-109.046182,-109.046662,-109.04748,-109.048286,-109.050044,-109.829689,-111.074825,-111.560194,-112.39942,-113.125961,-113.78168,-114.813613,-114.809393,-114.719633],"lat":[32.718763,32.756949,32.845155,33.01701,33.037984,33.097432,33.27017,33.398779,33.428138,33.531819,33.696901,33.926072,33.996649,34.107636,34.173831,34.30323,34.451442,34.712966,34.866352,35.001857,35.138725,35.325234,35.489742,35.610789,35.651412,35.806185,35.874787,35.943916,36.104367,36.15161,36.143114,36.014561,36.023862,36.194069,37.000396,37.000219,37.001025,37.0014777,37.00426,36.997997,36.998308,36.999084,36.181751,35.175508,34.522393,33.625055,33.06842,32.089114,31.332502,31.334067,31.332239,31.488138,31.751757,31.97278,32.179034,32.494277,32.617119,32.718763]}]],[[{"lng":[-109.050076,-108.250649,-107.625624,-106.217573,-105.730421,-104.855273,-104.053249,-102.865784,-102.051614,-102.051744,-102.048449,-102.045388,-102.044644,-102.04224,-103.002199,-104.338833,-105.000554,-106.201469,-106.869796,-107.4209219,-108.249358,-109.045223,-109.041865,-109.041762,-109.060062,-109.051512,-109.050615,-109.050076],"lat":[41.000659,41.000114,41.002124,40.997734,40.996886,40.998048,41.001406,41.001988,41.002377,40.003078,39.303138,38.813392,38.045532,36.993083,37.000104,36.993535,36.993264,36.994122,36.992426,37.000005,36.999015,36.999084,37.530726,38.16469,38.275489,39.126095,39.87497,41.000659]}]],[[{"lng":[-73.487314,-72.999549,-71.80065,-71.79924200000001,-71.78699400000001,-71.79768300000001,-71.860513,-71.945652,-72.386629,-72.451925,-72.962047,-73.130253,-73.177774,-73.33065999999999,-73.387227,-73.49332699999999,-73.657336,-73.72777499999999,-73.482709,-73.550961,-73.487314],"lat":[42.049638,42.038653,42.023569,42.008065,41.655992,41.416709,41.320248,41.337799,41.261798,41.278885,41.251597,41.146797,41.166697,41.109996,41.058247,41.048173,40.985171,41.100696,41.21276,41.295422,42.049638]}]],[[{"lng":[-81.81169576822978,-81.74565406039187,-81.44351364955226,-81.3050579030326,-81.25771467510712,-81.40189264656281,-81.51740763919686,-81.68524596504808,-81.81169576822978],"lat":[24.56874309404976,24.65988025513462,24.81336347934398,24.75518457754049,24.66430849585406,24.62354309075326,24.62123783716607,24.55867445176616,24.56874309404976]}],[{"lng":[-85.00249903705659,-84.93695559636046,-84.91444797386053,-84.86469217152663,-84.05732283694121,-83.13143032263388,-82.21486592619814,-82.210316348654,-82.17007734705336,-82.04793638344941,-82.0121281271317,-82.03965617440254,-81.94980586568313,-81.69478553843852,-81.44412196015307,-81.38550235341106,-81.2567079915012,-81.16357793811588,-80.96617290802938,-80.70972167260241,-80.57486450022986,-80.52509036505612,-80.58780930109742,-80.60421012221954,-80.56642794442659,-80.38369070305214,-80.2536609656206,-80.09390631526871,-80.03135949374528,-80.03886075073794,-80.10956459037621,-80.12798629727978,-80.24452750686531,-80.33942134309483,-80.32578080507579,-80.35818459216763,-80.46883049585702,-80.46455121999686,-80.6640269150767,-80.74774690279507,-80.81213377697435,-80.90057797223321,-81.07986015696575,-81.17204447090984,-81.11726479006182,-81.29032568337752,-81.35055345441624,-81.3838069715232,-81.46848557913461,-81.62347835822221,-81.68953641660242,-81.80165942380665,-81.83313836622418,-81.91170625507787,-82.01367612491305,-82.10566807369274,-82.13786492885018,-82.18156088440641,-82.06657086112965,-82.07634513786903,-82.17523712593098,-82.14706390915312,-82.24988385865797,-82.44571485796668,-82.56924477897962,-82.70781737284203,-82.58462534386453,-82.39337864176106,-82.41391096996172,-82.62958694182183,-82.5865156624405,-82.63361647172303,-82.73801839832014,-82.85112262771834,-82.82815991255079,-82.86081037608591,-82.76264064100808,-82.67478495579425,-82.65413613201282,-82.66872025464259,-82.73024324613631,-82.68886217683455,-82.76054915765313,-82.75970199124951,-82.82707042643413,-82.99614076322585,-83.16957253162784,-83.21807179529603,-83.40024902050504,-83.4127653591224,-83.53764260345012,-83.6379781554638,-84.02427268576551,-84.15727649623388,-84.26936134291479,-84.36611322112165,-84.33374418644034,-84.53587092749432,-84.82419403639501,-84.91510687620175,-84.99326036535028,-85.12146895027279,-85.04507004280796,-85.22160359917584,-85.31921050042364,-85.30132661885446,-85.40504790682516,-85.48776000644017,-85.58823859632925,-85.69680691859243,-85.8781352178369,-86.08996067579902,-86.29869818251571,-86.6329522750143,-86.90967906884904,-87.15539263476984,-87.29542252208651,-87.51832418565655,-87.42958398278492,-87.44659365241912,-87.40696915598102,-87.53261439057883,-87.63494300000001,-87.59893714490568,-86.51999746662474,-85.89363176119984,-85.00249903705659],"lat":[31.00068179370384,30.88467842643522,30.75358077356706,30.71154111763392,30.67469557813615,30.62357300943016,30.56858127457143,30.4245737468209,30.35891106528313,30.36324818291453,30.59376436178032,30.74772566075225,30.82749471514446,30.74841277614837,30.70971260154579,30.27383915969492,29.78469136934174,29.55528818890805,29.14795808098654,28.75669012248681,28.58516430516092,28.45945236899398,28.41085432729613,28.25773140560253,28.09562850533706,27.74004365529168,27.37978823847284,27.01858558241625,26.7963377833271,26.56934566064984,26.0871638758446,25.77224400352792,25.71708841831715,25.49942677963863,25.39800990058742,25.15322846211868,25.09202784937721,25.20906758079256,25.1872631051526,25.1474423347542,25.18604052549961,25.13967085094942,25.11879914932951,25.22227840738968,25.35495525129304,25.68750781834066,25.68983382054641,25.77675260480526,25.80332162442778,25.89715924127421,25.85271120396526,26.08822759376043,26.29451832853282,26.42715834313823,26.49082928865864,26.48393024118588,26.63744102422335,26.6817119143903,26.74265695137994,26.95826313622362,26.9168669910538,26.78980288731055,26.76294573709917,27.06063405195796,27.29858790940943,27.48761414748278,27.59601986698602,27.83751749453311,27.90139938014127,27.99847232477666,27.81670161398648,27.71060565392639,27.70680549390327,27.88629794563412,28.02012788794426,28.21707615540268,28.21901171410753,28.44195487578076,28.59083585882523,28.69565673048432,28.85015371848346,28.90560775659715,28.99308586149284,29.05419086021189,29.15842376534619,29.17807258180711,29.29035301625997,29.42048956897998,29.51723907723015,29.66848189625994,29.72305684619493,29.88607031419161,30.10326875387488,30.07271174865133,30.09765774995936,30.00865976486043,29.92371870039917,29.91008965963518,29.75828533032107,29.78330014601413,29.71495807495279,29.71585103985862,29.5869884582792,29.67776111240926,29.68149103913557,29.79711395552703,29.93848388178815,29.96122371167219,30.05553983679393,30.09688669670651,30.2156156184599,30.3035654049484,30.36304476195885,30.39629392277037,30.37241811207055,30.32774462075358,30.3235008477368,30.28043522289347,30.40649193624166,30.52705573799588,30.67514532667165,30.74346565780042,30.865857,30.99742196336502,30.99322269779202,30.99345341345252,31.00068179370384]}]],[[{"lng":[-85.60516501577332,-84.32186900027445,-83.61998460567887,-83.10861265487796,-83.121112,-83.239081,-83.323866,-83.33869,-83.168278,-83.00292399999999,-82.902665,-82.746656,-82.717507,-82.596155,-82.55683500000001,-82.34693300000001,-82.255267,-82.196583,-82.046335,-81.913532,-81.944737,-81.847296,-81.82793599999999,-81.704634,-81.617779,-81.49141899999999,-81.50271600000001,-81.42161400000001,-81.411906,-81.281324,-81.11963299999999,-81.155995,-81.117234,-81.006745,-80.88551699999999,-80.840549,-81.130634,-81.133493,-81.177254,-81.27879799999999,-81.274688,-81.420474,-81.4051520306832,-81.44692545920473,-81.44412196015307,-81.69478553843852,-81.94980586568313,-82.03965617440254,-82.0121281271317,-82.04793638344941,-82.17007734705336,-82.210316348654,-82.21486592619814,-83.13143032263388,-84.05732283694121,-84.86469217152663,-84.91444797386053,-84.93695559636046,-85.00249903705659,-85.03561500000001,-85.107516,-85.09248700000001,-85.04498599999999,-85.05816900000001,-85.12553,-85.141831,-85.053815,-85.05874900000001,-84.891841,-85.001874,-84.96343,-85.00709999999999,-85.10533700000001,-85.12218900000001,-85.1844,-85.304489,-85.470472,-85.60516501577332],"lat":[34.98467800221,34.98840805153525,34.98659185539776,35.00065900853208,34.939129,34.875661,34.789712,34.682002,34.590998,34.472132,34.485902,34.266407,34.150504,34.030517,33.945353,33.834298,33.75969,33.630582,33.56383,33.441274,33.364041,33.306783,33.228746,33.116451,33.095277,33.008078,32.938688,32.835178,32.61841,32.556464,32.287596,32.241478,32.117605,32.101152,32.0346,32.011306,31.722692,31.623348,31.517074,31.367214,31.289454,31.016703,30.90820255948246,30.81038902509538,30.70971260154579,30.74841277614837,30.82749471514446,30.74772566075225,30.59376436178032,30.36324818291453,30.35891106528313,30.4245737468209,30.56858127457143,30.62357300943016,30.67469557813615,30.71154111763392,30.75358077356706,30.88467842643522,31.00068179370384,31.108192,31.186451,31.362881,31.51823,31.620227,31.694965,31.839261,32.013502,32.136018,32.263398,32.322015,32.422544,32.523868,32.644835,32.773353,32.861317,33.482882,34.328238,34.98467800221]}]],[[{"lng":[-116.9159895159247,-116.9595486133668,-116.9239585378294,-116.9846308775224,-117.0559841394647,-117.0398143721908,-117.0398226029407,-117.0424715266614,-117.0351780007083,-117.0323505245854,-116.049193,-116.04885,-115.824597,-115.72377,-115.686704,-115.72148,-115.551079,-115.526751,-115.326903,-115.001274,-114.927837,-114.765106,-114.649388,-114.615036,-114.322519,-114.451912,-114.492153,-114.388243,-114.498809,-114.566172,-114.504869,-114.558253,-114.460542,-114.333218,-114.135249,-113.986656,-113.806729,-113.834555,-113.734402,-113.735601,-113.599506,-113.57467,-113.45197,-113.455071,-113.356062,-113.247166,-113.131453,-113.007194,-113.003544,-112.886041,-112.781294,-112.473207,-112.286187,-112.106755,-111.870504,-111.821488,-111.585763,-111.473178,-111.323669,-111.225208,-111.048974,-111.0452047,-111.043564,-111.046689,-112.173352,-112.192976,-113.249159,-113.893261,-114.041723,-115.031783,-116.368478,-117.026195987366,-117.026652625457,-117.0266341914282,-116.9344850428434,-116.977350930472,-116.8959309426188,-117.056509759196,-117.2426746212458,-117.2259315984773,-117.1441608436681,-117.0442170253468,-116.9347000525424,-116.8319900613254,-116.8479441182088,-116.7312162120355,-116.6737934415362,-116.463504,-116.5930042255921,-116.7826763747147,-116.9159895159247],"lat":[45.99541213798035,46.09905678429265,46.17091873450996,46.2927034109163,46.34552931752514,46.42542335781966,47.12726692538325,47.83900749602457,48.37087749579046,48.99918900098305,49.000912,47.977186,47.752154,47.696671,47.485596,47.424469,47.349856,47.303219,47.255912,46.971901,46.83599,46.758153,46.73289,46.639733,46.611066,46.241253,46.04729,45.88234,45.850676,45.773864,45.722176,45.585104,45.561283,45.459316,45.557465,45.704564,45.602146,45.520729,45.392353,45.325265,45.191114,45.128411,45.059247,44.865424,44.819798,44.82295,44.772837,44.52596,44.450814,44.395874,44.484888,44.480027,44.568472,44.520829,44.564033,44.509286,44.562843,44.665479,44.724474,44.581006,44.474072,43.5010519,42.722624,42.001567,41.996568,42.001167,41.996203,41.988057,41.99372,41.996008,41.996281,41.99988853182847,43.02512767917776,43.80810400997638,44.02124900909228,44.08536400870452,44.15429507282817,44.23087401180819,44.39654799419318,44.47938895771377,44.54564686119396,44.74513985196488,44.78388088506026,44.9330067257977,45.02260162586546,45.13993373058788,45.32151079512442,45.615785,45.77854076806101,45.82537572037787,45.99541213798035]}]],[[{"lng":[-87.524044,-87.42344,-87.278437,-87.120322,-86.824828,-85.791363,-84.80588299999999,-84.806082,-84.80217,-84.8039175,-84.814179,-84.82015699999999,-84.897171,-84.83712,-84.811645,-84.978723,-85.190507,-85.25884600000001,-85.45211399999999,-85.433136,-85.620521,-85.65364099999999,-85.7915759,-85.90876400000001,-85.95146699999999,-86.178983,-86.266891,-86.27180199999999,-86.37532400000001,-86.51728900000001,-86.534156,-86.598108,-86.75099,-86.794985,-87.033444,-87.07073200000001,-87.220944,-87.380247,-87.450458,-87.591582,-87.68401799999999,-87.830578,-87.90680999999999,-88.02803,-88.013355,-88.035332,-87.945472,-87.984234,-87.93732900000001,-87.854643,-87.745254,-87.73952199999999,-87.654166,-87.62012,-87.519609,-87.496537,-87.550515,-87.512187,-87.640435,-87.574558,-87.61005,-87.53164599999999,-87.533227,-87.526809,-87.52671100000001,-87.524044],"lat":[41.708335,41.642835,41.619736,41.645701,41.76024,41.759051,41.760216,41.696089,40.800601,40.3100936,39.814212,39.10548,39.052407,38.988059,38.792766,38.77928,38.68795,38.737754,38.709348,38.523914,38.423105,38.327108,38.2885654,38.161169,38.005608,38.011308,38.057125,38.137874,38.130629,38.042634,37.917007,37.867382,37.912893,37.988982,37.906593,37.801937,37.849134,37.935596,37.941451,37.887194,37.903498,37.876516,37.807624,37.799224,37.894854,38.051145,38.126616,38.20996,38.292431,38.275376,38.408996,38.475069,38.511911,38.639489,38.697198,38.778571,38.85956,38.954417,39.166727,39.218404,39.282232,39.347888,39.883127,40.46217,41.121485,41.708335]}]],[[{"lng":[-102.051744,-101.409953,-100.468773,-99.813401,-98.934792,-98.099659,-97.049663,-96.154365,-95.30829,-95.205733,-95.081534,-94.959276,-94.886933,-94.968981,-95.027644,-95.10288799999999,-94.92310999999999,-94.823791,-94.607034,-94.611858,-94.617721,-94.617964,-95.40768300000001,-96.500288,-97.46228000000001,-98.354073,-99.648652,-100.734517,-102.04224,-102.044644,-102.045388,-102.048449,-102.051744],"lat":[40.003078,40.002354,40.001724,40.0014,40.002205,40.002227,40.001323,40.000495,39.999998,39.908275,39.861718,39.901671,39.833098,39.692954,39.665454,39.533347,39.384492,39.209874,39.119404,38.620485,37.77297,36.998905,36.999241,36.998643,36.998685,36.997961,36.999604,36.999059,36.993083,38.045532,38.813392,39.303138,40.003078]}]],[[{"lng":[-92.017827,-91.848242,-91.71324,-91.768263,-91.846463,-92.015139,-92.017827],"lat":[29.590962,29.627124,29.55551,29.490362,29.479308,29.561328,29.590962]}],[{"lng":[-94.042964,-92.796533,-91.951958,-91.166073,-91.21283699999999,-91.14500200000001,-91.165328,-91.063946,-91.152699,-91.11600799999999,-91.029606,-91.00450600000001,-90.893653,-90.994293,-91.04650700000001,-91.164171,-91.16282200000001,-91.053175,-91.075908,-91.18831,-91.20101,-91.345714,-91.395715,-91.51581,-91.51857800000001,-91.62599400000001,-91.564397,-91.625118,-91.060213,-90.38053600000001,-89.75264199999999,-89.756333,-89.84580099999999,-89.76813300000001,-89.68340999999999,-89.629727,-89.61705600000001,-89.52450399999999,-89.617542,-89.683712,-89.857558,-89.692004,-89.598129,-89.58136,-89.49406399999999,-89.31545300000001,-89.46759900000001,-89.583336,-89.68109200000001,-89.528429,-89.487308,-89.312085,-89.115104,-89.06661699999999,-89.146953,-89.142866,-89.343751,-89.482844,-89.639663,-89.842641,-90.22358699999999,-90.304275,-90.39399899999999,-90.527253,-90.723185,-90.85997,-90.96127799999999,-91.094015,-91.278792,-91.334885,-91.217827,-91.329624,-91.357613,-91.46096300000001,-91.55353700000001,-91.625114,-91.621512,-91.737253,-91.853987,-91.889118,-92.200076,-92.10824599999999,-92.25185999999999,-92.323465,-92.615098,-92.94749299999999,-93.17693,-93.475252,-93.74194799999999,-93.837971,-93.92274399999999,-93.85514000000001,-93.786935,-93.720805,-93.697748,-93.714319,-93.758554,-93.697828,-93.727844,-93.621093,-93.554057,-93.56778799999999,-93.516943,-93.600308,-93.62034300000001,-93.725925,-93.81858200000001,-93.822598,-93.90955700000001,-94.04272,-94.042964],"lat":[33.019219,33.014836,33.007428,33.004106,32.922104,32.84287,32.751301,32.702926,32.640757,32.48314,32.433542,32.368144,32.328095,32.213768,32.241149,32.196888,32.132694,32.124237,32.016828,31.960958,31.909159,31.842861,31.644165,31.530894,31.275283,31.116896,31.038965,30.999167,30.998953,30.999872,31.001853,30.943498,30.707314,30.51502,30.451793,30.339287,30.227495,30.180753,30.156422,30.076018,30.004439,29.868722,29.881409,29.994722,30.040972,29.923208,29.699019,29.652834,29.534487,29.454702,29.393346,29.388038,29.252901,29.090714,29.051659,28.991623,29.052906,29.215053,29.290531,29.318823,29.085075,29.266161,29.299019,29.304051,29.135971,29.094961,29.180817,29.187711,29.247776,29.298775,29.396437,29.426615,29.512991,29.469961,29.632766,29.626195,29.735429,29.74937,29.707618,29.836023,29.72571,29.613667,29.539354,29.531497,29.585561,29.708777,29.770487,29.769242,29.736343,29.690619,29.818808,29.864099,29.99058,30.053043,30.152944,30.294282,30.387077,30.443838,30.57407,30.695159,30.824941,30.888302,31.023662,31.176158,31.271025,31.504092,31.554826,31.773559,31.893144,31.999265,33.019219]}]],[[{"lng":[-70.275526,-70.082072,-70.118669,-70.275526],"lat":[41.310464,41.299093,41.242351,41.310464]}],[{"lng":[-70.83380200000001,-70.768901,-70.603555,-70.45108399999999,-70.83380200000001],"lat":[41.353386,41.353246,41.482384,41.348161,41.353386]}],[{"lng":[-73.264957,-72.458519,-71.29420500000001,-71.132503,-70.93079899999999,-70.817296,-70.770453,-70.61842,-70.65472699999999,-70.871382,-70.85779100000001,-70.990595,-70.986667,-70.88276399999999,-70.77096400000001,-70.640169,-70.662476,-70.552941,-70.54103000000001,-70.471552,-70.25920499999999,-70.00384200000001,-69.935952,-69.92826100000001,-70.245867,-70.338067,-70.493244,-70.633607,-70.626529,-70.718739,-70.81027899999999,-70.929722,-70.931545,-71.12057,-71.13288799999999,-71.19564,-71.22479800000001,-71.327896,-71.3817,-71.381401,-71.79924200000001,-71.80065,-72.999549,-73.487314,-73.50814200000001,-73.264957],"lat":[42.74594,42.726853,42.69699,42.821389,42.884589,42.87229,42.704824,42.62864,42.582234,42.546404,42.490296,42.407098,42.306265,42.30886,42.249197,42.088633,41.960592,41.929641,41.815754,41.761563,41.713954,41.80852,41.809422,41.6917,41.628479,41.636338,41.552044,41.538254,41.712995,41.73574,41.624873,41.609479,41.540169,41.497448,41.660102,41.67509,41.710498,41.780501,41.893199,42.018798,42.008065,42.023569,42.038653,42.049638,42.086257,42.74594]}]],[[{"lng":[-97.229039,-96.40540799999999,-95.153711,-95.15331399999999,-94.957465,-94.82516,-94.683069,-94.690889,-94.58714999999999,-94.264473,-94.244394,-93.844008,-93.794454,-93.46750400000001,-93.347528,-92.98496299999999,-92.72804600000001,-92.63493099999999,-92.65602699999999,-92.507285,-92.369174,-92.280727,-92.288994,-92.162161,-92.00013300000001,-92.00657699999999,-91.86438200000001,-91.71493100000001,-91.711986,-91.429642,-91.250112,-90.976955,-90.83917599999999,-90.761625,-90.37454200000001,-90.132645,-90.023595,-89.871245,-89.749314,-89.58823,-89.974296,-90.537105,-90.735927,-91.17003699999999,-91.4773513354795,-92.09409028006245,-92.01529202552237,-92.08949154345048,-92.21239237138037,-92.29219204847013,-92.29403385542996,-92.36214181507327,-92.64011495346482,-92.70770164661974,-92.78462003901365,-92.86919230447025,-92.88374848547087,-92.77022226508014,-92.64660151217133,-92.75871078403954,-92.74493889889301,-92.79152884901778,-92.75064554900754,-92.80798785897669,-92.51835729594677,-92.34756605626244,-92.21516239100986,-92.05354835934803,-91.92558930859798,-91.87515781773405,-91.71059722323248,-91.58260452360442,-91.44053617652317,-91.28413745860703,-91.24413452530545,-91.26874771490301,-91.21770573392232,-91.94987904932039,-92.79031710338838,-93.795793,-94.47042,-95.740813,-96.45326,-96.4527743,-96.453067,-96.489065,-96.680454,-96.85775099999999,-96.840746,-96.652226,-96.57974,-96.563672,-96.554507,-96.599761,-96.735123,-96.798357,-96.77655799999999,-96.819558,-96.851293,-96.939179,-97.054554,-97.075641,-97.146672,-97.11657,-97.163105,-97.098697,-97.136083,-97.229039],"lat":[49.000687,48.999984,48.998903,49.384358,49.370186,49.294283,48.883929,48.778066,48.717599,48.698919,48.653442,48.629395,48.516021,48.545664,48.62662,48.623731,48.53929,48.542873,48.436709,48.447875,48.220268,48.244269,48.342991,48.363279,48.321355,48.265421,48.207031,48.19913,48.114713,48.048608,48.084087,48.219452,48.239511,48.098283,48.090942,48.111768,48.084708,47.985945,48.023325,47.9662,47.830514,47.703055,47.624343,47.366266,47.12566785851595,46.78784049146171,46.70647105134989,46.74924184454698,46.64994251088043,46.66604319301565,46.07437872398621,46.01310487782796,45.93247960097163,45.89490236855837,45.76419732222008,45.71756886783873,45.57548353804193,45.56693981616363,45.44163630931365,45.29096629178548,45.10831014944706,45.07964796229027,44.93729974532085,44.75147031146038,44.57518363735841,44.55714951509729,44.43850319680444,44.40137525563215,44.33354846917305,44.20057551382379,44.12048090615219,44.02738238639991,44.00150269835093,43.8470661899335,43.77466802335154,43.61534849734252,43.50055019010122,43.500485138229,43.49956689274306,43.49952,43.50034,43.499894,43.50039,44.19678,45.298115,45.357071,45.410499,45.605962,45.645294,45.746809,45.82582,45.935245,46.083978,46.330386,46.478897,46.665314,46.895663,46.967453,47.589264,47.768397,47.946279,48.052725,48.171484,48.279661,48.543855,48.687534,48.727763,49.000687]}]],[[{"lng":[-95.76564500000001,-94.48927999999999,-93.26061199999999,-92.09638699999999,-91.72911499999999,-91.48450699999999,-91.419422,-91.506501,-91.494878,-91.420878,-91.429519,-91.370009,-91.100307,-91.059439,-90.84010600000001,-90.72698099999999,-90.682744,-90.712541,-90.6614,-90.54403000000001,-90.4508099,-90.250248,-90.113327,-90.21201000000001,-90.191811,-90.349743,-90.35390200000001,-90.243116,-90.130788,-89.901832,-89.844786,-89.739873,-89.583316,-89.51200900000001,-89.516447,-89.422465,-89.51833999999999,-89.29213,-89.132915,-89.10076599999999,-89.19947999999999,-89.15907973960715,-89.2273187473191,-89.37545290376114,-89.41729305374206,-89.48542717558701,-89.53923218830384,-89.53182221247086,-89.61181915064232,-89.59400008709046,-89.68002902855974,-89.73309500089172,-90.37788999999999,-90.319168,-90.08373119339502,-90.06613616876078,-90.14374313679573,-90.152481116291,-91.404915,-92.35027700000001,-93.125969,-94.111473,-94.617919,-94.617964,-94.617721,-94.611858,-94.607034,-94.823791,-94.92310999999999,-95.10288799999999,-95.027644,-94.968981,-94.886933,-94.959276,-95.081534,-95.205733,-95.30829,-95.42164,-95.398667,-95.469718,-95.610439,-95.76564500000001],"lat":[40.585208,40.570707,40.580797,40.60183,40.61364,40.3839,40.378264,40.236304,40.036453,39.914865,39.837801,39.732524,39.538695,39.46886,39.340438,39.251173,39.088348,39.057064,38.924989,38.87505,38.9677587,38.919344,38.849306,38.71175,38.598951,38.377609,38.213855,38.112669,38.062341,37.869822,37.905572,37.84693,37.713261,37.685525,37.535558,37.397132,37.285497,36.992189,36.982057,36.943973,36.716045,36.6663511205733,36.56937422246305,36.61571865184408,36.49903258990225,36.49749072448476,36.49793373247038,36.33924482326221,36.30908665829651,36.12718782882031,36.08249152119139,36.00060498735579,35.995683,36.089976,36.27233217872995,36.38627212187749,36.42443328844623,36.49795225914644,36.49712,36.497787,36.497851,36.498597,36.499414,36.998905,37.77297,38.620485,39.119404,39.209874,39.384492,39.533347,39.665454,39.692954,39.833098,39.901671,39.861718,39.908275,39.999998,40.058952,40.126419,40.227908,40.31397,40.585208]}]],[[{"lng":[-116.049193,-115.207912,-113.692982,-113.009895,-111.500812,-110.171595,-108.994722,-108.236393,-107.441017,-106.050543,-104.875527,-104.048736,-104.043933,-104.045333,-104.045045,-104.045443,-104.039693,-104.057698,-105.076601,-106.2637151,-107.13418,-108.271201,-109.08301,-109.103445,-110.199503,-110.705272,-111.055199,-111.048974,-111.225208,-111.323669,-111.473178,-111.585763,-111.821488,-111.870504,-112.106755,-112.286187,-112.473207,-112.781294,-112.886041,-113.003544,-113.007194,-113.131453,-113.247166,-113.356062,-113.455071,-113.45197,-113.57467,-113.599506,-113.735601,-113.734402,-113.834555,-113.806729,-113.986656,-114.135249,-114.333218,-114.460542,-114.558253,-114.504869,-114.566172,-114.498809,-114.388243,-114.492153,-114.451912,-114.322519,-114.615036,-114.649388,-114.765106,-114.927837,-115.001274,-115.326903,-115.526751,-115.551079,-115.72148,-115.686704,-115.72377,-115.824597,-116.04885,-116.049193],"lat":[49.000912,48.999228,48.997632,48.998619,48.996963,48.999262,48.999237,48.9995299,48.999363,48.999207,48.998991,48.999877,47.971515,47.343452,46.509788,45.94531,45.000552,44.997431,45.0003474,44.9937884,45.000109,45.000251,44.99961,45.005904,44.996188,44.992324,45.001321,44.474072,44.581006,44.724474,44.665479,44.562843,44.509286,44.564033,44.520829,44.568472,44.480027,44.484888,44.395874,44.450814,44.52596,44.772837,44.82295,44.819798,44.865424,45.059247,45.128411,45.191114,45.325265,45.392353,45.520729,45.602146,45.704564,45.557465,45.459316,45.561283,45.585104,45.722176,45.773864,45.850676,45.88234,46.04729,46.241253,46.611066,46.639733,46.73289,46.758153,46.83599,46.971901,47.255912,47.303219,47.349856,47.424469,47.485596,47.696671,47.752154,47.977186,49.000912]}]],[[{"lng":[-119.9991682755169,-118.6964090874737,-117.6259722061418,-117.026195987366,-116.368478,-115.031783,-114.041723,-114.041396,-114.043176,-114.046555,-114.047079,-114.050485,-114.049677,-114.0506,-114.046838,-114.15413,-114.238799,-114.372106,-114.572031,-114.736165,-114.731159,-114.667194,-114.71211,-114.689407,-114.653406,-114.677643,-114.595931,-114.572747,-114.633487,-115.271342,-115.750844,-116.541983,-117.375905,-117.875927,-118.771867,-119.587679,-120.001014,-120.005746,-119.997634,-119.995926,-119.999866,-119.9991682755169],"lat":[41.99453972890072,41.99179279535032,41.99809962276262,41.99988853182847,41.996281,41.996008,41.99372,41.219958,40.771675,39.996899,39.499943,38.499955,37.823645,37.000396,36.194069,36.023862,36.014561,36.143114,36.15161,36.104367,35.943916,35.874787,35.806185,35.651412,35.610789,35.489742,35.325234,35.138725,35.001857,35.51266,35.889287,36.499952,37.126843,37.497267,38.141871,38.714734,38.999574,39.22521,39.956505,40.499901,41.183974,41.99453972890072]}]],[[{"lng":[-75.55944387754461,-75.50973993739468,-75.41506046521718,-75.33043167595787,-75.150721,-75.13012000000001,-74.81630699999999,-74.77040599999999,-75.056102,-75.06861499999999,-75.194046,-75.20392,-75.171587,-75.053664,-75.13057499999999,-75.02577700000001,-74.882139,-74.83836599999999,-74.694914,-74.30199399999999,-73.90268,-73.929006,-74.047313,-74.070198,-74.202247,-74.260611,-73.99850499999999,-73.977442,-74.030181,-74.096906,-74.304343,-74.41269200000001,-74.614481,-74.792723,-74.864458,-74.97199388489177,-74.88716700000001,-75.17750448377772,-75.36501392992011,-75.46520967688015,-75.53642858557886,-75.51272972231978,-75.55586782498102,-75.55944387754461],"lat":[39.62981354079567,39.68611432965172,39.80192013779865,39.84901324898212,39.882713,39.958712,40.12761,40.214508,40.416066,40.542223,40.576256,40.691498,40.777745,40.87366,40.991093,41.039806,41.180836,41.277286,41.357423,41.172594,40.997297,40.889578,40.690466,40.660827,40.630903,40.502436,40.410911,40.299373,40.122814,39.76303,39.471445,39.360816,39.244659,38.991991,38.94041,38.94037268991403,39.158825,39.24274766908224,39.34139004521423,39.43893204037988,39.46056099575794,39.57800168214632,39.6058256117408,39.62981354079567]}]],[[{"lng":[-74.070198,-74.112585,-74.260611,-74.202247,-74.070198],"lat":[40.660827,40.547603,40.502436,40.630903,40.660827]}],[{"lng":[-79.761951,-79.429119,-79.351989,-79.148723,-79.04886,-78.853455,-78.93236,-79.011563,-79.01053,-79.070469,-78.63434599999999,-78.488857,-77.976438,-77.75693099999999,-77.577223,-77.391015,-77.11186600000001,-76.952174,-76.69835999999999,-76.630774,-76.410636,-76.29710300000001,-76.203473,-76.229268,-76.136663,-76.321297,-76.370706,-76.312647,-76.161833,-75.91298500000001,-75.76622999999999,-75.505903,-75.241303,-74.972463,-74.826578,-74.68397299999999,-74.14681400000001,-73.343124,-73.381359,-73.335443,-73.38982,-73.299885,-73.333575,-73.311025,-73.390805,-73.43774000000001,-73.350593,-73.42791,-73.302076,-73.246821,-73.278673,-73.264957,-73.50814200000001,-73.487314,-73.550961,-73.482709,-73.72777499999999,-73.657336,-73.756776,-73.713674,-73.400862,-73.229285,-73.14078499999999,-72.77410399999999,-72.63556199999999,-72.335177,-72.260515,-72.162898,-72.095456,-71.91938500000001,-71.87391,-72.39585,-72.768152,-73.054963,-73.20844,-73.326262,-73.559093,-73.774928,-73.940591,-74.042412,-74.047313,-73.929006,-73.90268,-74.30199399999999,-74.694914,-74.75858700000001,-74.88869099999999,-74.98437199999999,-75.044224,-75.053431,-75.11439900000001,-75.26381499999999,-75.359579,-76.343722,-77.12469299999999,-77.83203,-78.874759,-79.761313,-79.761951],"lat":[42.26986,42.42838,42.48892,42.553672,42.689158,42.783958,42.955857,42.985256,43.064389,43.262454,43.357624,43.374763,43.369159,43.337361,43.243263,43.276363,43.287945,43.270692,43.344436,43.413356,43.523159,43.51287,43.574978,43.804135,43.934592,44.031208,44.100499,44.199044,44.280777,44.368084,44.515851,44.705081,44.866958,44.983402,45.01585,44.99969,44.9915,45.01084,44.845021,44.804602,44.61721,44.476652,44.372288,44.27424,44.189072,44.045006,43.771939,43.634428,43.624364,43.52578,42.83341,42.74594,42.086257,42.049638,41.295422,41.21276,41.100696,40.985171,40.912599,40.870099,40.953997,40.905121,40.966178,40.965314,40.981957,41.106917,41.042065,41.053187,40.991349,41.080517,41.052278,40.86666,40.761587,40.666371,40.630884,40.6331,40.582027,40.590759,40.542896,40.624847,40.690466,40.889578,40.997297,41.172594,41.357423,41.423287,41.438259,41.506611,41.617978,41.752538,41.843583,41.870757,41.999445,41.998346,41.999395,41.998524,41.997559,41.998808,42.26986]}]],[[{"lng":[-104.048736,-103.375467,-102.216993,-101.125434,-99.91378,-98.86903700000001,-97.950205,-97.229039,-97.136083,-97.098697,-97.163105,-97.11657,-97.146672,-97.075641,-97.054554,-96.939179,-96.851293,-96.819558,-96.77655799999999,-96.798357,-96.735123,-96.599761,-96.554507,-96.563672,-97.784575,-98.414518,-99.257745,-100.170826,-101.41989,-102.176993,-102.920482,-104.045443,-104.045045,-104.045333,-104.043933,-104.048736],"lat":[48.999877,48.998951,48.998553,48.999078,48.999049,49.000205,49.0005151,49.000687,48.727763,48.687534,48.543855,48.279661,48.171484,48.052725,47.946279,47.768397,47.589264,46.967453,46.895663,46.665314,46.478897,46.330386,46.083978,45.935245,45.935327,45.936504,45.94006,45.942514,45.943763,45.944622,45.945038,45.94531,46.509788,47.343452,47.971515,48.999877]}]],[[{"lng":[-103.002199,-102.04224,-100.734517,-99.648652,-98.354073,-97.46228000000001,-96.500288,-95.40768300000001,-94.617964,-94.617919,-94.43121499999999,-94.45753000000001,-94.48587499999999,-94.652265,-94.775064,-94.830804,-95.131056,-95.230491,-95.29478899999999,-95.533283,-95.563424,-95.828245,-95.941267,-96.14807,-96.16945200000001,-96.277269,-96.342665,-96.42264299999999,-96.67344900000001,-96.690708,-96.866438,-96.92211399999999,-97.172192,-97.166629,-97.210921,-97.372941,-97.462857,-97.671772,-97.834333,-97.967777,-97.94595,-98.08283900000001,-98.16912000000001,-98.364023,-98.486328,-98.577136,-98.76557,-98.90934900000001,-99.189511,-99.21313499999999,-99.261321,-99.39495599999999,-99.39725300000001,-99.58006,-99.696462,-99.887147,-100.000381,-100.000392,-100.000406,-101.085156,-102.250453,-103.002434,-103.002199],"lat":[37.000104,36.993083,36.999059,36.999604,36.997961,36.998685,36.998643,36.999241,36.998905,36.499414,35.39429,34.642961,33.637867,33.690979,33.755038,33.740068,33.936925,33.960764,33.875388,33.881162,33.932193,33.836054,33.861619,33.837799,33.770131,33.769735,33.686975,33.776041,33.912278,33.849959,33.853149,33.959579,33.737545,33.847311,33.916064,33.819454,33.841772,33.99137,33.857671,33.88243,33.988396,34.002412,34.114171,34.157109,34.062598,34.148962,34.136376,34.177499,34.214312,34.340369,34.403499,34.442099,34.377871,34.416653,34.381036,34.549047,34.560509,35.619115,36.499702,36.499244,36.500369,36.500397,37.000104]}]],[[{"lng":[-80.519425,-80.188085,-79.761951,-79.761313,-78.874759,-77.83203,-77.12469299999999,-76.343722,-75.359579,-75.26381499999999,-75.11439900000001,-75.053431,-75.044224,-74.98437199999999,-74.88869099999999,-74.75858700000001,-74.694914,-74.83836599999999,-74.882139,-75.02577700000001,-75.13057499999999,-75.053664,-75.171587,-75.20392,-75.194046,-75.06861499999999,-75.056102,-74.77040599999999,-74.81630699999999,-75.13012000000001,-75.150721,-75.33043167595787,-75.41506046521718,-75.61723845454294,-75.78859429228112,-76.99106130333044,-77.53488045858678,-78.53776170538879,-79.47666182984135,-80.51934199999999,-80.518991,-80.518693,-80.519425],"lat":[41.977523,42.094257,42.26986,41.998808,41.997559,41.998524,41.999395,41.998346,41.999445,41.870757,41.843583,41.752538,41.617978,41.506611,41.438259,41.423287,41.357423,41.277286,41.180836,41.039806,40.991093,40.87366,40.777745,40.691498,40.576256,40.542223,40.416066,40.214508,40.12761,39.958712,39.882713,39.84901324898212,39.80192013779865,39.83422816535811,39.72220041497388,39.72006257448648,39.72033766980041,39.72258844106477,39.72107658033247,39.721403,40.638801,41.248855,41.977523]}]],[[{"lng":[-83.10861265487796,-82.46009186964524,-82.27491989115249,-81.04362500000001,-80.93495,-80.782042,-80.797543,-79.675299,-79.249763,-78.541087,-78.714116,-78.938076,-79.084588,-79.147496,-79.18787,-79.329909,-79.359961,-79.48349899999999,-79.617611,-79.57600600000001,-79.726389,-79.848527,-79.884961,-80.000801,-80.20523,-80.332438,-80.47206799999999,-80.42929100000001,-80.466342,-80.618286,-80.721463,-80.844431,-80.88551699999999,-81.006745,-81.117234,-81.155995,-81.11963299999999,-81.281324,-81.411906,-81.42161400000001,-81.50271600000001,-81.49141899999999,-81.617779,-81.704634,-81.82793599999999,-81.847296,-81.944737,-81.913532,-82.046335,-82.196583,-82.255267,-82.34693300000001,-82.55683500000001,-82.596155,-82.717507,-82.746656,-82.902665,-83.00292399999999,-83.168278,-83.33869,-83.323866,-83.239081,-83.121112,-83.10861265487796],"lat":[35.00065900853208,35.17814314822968,35.20007114368154,35.149877,35.107409,34.935782,34.819786,34.804744,34.449774,33.851112,33.800138,33.639826,33.483669,33.378243,33.173712,33.089986,33.006672,33.001265,32.952726,32.906235,32.805996,32.755248,32.684402,32.605892,32.555547,32.478104,32.496964,32.389667,32.31917,32.260183,32.160427,32.109709,32.0346,32.101152,32.117605,32.241478,32.287596,32.556464,32.61841,32.835178,32.938688,33.008078,33.095277,33.116451,33.228746,33.306783,33.364041,33.441274,33.56383,33.630582,33.75969,33.834298,33.945353,34.030517,34.150504,34.266407,34.485902,34.472132,34.590998,34.682002,34.789712,34.875661,34.939129,35.00065900853208]}]],[[{"lng":[-104.057698,-104.039693,-104.045443,-102.920482,-102.176993,-101.41989,-100.170826,-99.257745,-98.414518,-97.784575,-96.563672,-96.57974,-96.652226,-96.840746,-96.85775099999999,-96.680454,-96.489065,-96.453067,-96.4527743,-96.45326,-96.5989289,-96.524044,-96.554937,-96.485264,-96.439335,-96.51099499999999,-96.544321,-96.63970399999999,-96.53787699999999,-96.445508,-96.501321,-96.710995,-96.687669,-96.982197,-97.131331,-97.30667699999999,-97.442279,-97.68650599999999,-97.84527,-97.950147,-98.035034,-98.12903799999999,-98.467356,-98.49854999999999,-99.47135299999999,-100.631728,-101.625424,-102.487329,-103.132955,-104.053127,-104.055488,-104.057698],"lat":[44.997431,45.000552,45.94531,45.945038,45.944622,45.943763,45.942514,45.94006,45.936504,45.935327,45.935245,45.82582,45.746809,45.645294,45.605962,45.410499,45.357071,45.298115,44.19678,43.50039,43.500441,43.394762,43.226775,43.224183,43.113916,43.024701,42.851282,42.737071,42.655431,42.49063,42.482749,42.608128,42.653126,42.760554,42.771929,42.867604,42.846224,42.842435,42.867734,42.769619,42.764205,42.821228,42.947556,42.99856,42.997967,42.998092,42.996238,42.999559,43.000784,43.000585,43.853476,44.997431]}]],[[{"lng":[-103.002434,-102.250453,-101.085156,-100.000406,-100.000392,-100.000381,-99.887147,-99.696462,-99.58006,-99.39725300000001,-99.39495599999999,-99.261321,-99.21313499999999,-99.189511,-98.90934900000001,-98.76557,-98.577136,-98.486328,-98.364023,-98.16912000000001,-98.08283900000001,-97.94595,-97.967777,-97.834333,-97.671772,-97.462857,-97.372941,-97.210921,-97.166629,-97.172192,-96.92211399999999,-96.866438,-96.690708,-96.67344900000001,-96.42264299999999,-96.342665,-96.277269,-96.16945200000001,-96.14807,-95.941267,-95.828245,-95.563424,-95.533283,-95.29478899999999,-95.230491,-95.131056,-94.830804,-94.775064,-94.652265,-94.48587499999999,-94.392573,-94.226392,-94.183395,-94.04345000000001,-94.042964,-94.04272,-93.90955700000001,-93.822598,-93.81858200000001,-93.725925,-93.62034300000001,-93.600308,-93.516943,-93.56778799999999,-93.554057,-93.621093,-93.727844,-93.697828,-93.758554,-93.714319,-93.697748,-93.720805,-93.786935,-93.85514000000001,-93.92274399999999,-93.837971,-94.001406,-94.133709,-94.594853,-94.546385,-94.74069900000001,-94.696023,-94.816085,-94.872551,-95.005398,-94.981916,-94.909465,-94.89399400000001,-94.803695,-95.026219,-95.35345100000001,-95.812504,-96.220376,-96.390376,-96.442849,-96.63200999999999,-96.886459,-96.919872,-96.734745,-96.59900399999999,-96.440591,-96.45295,-96.620633,-96.684355,-96.710336,-96.794815,-96.80041300000001,-96.934765,-97.037008,-97.214039,-97.04876,-97.187183,-97.25079700000001,-97.45429300000001,-97.36835499999999,-97.253955,-97.321535,-97.404996,-97.514411,-97.60906799999999,-97.54291000000001,-97.422299,-97.467337,-97.406813,-97.279892,-97.31056599999999,-97.290588,-97.15200900000001,-97.146294,-97.276707,-97.367642,-97.37286400000001,-97.521762,-97.649176,-97.88652999999999,-98.03923899999999,-98.248806,-98.46507699999999,-98.585184,-98.669397,-98.82457100000001,-99.110855,-99.091635,-99.166742,-99.208907,-99.268613,-99.446524,-99.426348,-99.50483699999999,-99.48021900000001,-99.51111899999999,-99.603533,-99.704601,-99.813086,-99.87767700000001,-99.893456,-99.99144699999999,-100.083393,-100.208059,-100.294296,-100.336186,-100.500354,-100.507613,-100.602054,-100.651512,-100.674656,-100.775905,-100.797671,-101.010614,-101.060151,-101.261175,-101.252274,-101.367198,-101.475269,-101.714224,-101.974548,-102.115682,-102.181894,-102.341033,-102.386678,-102.490331,-102.677192,-102.693466,-102.808692,-102.843021,-102.953475,-103.100266,-103.115328,-103.28119,-103.427754,-103.558679,-103.724743,-103.838303,-104.038282,-104.18007,-104.264155,-104.338113,-104.507568,-104.565688,-104.679772,-104.706874,-104.687296,-104.761634,-104.859521,-104.899001,-104.9863,-105.195144,-105.39669,-105.399609,-105.55743,-105.60333,-105.773257,-105.953943,-106.080258,-106.205827,-106.381039,-106.528242,-106.635926,-106.618486,-105.429281,-104.531756,-103.722882,-103.064423,-103.064625,-103.04395,-103.042781,-103.041554,-103.041924,-103.002434],"lat":[36.500397,36.500369,36.499244,36.499702,35.619115,34.560509,34.549047,34.381036,34.416653,34.377871,34.442099,34.403499,34.340369,34.214312,34.177499,34.136376,34.148962,34.062598,34.157109,34.114171,34.002412,33.988396,33.88243,33.857671,33.99137,33.841772,33.819454,33.916064,33.847311,33.737545,33.959579,33.853149,33.849959,33.912278,33.776041,33.686975,33.769735,33.770131,33.837799,33.861619,33.836054,33.932193,33.881162,33.875388,33.960764,33.936925,33.740068,33.755038,33.690979,33.637867,33.551142,33.552912,33.592212,33.552253,33.019219,31.999265,31.893144,31.773559,31.554826,31.504092,31.271025,31.176158,31.023662,30.888302,30.824941,30.695159,30.57407,30.443838,30.387077,30.294282,30.152944,30.053043,29.99058,29.864099,29.818808,29.690619,29.681486,29.647289,29.467903,29.572048,29.525858,29.75755,29.75671,29.67125,29.659366,29.511141,29.496838,29.30817,29.279237,29.148064,28.898145,28.664942,28.491966,28.381815,28.317666,28.222821,28.030734,28.093547,28.190771,28.293287,28.34298,28.418679,28.31913,28.314464,28.406827,28.364587,28.224128,28.123873,28.185528,28.087494,28.022092,27.824126,27.876035,27.873824,27.741683,27.696696,27.571199,27.329977,27.361529,27.285193,27.229213,27.257712,26.710126,26.499492,26.270923,26.23057,26.104776,26.062108,25.955606,25.952147,25.91568,25.840117,25.886458,26.021499,26.066339,26.041275,26.073101,26.222335,26.254429,26.23632,26.370715,26.426278,26.476977,26.536079,26.724761,26.843213,27.023008,27.176262,27.338289,27.485796,27.564494,27.641992,27.654954,27.773952,27.799427,27.899208,27.99456,28.144035,28.190383,28.284381,28.430181,28.66196,28.740599,28.901944,28.943432,29.099777,29.173344,29.246943,29.368669,29.458661,29.536777,29.625634,29.664041,29.780663,29.76766,29.810276,29.79239,29.846034,29.869305,29.76688,29.783948,29.738261,29.676507,29.522319,29.357988,29.176308,29.0577,28.98527,28.982138,29.042334,29.154962,29.19147,29.278304,29.320156,29.412764,29.514001,29.519967,29.639624,29.770462,29.924659,30.050685,30.179464,30.301148,30.390413,30.5704,30.661059,30.792138,30.855427,30.888941,30.990229,31.082625,31.166897,31.364749,31.398702,31.465976,31.73211,31.783148,31.866235,32.000495,32.000577,32.000117,32.0002084,32.000518,32.999899,33.974629,34.850243,35.6224876,36.500439,36.500397]}]],[[{"lng":[-73.343124,-72.84563300000001,-72.310073,-71.501088,-71.49392,-71.62518,-71.551722,-71.59948,-71.812473,-72.033136,-72.067774,-72.03124,-72.116985,-72.184847,-72.30286700000001,-72.373126,-72.45689,-72.44463500000001,-72.534554,-72.542784,-72.458519,-73.264957,-73.278673,-73.246821,-73.302076,-73.42791,-73.350593,-73.43774000000001,-73.390805,-73.311025,-73.333575,-73.299885,-73.38982,-73.335443,-73.381359,-73.343124],"lat":[45.01084,45.016659,45.003822,45.013377,44.910923,44.743978,44.627598,44.486455,44.358477,44.320365,44.270976,44.100101,43.99448,43.804698,43.702718,43.579419,43.146558,43.010566,42.949894,42.808482,42.726853,42.74594,42.83341,43.52578,43.624364,43.634428,43.771939,44.045006,44.189072,44.27424,44.372288,44.476652,44.61721,44.804602,44.845021,45.01084]}]],[[{"lng":[-82.593673,-82.529579,-82.323999,-82.29127099999999,-82.188767,-82.182467,-82.217269,-82.035963,-81.844486,-81.78182,-81.756254,-81.678331,-81.57024699999999,-81.557547,-81.456143,-81.347567,-81.223581,-81.0239,-80.88036,-80.86533900000001,-80.740126,-80.70460199999999,-80.599895,-80.599194,-80.666917,-80.518991,-80.51934199999999,-79.47666182984135,-79.48687240019301,-79.25388955029155,-79.09542609632726,-78.95333105069993,-78.82600722033089,-78.56592736742009,-78.4628975372414,-78.42054764654087,-78.26683167889334,-78.17135955839501,-78.01134110270598,-77.83800548807491,-77.8661296212736,-77.75308750247062,-77.71951677781739,-77.82815587980679,-78.34708562203396,-78.34047890551993,-78.41942120248224,-78.40369643472282,-78.57190081630819,-78.60165495587587,-78.78803118995395,-78.86927636446102,-78.99399727652859,-79.12975751750555,-79.21059164027868,-79.31227667970465,-79.47663868187257,-79.53686999999999,-79.649075,-79.68967499999999,-79.787542,-79.898426,-80.00250699999999,-80.16220199999999,-80.296138,-80.25891900000001,-80.299789,-80.475601,-80.552036,-80.705203,-80.784188,-80.947896,-81.112596,-81.225104,-81.362156,-81.560625,-81.67821000000001,-81.761752,-81.92849699999999,-81.96829700000001,-82.054787,-82.296262,-82.34045500000001,-82.501862,-82.551259,-82.637306,-82.574656,-82.593673],"lat":[38.421809,38.405182,38.449268,38.578983,38.594984,38.708782,38.79568,39.025478,38.928746,38.964935,39.177276,39.273755,39.267675,39.338774,39.409274,39.34577,39.386062,39.552313,39.620706,39.753251,39.970793,40.154823,40.317669,40.482566,40.573664,40.638801,39.721403,39.72107658033247,39.20596056280304,39.33722077533277,39.46254657031805,39.46364373442996,39.58882798717875,39.51944347319182,39.52083965380521,39.62402062727183,39.61881776832298,39.69561189095351,39.60408306866731,39.60612517657451,39.517661116768,39.42326243714108,39.32131467317596,39.13232942411334,39.46601176752456,39.35349185042926,39.25747590145475,39.16745096535858,39.03199505970398,38.96460311552549,38.88512312021457,38.76299119416846,38.85010199173786,38.65501720217282,38.49291329624842,38.41187629454701,38.45722827734036,38.550917,38.591515,38.431439,38.273298,38.193045,37.992767,37.875122,37.691783,37.595499,37.508271,37.422949,37.473563,37.394618,37.394587,37.295872,37.278497,37.234874,37.337687,37.206663,37.201483,37.275713,37.360645,37.537798,37.536756,37.687067,37.786058,37.9332,38.070799,38.13905,38.263873,38.421809]}]],[[{"lng":[-94.617919,-94.111473,-93.125969,-92.35027700000001,-91.404915,-90.152481116291,-90.14374313679573,-90.06613616876078,-90.08373119339502,-90.319168,-90.37788999999999,-89.73309500089172,-89.65614700196173,-89.76568900257597,-89.81445599380437,-89.95027799601891,-89.91068698282115,-90.12944789528018,-90.07499188280219,-90.15886488405889,-90.06659106395834,-90.17360318285695,-90.20939741737486,-90.30929736863703,-90.250095,-90.41486399999999,-90.517168,-90.613944,-90.756197,-90.740889,-90.832407,-90.847808,-90.94632300000001,-90.88895599999999,-91.08792099999999,-91.010831,-91.07088299999999,-91.05388600000001,-91.084126,-91.160866,-91.219048,-91.228489,-91.08287799999999,-91.08758899999999,-91.166073,-91.951958,-92.796533,-94.042964,-94.04345000000001,-94.183395,-94.226392,-94.392573,-94.48587499999999,-94.45753000000001,-94.43121499999999,-94.617919],"lat":[36.499414,36.498597,36.497851,36.497787,36.49712,36.49795225914644,36.42443328844623,36.38627212187749,36.27233217872995,36.089976,35.995683,36.00060498735579,35.92580762418355,35.8912968932096,35.75994007486489,35.73849276751309,35.6175355856132,35.4419313493998,35.38415203214304,35.26257699842181,35.13598901678809,35.11807188179949,35.02654402953721,34.99569217037419,34.90732,34.831846,34.630928,34.390723,34.367256,34.306538,34.267491,34.20653,34.109374,34.029788,33.975335,33.925552,33.866714,33.778701,33.657322,33.707096,33.661503,33.564667,33.221621,33.145177,33.004106,33.007428,33.014836,33.019219,33.552253,33.592212,33.552912,33.551142,33.637867,34.642961,35.39429,36.499414]}]],[[{"lng":[-118.603375,-118.368301,-118.310213,-118.465368,-118.48875,-118.603375],"lat":[33.478098,33.40711,33.335795,33.326056,33.419826,33.478098]}],[{"lng":[-118.605534,-118.369984,-118.496298,-118.605534],"lat":[33.030999,32.839273,32.851572,33.030999]}],[{"lng":[-119.919155,-119.755521,-119.721206,-119.873358,-119.919155],"lat":[34.07728,34.056716,33.959583,33.980375,34.07728]}],[{"lng":[-120.247393,-120.073609,-119.973691,-120.121817,-120.247393],"lat":[34.001911,34.024477,33.942481,33.895712,34.001911]}],[{"lng":[-124.2116038371603,-123.3475608413391,-122.3781904030287,-121.5808639984979,-121.0351954477332,-119.9991682755169,-119.999866,-119.995926,-119.997634,-120.005746,-120.001014,-119.587679,-118.771867,-117.875927,-117.375905,-116.541983,-115.750844,-115.271342,-114.633487,-114.630682,-114.47162,-114.342615,-114.138282,-114.254141,-114.415908,-114.460264,-114.533679,-114.496489,-114.558898,-114.62964,-114.722872,-114.677032,-114.707896,-114.670803,-114.50613,-114.468971,-114.539093,-114.719633,-116.04662,-117.124862,-117.139464,-117.246069,-117.25167,-117.328359,-117.50565,-117.784888,-117.927091,-118.088896,-118.258687,-118.411211,-118.392107,-118.519514,-118.744952,-118.805114,-119.216441,-119.270144,-119.461036,-119.559459,-119.873971,-120.008077,-120.141165,-120.471376,-120.511421,-120.645739,-120.60197,-120.637415,-120.609898,-120.670835,-120.629931,-120.698906,-120.786076,-120.89679,-120.869209,-121.003359,-121.166712,-121.284973,-121.332449,-121.462264,-121.503112,-121.574602,-121.717176,-121.813734,-121.894714,-121.9416,-121.923866,-121.825052,-121.788278,-121.862266,-122.105976,-122.20618,-122.405073,-122.40085,-122.452087,-122.516689,-122.496784,-122.514483,-122.407452,-122.360219,-122.140142,-122.163049,-122.33079,-122.309986,-122.413725,-122.368891,-122.262861,-122.393588,-122.491283,-122.476473,-122.529185,-122.656519,-122.70264,-122.821383,-122.939711,-122.968569,-123.128825,-123.331899,-123.441774,-123.725367,-123.693969,-123.803848,-123.826306,-123.766475,-123.851714,-124.110549,-124.187874,-124.363414,-124.347853,-124.409591,-124.329404,-124.158322,-124.112165,-124.153622,-124.063076,-124.143479,-124.255994,-124.219592,-124.2116038371603],"lat":[41.99846223151689,41.99910918542329,42.00952002126983,41.99866789264352,41.99332258958397,41.99453972890072,41.183974,40.499901,39.956505,39.22521,38.999574,38.714734,38.141871,37.497267,37.126843,36.499952,35.889287,35.51266,35.001857,34.866352,34.712966,34.451442,34.30323,34.173831,34.107636,33.996649,33.926072,33.696901,33.531819,33.428138,33.398779,33.27017,33.097432,33.037984,33.01701,32.845155,32.756949,32.718763,32.623353,32.534156,32.627054,32.669352,32.874346,33.121842,33.334063,33.541525,33.605521,33.729817,33.703741,33.741985,33.840915,34.027509,34.032103,34.001239,34.146105,34.252903,34.374064,34.413395,34.408795,34.460447,34.473405,34.447846,34.522953,34.581035,34.692095,34.755895,34.842751,34.904115,35.061515,35.171192,35.177666,35.247877,35.403276,35.46071,35.635399,35.674109,35.783106,35.885618,36.000299,36.025156,36.195146,36.234235,36.317806,36.485602,36.634559,36.657207,36.803994,36.931552,36.955951,37.013949,37.195791,37.359225,37.48054,37.52134,37.686433,37.780829,37.811441,37.592501,37.507907,37.667933,37.78383,37.892755,37.937262,38.007948,38.0446,38.143449,38.108087,37.832513,37.819028,37.904519,37.89382,37.996735,38.031908,38.242879,38.450418,38.565542,38.699744,38.917438,39.057363,39.278771,39.36871,39.552803,39.832041,40.103765,40.130542,40.260974,40.314634,40.438076,40.61643,40.876069,41.028173,41.05355,41.439579,41.709284,41.783014,41.846432,41.99846223151689]}]],[[{"lng":[-75.78859429228112,-75.61723845454294,-75.41506046521718,-75.50973993739468,-75.58714495072779,-75.56303174415618,-75.58943661936247,-75.43902474349177,-75.39301284293407,-75.39627490304824,-75.31227962502793,-75.19054927706149,-75.08215046564483,-75.04893271251233,-75.69371506408115,-75.75617588347549,-75.78859429228112],"lat":[39.72220041497388,39.83422816535811,39.80192013779865,39.68611432965172,39.65101349497807,39.56224174616401,39.46081400108331,39.31338612623914,39.20451412579122,39.05788633071921,38.92459653016798,38.8068640811212,38.77216048393391,38.45126767395859,38.46012942331778,39.24622450217678,39.72220041497388]}]],[[{"lng":[-77.11975617809924,-77.04101521144025,-76.90938972909245,-77.03900270830759,-77.03169482922819,-77.11975617809924],"lat":[38.93434316987882,38.99554827201952,38.89285233732465,38.7916450101518,38.85051209062014,38.93434316987882]}]],[[{"lng":[-91.419422,-91.37574600000001,-91.348733,-91.12392800000001,-91.096846,-90.96291600000001,-90.94662700000001,-91.113648,-91.047819,-90.85755399999999,-90.655839,-90.595237,-90.461432,-90.343228,-90.31522,-90.187969,-90.140061,-90.16289500000001,-90.391108,-90.477279,-90.654027,-90.64284274974769,-90.07367017448281,-88.78667984515161,-87.80047145187332,-87.83476899999999,-87.800066,-87.68235900000001,-87.600549,-87.524044,-87.52671100000001,-87.526809,-87.533227,-87.53164599999999,-87.61005,-87.574558,-87.640435,-87.512187,-87.550515,-87.496537,-87.519609,-87.62012,-87.654166,-87.73952199999999,-87.745254,-87.854643,-87.93732900000001,-87.984234,-87.945472,-88.035332,-88.013355,-88.02803,-88.158207,-88.087664,-88.281667,-88.361557,-88.476592,-88.515939,-88.424403,-88.45894800000001,-88.54540299999999,-88.916934,-89.02998100000001,-89.182509,-89.132915,-89.29213,-89.51833999999999,-89.422465,-89.516447,-89.51200900000001,-89.583316,-89.739873,-89.844786,-89.901832,-90.130788,-90.243116,-90.35390200000001,-90.349743,-90.191811,-90.21201000000001,-90.113327,-90.250248,-90.4508099,-90.54403000000001,-90.6614,-90.712541,-90.682744,-90.72698099999999,-90.84010600000001,-91.059439,-91.100307,-91.370009,-91.429519,-91.420878,-91.494878,-91.506501,-91.419422],"lat":[40.378264,40.391879,40.609695,40.669152,40.811617,40.924957,41.096632,41.241401,41.4109,41.452751,41.462132,41.511032,41.523533,41.587833,41.734264,41.803163,42.003252,42.116718,42.225473,42.383794,42.478503,42.50848149348297,42.50827584499147,42.49198373021532,42.49192096008414,42.301522,42.208024,42.075729,41.826833,41.708335,41.121485,40.46217,39.883127,39.347888,39.282232,39.218404,39.166727,38.954417,38.85956,38.778571,38.697198,38.639489,38.511911,38.475069,38.408996,38.275376,38.292431,38.20996,38.126616,38.051145,37.894854,37.799224,37.664542,37.471059,37.452596,37.402931,37.386875,37.284043,37.152428,37.073796,37.070003,37.224291,37.211144,37.037275,36.982057,36.992189,37.285497,37.397132,37.535558,37.685525,37.713261,37.84693,37.905572,37.869822,38.062341,38.112669,38.213855,38.377609,38.598951,38.71175,38.849306,38.919344,38.9677587,38.87505,38.924989,39.057064,39.088348,39.251173,39.340438,39.46886,39.538695,39.732524,39.837801,39.914865,40.036453,40.236304,40.378264]}]],[[{"lng":[-96.45326,-95.740813,-94.47042,-93.795793,-92.79031710338838,-91.94987904932039,-91.21770573392232,-91.20184704025498,-91.05791023057573,-91.17793195221209,-91.14617661334533,-91.10056456695511,-91.05127453083502,-90.95241453512696,-90.72020858539626,-90.64284274974769,-90.654027,-90.477279,-90.391108,-90.16289500000001,-90.140061,-90.187969,-90.31522,-90.343228,-90.461432,-90.595237,-90.655839,-90.85755399999999,-91.047819,-91.113648,-90.94662700000001,-90.96291600000001,-91.096846,-91.12392800000001,-91.348733,-91.37574600000001,-91.419422,-91.48450699999999,-91.72911499999999,-92.09638699999999,-93.26061199999999,-94.48927999999999,-95.76564500000001,-95.789485,-95.888907,-95.812083,-95.86349199999999,-95.862587,-95.92599,-95.93292099999999,-96.089714,-96.117751,-96.06966199999999,-96.161756,-96.267318,-96.347752,-96.323723,-96.40799800000001,-96.380707,-96.445508,-96.53787699999999,-96.63970399999999,-96.544321,-96.51099499999999,-96.439335,-96.485264,-96.554937,-96.524044,-96.5989289,-96.45326],"lat":[43.50039,43.499894,43.50034,43.49952,43.49956689274306,43.500485138229,43.50055019010122,43.34910336201852,43.25396887481952,43.12887545615383,42.90985040028316,42.88307849741747,42.73700138032611,42.68677840268116,42.64075850611809,42.50848149348297,42.478503,42.383794,42.225473,42.116718,42.003252,41.803163,41.734264,41.587833,41.523533,41.511032,41.462132,41.452751,41.4109,41.241401,41.096632,40.924957,40.811617,40.669152,40.609695,40.391879,40.378264,40.3839,40.61364,40.60183,40.580797,40.570707,40.585208,40.659388,40.731855,40.884239,40.99734,41.088399,41.195698,41.463798,41.531778,41.694221,41.803509,41.90182,42.110265,42.166806,42.229887,42.337408,42.446394,42.49063,42.655431,42.737071,42.851282,43.024701,43.113916,43.224183,43.226775,43.394762,43.500441,43.50039]}]],[[{"lng":[-89.132915,-89.182509,-89.02998100000001,-88.916934,-88.54540299999999,-88.45894800000001,-88.424403,-88.515939,-88.476592,-88.361557,-88.281667,-88.087664,-88.158207,-88.02803,-87.90680999999999,-87.830578,-87.68401799999999,-87.591582,-87.450458,-87.380247,-87.220944,-87.07073200000001,-87.033444,-86.794985,-86.75099,-86.598108,-86.534156,-86.51728900000001,-86.37532400000001,-86.27180199999999,-86.266891,-86.178983,-85.95146699999999,-85.90876400000001,-85.7915759,-85.65364099999999,-85.620521,-85.433136,-85.45211399999999,-85.25884600000001,-85.190507,-84.978723,-84.811645,-84.83712,-84.897171,-84.82015699999999,-84.75444899999999,-84.632446,-84.509743,-84.304698,-84.21290399999999,-84.07149099999999,-83.978814,-83.859028,-83.77216,-83.668111,-83.52095300000001,-83.36666099999999,-83.29419300000001,-83.142836,-83.03301399999999,-82.894193,-82.84718599999999,-82.724846,-82.593673,-82.574656,-82.637306,-82.551259,-82.501862,-82.34045500000001,-82.296262,-82.054787,-81.96829700000001,-82.350948,-82.498858,-82.72209700000001,-82.72225400000001,-82.822684,-82.879492,-83.07259000000001,-83.194597,-83.42370695107591,-83.53191198711416,-83.675413105578,-83.69071412901337,-84.54313831476176,-85.19537180662776,-85.48835291053624,-85.83217201902488,-86.33305106406416,-86.58990614255815,-87.11498316057822,-87.85320461445649,-88.0705327467148,-88.0324899968106,-88.05320605396949,-89.11753684070703,-89.41729305374206,-89.37545290376114,-89.2273187473191,-89.15907973960715,-89.19947999999999,-89.10076599999999,-89.132915],"lat":[36.982057,37.037275,37.211144,37.224291,37.070003,37.073796,37.152428,37.284043,37.386875,37.402931,37.452596,37.471059,37.664542,37.799224,37.807624,37.876516,37.903498,37.887194,37.941451,37.935596,37.849134,37.801937,37.906593,37.988982,37.912893,37.867382,37.917007,38.042634,38.130629,38.137874,38.057125,38.011308,38.005608,38.161169,38.2885654,38.327108,38.423105,38.523914,38.709348,38.737754,38.68795,38.77928,38.792766,38.988059,39.052407,39.10548,39.146658,39.07676,39.09366,39.006455,38.805707,38.770475,38.787104,38.756793,38.65815,38.628068,38.703045,38.658537,38.596588,38.625076,38.723805,38.756576,38.595166,38.5576,38.421809,38.263873,38.13905,38.070799,37.9332,37.786058,37.687067,37.536756,37.537798,37.267077,37.227044,37.120168,37.057948,37.004128,36.889085,36.854589,36.739487,36.66738458047518,36.6649835655294,36.60081360395027,36.58258061450596,36.5962771264572,36.62549809213424,36.61499380227968,36.6220458540943,36.64877793392042,36.6524856454422,36.64241335123491,36.63324647083262,36.67811794405326,36.54066125005746,36.49712804730289,36.50360143677081,36.49903258990225,36.61571865184408,36.56937422246305,36.6663511205733,36.716045,36.943973,36.982057]}]],[[{"lng":[-68.944597,-68.825067,-68.77029,-68.874139,-68.944597],"lat":[44.11284,44.186338,44.069566,44.025359,44.11284]}],[{"lng":[-70.703818,-70.82680000000001,-70.817865,-70.967229,-70.98906700000001,-71.03103900000001,-71.083924,-70.950824,-70.885029,-70.71228600000001,-70.631354,-70.721611,-70.644687,-70.38355199999999,-70.416922,-70.259117,-70.31297000000001,-70.310609,-70.23794700000001,-70.292736,-70.208733,-70.056433,-69.997086,-69.22441999999999,-69.03688200000001,-69.0402,-68.895685,-68.578551,-68.43255499999999,-68.336236,-68.222893,-67.952269,-67.878124,-67.790515,-67.78840599999999,-67.78109499999999,-67.803313,-67.64581,-67.42545200000001,-67.50308800000001,-67.418747,-67.46647900000001,-67.404629,-67.27107599999999,-67.112414,-67.03829899999999,-66.984466,-66.98240300000001,-67.18942699999999,-67.363158,-67.56815899999999,-67.776472,-68.049334,-68.14054899999999,-68.317588,-68.401268,-68.456879,-68.566936,-68.52910300000001,-68.598634,-68.718531,-68.678704,-68.827197,-68.88027099999999,-69.040193,-69.100863,-69.046954,-69.17498000000001,-69.220195,-69.427277,-69.705838,-69.754091,-69.835323,-69.92701099999999,-70.071304,-70.37912300000001,-70.362015,-70.41631099999999,-70.53524400000001,-70.62251000000001,-70.703818],"lat":[43.059825,43.127086,43.237911,43.343777,43.79244,44.655455,45.305451,45.33453,45.234873,45.390611,45.41634,45.515058,45.607083,45.734869,45.795279,45.890755,45.961856,46.064544,46.147378,46.191599,46.328961,46.41659,46.69523,47.459686,47.407977,47.2451,47.182883,47.287551,47.28193,47.359795,47.344526,47.196142,47.102426,47.067921,46.601795,45.943032,45.677886,45.613597,45.579086,45.489688,45.37726,45.293817,45.159926,45.191081,45.112323,44.945433,44.912557,44.811466,44.645533,44.631825,44.531117,44.514209,44.33073,44.376804,44.225101,44.252244,44.344288,44.317603,44.221774,44.174602,44.165634,44.264705,44.31216,44.428112,44.233673,44.104529,44.013794,43.976949,43.914937,43.912261,43.823024,43.743866,43.721125,43.780174,43.713772,43.507202,43.439077,43.361059,43.336771,43.134573,43.059825]}]],[[{"lng":[-79.47666182984135,-78.53776170538879,-77.53488045858678,-76.99106130333044,-75.78859429228112,-75.75617588347549,-75.69371506408115,-75.04893271251233,-75.19378665340007,-75.24225617704285,-75.62433248450799,-75.66971100000001,-75.87529062326951,-75.83755643134634,-75.94236939569181,-75.97387075401478,-76.05021491716674,-76.04410286243807,-76.16548411644061,-76.33155468651024,-76.24729554081314,-76.27958472112165,-76.08889840694935,-76.25508882673923,-76.33461508060419,-76.16398476388071,-76.27852416071588,-76.17041948095724,-76.04984342852202,-75.97659905190402,-75.97033547873923,-76.09607048946656,-76.10223002381495,-76.38489855006938,-76.44247936222338,-76.43892501825871,-76.39407688096632,-76.51943859874449,-76.55988028679386,-76.52665128184429,-76.51570214327012,-76.38834375150877,-76.38523969485196,-76.32013170242229,-76.36123296626516,-76.48103212978221,-76.59063337940424,-76.79744909014259,-76.9209291726618,-77.01636787349615,-77.20731027151072,-77.27421883950278,-77.23772243264909,-77.1301973735434,-77.04229465999599,-77.03900270830759,-76.90938972909245,-77.04101521144025,-77.11975617809924,-77.2214992678087,-77.34028442420626,-77.46261469214332,-77.5272798697046,-77.45767770202859,-77.56659372244408,-77.71951677781739,-77.75308750247062,-77.8661296212736,-77.83800548807491,-78.01134110270598,-78.17135955839501,-78.26683167889334,-78.42054764654087,-78.4628975372414,-78.56592736742009,-78.82600722033089,-78.95333105069993,-79.09542609632726,-79.25388955029155,-79.48687240019301,-79.47666182984135],"lat":[39.72107658033247,39.72258844106477,39.72033766980041,39.72006257448648,39.72220041497388,39.24622450217678,38.46012942331778,38.45126767395859,38.09601544262934,38.02721055330088,37.99421133197634,37.950796,38.01196492780884,38.11375319375582,38.18706617973348,38.36585054569662,38.30410130220447,38.24168215776118,38.24279705828219,38.47354841146068,38.52381861310308,38.60952075938021,38.59023283293397,38.73647707262621,38.77291199838165,38.99954254300737,39.14576550798347,39.33209589632163,39.3706461251765,39.44780991262252,39.55763858293558,39.53691363015286,39.43566083387706,39.27592943265062,39.19540926244486,39.05278920894602,39.01131224851649,38.86313586146008,38.76736172522195,38.72443064913186,38.52898831572178,38.38778118157348,38.21775083953796,38.138338731331,38.05954151738498,38.11587249949972,38.2142117657541,38.23691781984229,38.29156793941068,38.44557197454713,38.35986700225177,38.48176978326195,38.55186975742865,38.63501685773867,38.71851495139758,38.7916450101518,38.89285233732465,38.99554827201952,38.93434316987882,38.97131021765605,39.06299127652651,39.07624835266972,39.14623632731457,39.22502014424315,39.30612126866806,39.32131467317596,39.42326243714108,39.517661116768,39.60612517657451,39.60408306866731,39.69561189095351,39.61881776832298,39.62402062727183,39.52083965380521,39.51944347319182,39.58882798717875,39.46364373442996,39.46254657031805,39.33722077533277,39.20596056280304,39.72107658033247]}]],[[{"lng":[-85.630016,-85.566441,-85.501267,-85.487026,-85.630016],"lat":[45.598166,45.760222,45.754415,45.621211,45.598166]}],[{"lng":[-86.824828,-86.61944200000001,-86.485223,-86.356218,-86.24970999999999,-86.206834,-86.226305,-86.25464203824379,-86.3957470860834,-86.53849575180089,-86.43104262247574,-86.46313639700841,-86.51470284958705,-86.42987185911632,-86.2687110173477,-86.220697,-86.232482,-86.07350599999999,-86.066745,-85.9316,-85.80740299999999,-85.746444,-85.583198,-85.602034,-85.648932,-85.627982,-85.527216,-85.39579999999999,-85.366908,-85.371593,-85.209673,-85.032813,-85.040936,-85.119737,-84.910398,-84.77276500000001,-84.46168,-84.329537,-84.21526799999999,-84.109238,-83.90947199999999,-83.806622,-83.599273,-83.49670399999999,-83.422389,-83.271506,-83.399255,-83.443718,-83.320503,-83.273393,-83.314517,-83.332533,-83.54909600000001,-83.58409,-83.693214,-83.829077,-83.907388,-83.92937499999999,-83.909479,-83.647846,-83.417483,-83.34790700000001,-83.26152999999999,-83.046577,-82.915976,-82.738992,-82.633641,-82.6005,-82.539517,-82.52308600000001,-82.412965,-82.455027,-82.467483,-82.523337,-82.604686,-82.797318,-82.874416,-82.888413,-83.064121,-83.128022,-83.133511,-83.187246,-83.326024,-83.443364,-83.45383200000001,-84.3604163,-84.806082,-84.80588299999999,-85.791363,-86.824828],"lat":[41.76024,41.893827,42.118239,42.254166,42.480212,42.719424,42.988284,43.0834114143512,43.31622778857881,43.61750400245595,43.81597772464224,43.97097855851604,44.05812145732824,44.11978424479683,44.34532566041528,44.566742,44.70605,44.769803,44.905685,44.968788,44.949814,45.051229,45.071304,44.926743,44.87401,44.767508,44.748235,44.931018,45.116938,45.270834,45.356937,45.361251,45.436701,45.569026,45.75001,45.789301,45.652404,45.66438,45.634767,45.505171,45.485784,45.419159,45.352561,45.357536,45.290775,45.023417,45.070364,44.952247,44.880571,44.713901,44.608725,44.340464,44.227282,44.056748,43.98877,43.989095,43.918062,43.777091,43.672622,43.60426,43.841967,43.868595,43.973525,44.01571,44.070503,43.989506,43.831224,43.602935,43.437539,43.225361,42.977041,42.926866,42.76191,42.607486,42.548592,42.654032,42.523535,42.398237,42.317738,42.238839,42.088143,42.007573,41.924961,41.789118,41.732647,41.7066246,41.696089,41.760216,41.759051,41.76024]}],[{"lng":[-89.255202,-89.179154,-88.835714,-88.547033,-88.449502,-88.670073,-88.89918400000001,-89.05641199999999,-89.19016999999999,-89.255202],"lat":[47.876102,47.93503,48.056752,48.174891,48.163312,48.011446,47.9533,47.852598,47.831603,47.876102]}],[{"lng":[-90.41813917729506,-90.32762967100057,-90.02839372598264,-89.84865262916459,-89.67337509166374,-89.43704698204192,-89.24914293687034,-89.14259500705927,-88.99841704270847,-88.88914026275245,-88.65635951934765,-88.57399757992454,-88.418673,-88.18182,-87.978934,-87.80118400000001,-87.815371,-88.0548496994771,-88.21236169736443,-88.36762469788843,-88.44390171830993,-88.48374888280405,-88.43383591524743,-88.24443776603,-87.90033951059671,-87.63330022422221,-87.5732031123497,-87.38928983826618,-87.25873172795181,-87.0171356580677,-86.87515057887316,-86.68381857157482,-86.58616755518183,-86.49505357731829,-86.138295,-85.87790800000001,-85.482096,-85.25686,-84.95158000000001,-85.027513,-85.056133,-85.01521099999999,-84.800101,-84.63102000000001,-84.551496,-84.42027400000001,-84.111225,-84.14617200000001,-84.11817499999999,-84.02653599999999,-84.071741,-83.900535,-83.703861,-83.581315,-83.510623,-83.78610999999999,-83.881055,-84.11117400000001,-84.376429,-84.656567,-84.692735,-84.746985,-84.831396,-85.003597,-85.335911,-85.52157,-85.663966,-85.81044199999999,-85.926017,-86.196618,-86.32423160447149,-86.3638076756415,-86.51456968048191,-86.64843887282275,-86.71578076690328,-86.55554663684924,-86.78207960457974,-86.83874574633967,-87.07044181203584,-87.17224087094841,-87.46520129105237,-87.61201966754071,-87.59020889402154,-87.66121166008639,-87.74180478339126,-87.64812569962461,-87.86348804389395,-87.81297534230416,-87.78162281689535,-87.87981208187901,-87.99587622929327,-88.09404732268671,-88.10290849684124,-88.41691606195133,-88.50594889232578,-88.61640801743599,-88.77619017803478,-89.09163117521112,-90.12049111775639,-90.21659832049326,-90.41813917729506],"lat":[46.5660960507436,46.6077462581182,46.67439165044144,46.79571219934376,46.83322963629907,46.83951208910587,46.90332606405646,46.98485911737421,46.9953141024209,47.10057519780691,47.22562426517885,47.24598926943519,47.371188,47.457657,47.47942,47.473301,47.38479,47.29824023475494,47.20942322748759,47.01921318695898,46.97225118342656,46.83172717372678,46.79350216216179,46.92961215863519,46.90968610772986,46.81210705977679,46.72047104060036,46.52447201179263,46.48825500177353,46.53354997755111,46.43727995629994,46.49807893220936,46.46332391937302,46.52487390747793,46.672935,46.690914,46.680432,46.75338,46.769488,46.697451,46.52652,46.479712,46.446219,46.484868,46.418522,46.501077,46.504119,46.41852,46.233968,46.131648,46.092441,45.998918,46.103366,46.089613,45.929324,45.933375,45.968185,45.978675,45.931962,46.052654,46.027019,45.835597,45.872038,46.00613,46.092595,46.091257,45.967013,45.980087,45.932104,45.963185,45.9060799371489,45.79005695742816,45.75233696035689,45.61599198528032,45.68394897240791,45.81349895350184,45.86019495474653,45.7223069623406,45.71877895535512,45.66178795625659,45.27335136821917,45.12337790500008,45.09526501175184,45.10827993966435,45.19705163953785,45.33939626841903,45.35301993739966,45.46415884660095,45.67327991433583,45.75484284255523,45.79543471812698,45.78565751302004,45.9218685946868,45.97532233987192,46.01338442137229,45.98769984157602,46.01593157897741,46.13850555947864,46.33685360534932,46.50176120521122,46.5660960507436]}]],[[{"lng":[-91.166073,-91.08758899999999,-91.08287799999999,-91.228489,-91.219048,-91.160866,-91.084126,-91.05388600000001,-91.07088299999999,-91.010831,-91.08792099999999,-90.88895599999999,-90.94632300000001,-90.847808,-90.832407,-90.740889,-90.756197,-90.613944,-90.517168,-90.41486399999999,-90.250095,-90.30929736863703,-89.43495353317299,-88.2000643142902,-88.097888,-88.210741,-88.330934,-88.403789,-88.47322699999999,-88.43898,-88.39502299999999,-88.45381,-88.66382,-88.700587,-88.922031,-89.083237,-89.419348,-89.44790999999999,-89.52450399999999,-89.61705600000001,-89.629727,-89.68340999999999,-89.76813300000001,-89.84580099999999,-89.756333,-89.75264199999999,-90.38053600000001,-91.060213,-91.625118,-91.564397,-91.62599400000001,-91.51857800000001,-91.51581,-91.395715,-91.345714,-91.20101,-91.18831,-91.075908,-91.053175,-91.16282200000001,-91.164171,-91.04650700000001,-90.994293,-90.893653,-91.00450600000001,-91.029606,-91.11600799999999,-91.152699,-91.063946,-91.165328,-91.14500200000001,-91.21283699999999,-91.166073],"lat":[33.004106,33.145177,33.221621,33.564667,33.661503,33.707096,33.657322,33.778701,33.866714,33.925552,33.975335,34.029788,34.109374,34.20653,34.267491,34.306538,34.367256,34.390723,34.630928,34.831846,34.90732,34.99569217037419,34.99375262373799,34.99563395700627,34.892202,34.029199,33.073125,32.44977,31.893856,31.246896,30.369425,30.329626,30.362099,30.343689,30.393798,30.368097,30.25432,30.185352,30.180753,30.227495,30.339287,30.451793,30.51502,30.707314,30.943498,31.001853,30.999872,30.998953,30.999167,31.038965,31.116896,31.275283,31.530894,31.644165,31.842861,31.909159,31.960958,32.016828,32.124237,32.132694,32.196888,32.241149,32.213768,32.328095,32.368144,32.433542,32.48314,32.640757,32.702926,32.751301,32.84287,32.922104,33.004106]}]],[[{"lng":[-104.053127,-103.132955,-102.487329,-101.625424,-100.631728,-99.47135299999999,-98.49854999999999,-98.467356,-98.12903799999999,-98.035034,-97.950147,-97.84527,-97.68650599999999,-97.442279,-97.30667699999999,-97.131331,-96.982197,-96.687669,-96.710995,-96.501321,-96.445508,-96.380707,-96.40799800000001,-96.323723,-96.347752,-96.267318,-96.161756,-96.06966199999999,-96.117751,-96.089714,-95.93292099999999,-95.92599,-95.862587,-95.86349199999999,-95.812083,-95.888907,-95.789485,-95.76564500000001,-95.610439,-95.469718,-95.398667,-95.42164,-95.30829,-96.154365,-97.049663,-98.099659,-98.934792,-99.813401,-100.468773,-101.409953,-102.051744,-102.051614,-102.865784,-104.053249,-104.053026,-104.053127],"lat":[43.000585,43.000784,42.999559,42.996238,42.998092,42.997967,42.99856,42.947556,42.821228,42.764205,42.769619,42.867734,42.842435,42.846224,42.867604,42.771929,42.760554,42.653126,42.608128,42.482749,42.49063,42.446394,42.337408,42.229887,42.166806,42.110265,41.90182,41.803509,41.694221,41.531778,41.463798,41.195698,41.088399,40.99734,40.884239,40.731855,40.659388,40.585208,40.31397,40.227908,40.126419,40.058952,39.999998,40.000495,40.001323,40.002227,40.002205,40.0014,40.001724,40.002354,40.003078,41.002377,41.001988,41.001406,41.885464,43.000585]}]],[[{"lng":[-71.501088,-71.497917,-71.405636,-71.284396,-71.133994,-71.083924,-71.03103900000001,-70.98906700000001,-70.967229,-70.817865,-70.82680000000001,-70.703818,-70.817296,-70.93079899999999,-71.132503,-71.29420500000001,-72.458519,-72.542784,-72.534554,-72.44463500000001,-72.45689,-72.373126,-72.30286700000001,-72.184847,-72.116985,-72.03124,-72.067774,-72.033136,-71.812473,-71.59948,-71.551722,-71.62518,-71.49392,-71.501088],"lat":[45.013377,45.070589,45.198139,45.302434,45.244167,45.305451,44.655455,43.79244,43.343777,43.237911,43.127086,43.059825,42.87229,42.884589,42.821389,42.69699,42.726853,42.808482,42.949894,43.010566,43.146558,43.579419,43.702718,43.804698,43.99448,44.100101,44.270976,44.320365,44.358477,44.486455,44.627598,44.743978,44.910923,45.013377]}]],[[{"lng":[-109.045223,-108.249358,-107.4209219,-106.869796,-106.201469,-105.000554,-104.338833,-103.002199,-103.002434,-103.041924,-103.041554,-103.042781,-103.04395,-103.064625,-103.064423,-103.722882,-104.531756,-105.429281,-106.618486,-106.635926,-106.528242,-107.422495,-108.208394,-108.208573,-109.050044,-109.048286,-109.04748,-109.046662,-109.046182,-109.0460242,-109.046183,-109.045223],"lat":[36.999084,36.999015,37.000005,36.992426,36.994122,36.993264,36.993535,37.000104,36.500397,36.500439,35.6224876,34.850243,33.974629,32.999899,32.000518,32.0002084,32.000117,32.000577,32.000495,31.866235,31.783148,31.783599,31.783599,31.333395,31.332502,32.089114,33.06842,33.625055,34.522393,35.175508,36.181751,36.999084]}]],[[{"lng":[-83.10023335441541,-82.99205328524438,-82.78526698524442,-82.63226477038383,-82.54968174477989,-82.46065767562392,-82.40945764629376,-82.28945478142226,-82.14794789456325,-82.03314095142196,-81.90813701374843,-81.79526901255994,-81.69531101470699,-81.67753501956832,-80.837641,-80.295243,-79.51064700000001,-78.50996499999999,-77.749706,-76.9160603,-76.807078,-75.86704400000001,-75.899908,-76.020216,-75.923511,-75.910658,-76.07167200000001,-76.410878,-76.459316,-76.575936,-76.676484,-76.67386500000001,-76.52855099999999,-76.398242,-76.362966,-76.176585,-76.062071,-75.97783,-75.899382,-75.782498,-75.72668899999999,-75.72980200000001,-75.895045,-76.01139000000001,-76.14291,-76.606041,-76.50037500000001,-76.467776,-76.60042,-76.80142600000001,-76.76293099999999,-76.63507199999999,-76.502623,-76.277698,-76.44946400000001,-76.54934299999999,-76.770044,-77.031105,-77.20916099999999,-77.582323,-77.74013600000001,-77.82920900000001,-77.946568,-78.01868899999999,-78.17771999999999,-78.38396400000001,-78.541087,-79.249763,-79.675299,-80.797543,-80.782042,-80.93495,-81.04362500000001,-82.27491989115249,-82.46009186964524,-83.10861265487796,-83.61998460567887,-84.32186900027445,-84.29024013579988,-84.09750812877918,-84.02141020382483,-84.02150737416875,-83.88256333468769,-83.77173633448858,-83.49833409018919,-83.44580127084113,-83.31275692130252,-83.24066940389477,-83.10023335441541],"lat":[35.77474389157869,35.7739470133978,35.98792579083326,36.06570378150128,35.96427391833512,36.00780798085047,36.08340809347397,36.13570950894872,36.14951569561582,36.12042173131449,36.30201282986422,36.35784892640893,36.46791200695058,36.58811704734718,36.559118,36.543973,36.540738,36.541065,36.54552,36.5438366,36.550606,36.550754,36.482124,36.45862,36.367796,36.212157,36.140183,36.078034,36.024331,36.006167,36.043612,35.935089,35.944039,35.984317,35.942197,35.993267,35.993004,35.897181,35.977209,35.935615,35.811361,35.625985,35.573152,35.423084,35.32866,35.387113,35.321915,35.261213,35.067867,34.964369,34.920374,34.989116,35.007166,34.940014,34.814833,34.645585,34.696899,34.661184,34.605032,34.400506,34.272546,34.162618,33.912261,33.888289,33.914272,33.901946,33.851112,34.449774,34.804744,34.819786,34.935782,35.107409,35.149877,35.20007114368154,35.17814314822968,35.00065900853208,34.98659185539776,34.98840805153525,35.2255717401201,35.24738188621541,35.30138298842436,35.40418305554469,35.51718196563755,35.56211818341909,35.56298161516078,35.61180352379554,35.65480856558812,35.72675881668433,35.77474389157869]}]],[[{"lng":[-84.806082,-84.3604163,-83.45383200000001,-83.066593,-82.934369,-82.85677,-82.721914,-82.616952,-82.48121399999999,-82.254678,-82.011966,-81.744755,-81.59974699999999,-81.442645,-81.01049,-80.90034199999999,-80.519425,-80.518693,-80.518991,-80.666917,-80.599194,-80.599895,-80.70460199999999,-80.740126,-80.86533900000001,-80.88036,-81.0239,-81.223581,-81.347567,-81.456143,-81.557547,-81.57024699999999,-81.678331,-81.756254,-81.78182,-81.844486,-82.035963,-82.217269,-82.182467,-82.188767,-82.29127099999999,-82.323999,-82.529579,-82.593673,-82.724846,-82.84718599999999,-82.894193,-83.03301399999999,-83.142836,-83.29419300000001,-83.36666099999999,-83.52095300000001,-83.668111,-83.77216,-83.859028,-83.978814,-84.07149099999999,-84.21290399999999,-84.304698,-84.509743,-84.632446,-84.75444899999999,-84.82015699999999,-84.814179,-84.8039175,-84.80217,-84.806082],"lat":[41.696089,41.7066246,41.732647,41.59534,41.514353,41.548262,41.516677,41.428425,41.381342,41.434441,41.515639,41.48715,41.560649,41.673255,41.853962,41.868912,41.977523,41.248855,40.638801,40.573664,40.482566,40.317669,40.154823,39.970793,39.753251,39.620706,39.552313,39.386062,39.34577,39.409274,39.338774,39.267675,39.273755,39.177276,38.964935,38.928746,39.025478,38.79568,38.708782,38.594984,38.578983,38.449268,38.405182,38.421809,38.5576,38.595166,38.756576,38.723805,38.625076,38.596588,38.658537,38.703045,38.628068,38.65815,38.756793,38.787104,38.770475,38.805707,39.006455,39.09366,39.07676,39.146658,39.10548,39.814212,40.3100936,40.800601,41.696089]}]],[[{"lng":[-123.5476615533855,-123.4308491483167,-123.2801677166332,-123.115904964552,-122.9041196848198,-122.8139986812455,-122.7638097786607,-122.6750074028913,-122.2489909610476,-122.1016733976475,-121.8113020698207,-121.7351023649386,-121.5331054017378,-121.0849345067017,-120.8556755444754,-120.6349697833227,-120.5058648605983,-120.2107562273095,-119.9657463059359,-119.6698788838362,-119.6233948457726,-119.2571515235973,-119.1261215735571,-118.9871307197809,-118.1261988917951,-116.9159895159247,-116.7826763747147,-116.5930042255921,-116.463504,-116.6737934415362,-116.7312162120355,-116.8479441182088,-116.8319900613254,-116.9347000525424,-117.0442170253468,-117.1441608436681,-117.2259315984773,-117.2426746212458,-117.056509759196,-116.8959309426188,-116.977350930472,-116.9344850428434,-117.0266341914282,-117.026652625457,-117.026195987366,-117.6259722061418,-118.6964090874737,-119.9991682755169,-121.0351954477332,-121.5808639984979,-122.3781904030287,-123.3475608413391,-124.2116038371603,-124.3562274487586,-124.4109799535862,-124.4351003627233,-124.3899703753659,-124.4167661688141,-124.5146599934813,-124.5524301707895,-124.4569049702401,-124.382446293102,-124.2335206747101,-124.1683785183346,-124.1223908480655,-124.0582705623718,-124.0667377213854,-123.9754217625318,-123.9390083383892,-123.9676362489628,-123.9333731986209,-124.0103532195526,-123.8548071621498,-123.5476615533855],"lat":[46.25910568715724,46.18182301238192,46.14483876415122,46.18526359195084,46.08372909897626,45.96097915143628,45.65713243368882,45.61803374316447,45.54774136304601,45.58351232135098,45.70675777207459,45.69403561921402,45.72653697189208,45.64788929575502,45.67154163231073,45.74584394305509,45.7000450236153,45.72594828087478,45.82436243904006,45.85686476277029,45.90563677913564,45.93992411064587,45.93285724849887,45.99985330034283,46.00028092452408,45.99541213798035,45.82537572037787,45.77854076806101,45.615785,45.32151079512442,45.13993373058788,45.02260162586546,44.9330067257977,44.78388088506026,44.74513985196488,44.54564686119396,44.47938895771377,44.39654799419318,44.23087401180819,44.15429507282817,44.08536400870452,44.02124900909228,43.80810400997638,43.02512767917776,41.99988853182847,41.99809962276262,41.99179279535032,41.99453972890072,41.99332258958397,41.99866789264352,42.00952002126983,41.99910918542329,41.99846223151689,42.11495564575788,42.25055223148871,42.44016926500475,42.5747642476324,42.66160025940647,42.73681269659229,42.84057425468589,43.00032012106394,43.27016960657409,43.55712995622797,43.80890163502836,44.10443855469397,44.65885676863834,44.83118085957513,45.145465983382,45.6619150263237,45.90779950098305,46.07166638135368,46.22351116685021,46.15733818204766,46.25910568715724]}]],[[{"lng":[-71.19564,-71.13288799999999,-71.12057,-71.343013,-71.271862,-71.19564],"lat":[41.67509,41.660102,41.497448,41.495615,41.623986,41.67509]}],[{"lng":[-71.860513,-71.79768300000001,-71.78699400000001,-71.79924200000001,-71.381401,-71.3817,-71.327896,-71.22479800000001,-71.38105,-71.409302,-71.418404,-71.483295,-71.860513],"lat":[41.320248,41.416709,41.655992,42.008065,42.018798,41.893199,41.780501,41.710498,41.727324,41.662643,41.472652,41.371722,41.320248]}]],[[{"lng":[-89.73309500089172,-89.68002902855974,-89.59400008709046,-89.61181915064232,-89.53182221247086,-89.53923218830384,-89.48542717558701,-89.41729305374206,-89.11753684070703,-88.05320605396949,-88.0324899968106,-88.0705327467148,-87.85320461445649,-87.11498316057822,-86.58990614255815,-86.33305106406416,-85.83217201902488,-85.48835291053624,-85.19537180662776,-84.54313831476176,-83.69071412901337,-83.675413105578,-82.88801284182095,-81.93414408323812,-81.67753501956832,-81.69531101470699,-81.79526901255994,-81.90813701374843,-82.03314095142196,-82.14794789456325,-82.28945478142226,-82.40945764629376,-82.46065767562392,-82.54968174477989,-82.63226477038383,-82.78526698524442,-82.99205328524438,-83.10023335441541,-83.24066940389477,-83.31275692130252,-83.44580127084113,-83.49833409018919,-83.77173633448858,-83.88256333468769,-84.02150737416875,-84.02141020382483,-84.09750812877918,-84.29024013579988,-84.32186900027445,-85.60516501577332,-86.86214737930814,-87.42861327924435,-88.20295931006918,-88.2000643142902,-89.43495353317299,-90.30929736863703,-90.20939741737486,-90.17360318285695,-90.06659106395834,-90.15886488405889,-90.07499188280219,-90.12944789528018,-89.91068698282115,-89.95027799601891,-89.81445599380437,-89.76568900257597,-89.65614700196173,-89.73309500089172],"lat":[36.00060498735579,36.08249152119139,36.12718782882031,36.30908665829651,36.33924482326221,36.49793373247038,36.49749072448476,36.49903258990225,36.50360143677081,36.49712804730289,36.54066125005746,36.67811794405326,36.63324647083262,36.64241335123491,36.6524856454422,36.64877793392042,36.6220458540943,36.61499380227968,36.62549809213424,36.5962771264572,36.58258061450596,36.60081360395027,36.59346054547688,36.59421292232201,36.58811704734718,36.46791200695058,36.35784892640893,36.30201282986422,36.12042173131449,36.14951569561582,36.13570950894872,36.08340809347397,36.00780798085047,35.96427391833512,36.06570378150128,35.98792579083326,35.7739470133978,35.77474389157869,35.72675881668433,35.65480856558812,35.61180352379554,35.56298161516078,35.56211818341909,35.51718196563755,35.40418305554469,35.30138298842436,35.24738188621541,35.2255717401201,34.98840805153525,34.98467800221,34.99195553481417,35.00279445154329,35.00802794331506,34.99563395700627,34.99375262373799,34.99569217037419,35.02654402953721,35.11807188179949,35.13598901678809,35.26257699842181,35.38415203214304,35.4419313493998,35.6175355856132,35.73849276751309,35.75994007486489,35.8912968932096,35.92580762418355,36.00060498735579]}]],[[{"lng":[-114.041723,-113.893261,-113.249159,-112.192976,-112.173352,-111.046689,-111.046723,-110.500718,-109.534926,-109.050076,-109.050615,-109.051512,-109.060062,-109.041762,-109.041865,-109.045223,-109.625668,-110.47019,-110.50069,-111.412784,-112.35769,-112.966471,-114.0506,-114.049677,-114.050485,-114.047079,-114.046555,-114.043176,-114.041396,-114.041723],"lat":[41.99372,41.988057,41.996203,42.001167,41.996568,42.001567,40.997959,40.994746,40.998143,41.000659,39.87497,39.126095,38.275489,38.16469,37.530726,36.999084,36.998308,36.997997,37.00426,37.0014777,37.001025,37.000219,37.000396,37.823645,38.499955,39.499943,39.996899,40.771675,41.219958,41.99372]}]],[[{"lng":[-75.66971100000001,-75.62433248450799,-75.24225617704285,-75.35245999999999,-75.439001,-75.562951,-75.60216800000001,-75.658379,-75.765401,-75.817387,-75.89729800000001,-75.970004,-76.02575299999999,-76.014251,-75.909586,-75.80304099999999,-75.689837,-75.66971100000001],"lat":[37.950796,37.99421133197634,38.02721055330088,37.87483,37.869335,37.736469,37.567107,37.451815,37.305596,37.193437,37.118037,37.128861,37.257407,37.331943,37.622671,37.762464,37.861817,37.950796]}],[{"lng":[-81.96829700000001,-81.92849699999999,-81.761752,-81.67821000000001,-81.560625,-81.362156,-81.225104,-81.112596,-80.947896,-80.784188,-80.705203,-80.552036,-80.475601,-80.299789,-80.25891900000001,-80.296138,-80.16220199999999,-80.00250699999999,-79.898426,-79.787542,-79.68967499999999,-79.649075,-79.53686999999999,-79.47663868187257,-79.31227667970465,-79.21059164027868,-79.12975751750555,-78.99399727652859,-78.86927636446102,-78.78803118995395,-78.60165495587587,-78.57190081630819,-78.40369643472282,-78.41942120248224,-78.34047890551993,-78.34708562203396,-77.82815587980679,-77.71951677781739,-77.56659372244408,-77.45767770202859,-77.5272798697046,-77.46261469214332,-77.34028442420626,-77.2214992678087,-77.11975617809924,-77.03169482922819,-77.03900270830759,-77.04229465999599,-77.1301973735434,-77.24700136172564,-77.32543909056157,-77.24007042327362,-77.01182409364628,-77.03068040834849,-76.96230865716518,-76.8387925684459,-76.61393566127093,-76.51654343565399,-76.23672500000001,-76.30748199999999,-76.30254499999999,-76.36232,-76.472392,-76.527188,-76.300144,-76.245283,-76.282555,-76.387112,-76.399659,-76.27126199999999,-76.42886900000001,-76.464471,-76.618252,-76.649869,-76.747632,-76.65689399999999,-76.586491,-76.387567,-76.297663,-76.095508,-75.996252,-75.86704400000001,-76.807078,-76.9160603,-77.749706,-78.50996499999999,-79.51064700000001,-80.295243,-80.837641,-81.67753501956832,-81.93414408323812,-82.88801284182095,-83.675413105578,-83.53191198711416,-83.42370695107591,-83.194597,-83.07259000000001,-82.879492,-82.822684,-82.72225400000001,-82.72209700000001,-82.498858,-82.350948,-81.96829700000001],"lat":[37.537798,37.360645,37.275713,37.201483,37.206663,37.337687,37.234874,37.278497,37.295872,37.394587,37.394618,37.473563,37.422949,37.508271,37.595499,37.691783,37.875122,37.992767,38.193045,38.273298,38.431439,38.591515,38.550917,38.45722827734036,38.41187629454701,38.49291329624842,38.65501720217282,38.85010199173786,38.76299119416846,38.88512312021457,38.96460311552549,39.03199505970398,39.16745096535858,39.25747590145475,39.35349185042926,39.46601176752456,39.13232942411334,39.32131467317596,39.30612126866806,39.22502014424315,39.14623632731457,39.07624835266972,39.06299127652651,38.97131021765605,38.93434316987882,38.85051209062014,38.7916450101518,38.71851495139758,38.63501685773867,38.59061774411034,38.44884983133206,38.331598053143,38.3745539888149,38.31162300662338,38.21407497419814,38.16347592520017,38.14858671780079,38.02656529296249,37.889174,37.81235,37.689,37.610368,37.665772,37.611315,37.561734,37.386839,37.319107,37.385061,37.160272,37.084544,36.969947,37.027547,37.119347,37.220914,37.150548,37.109843,37.02874,36.899547,36.968147,36.908817,36.922047,36.550754,36.550606,36.5438366,36.54552,36.541065,36.540738,36.543973,36.559118,36.58811704734718,36.59421292232201,36.59346054547688,36.60081360395027,36.6649835655294,36.66738458047518,36.739487,36.854589,36.889085,37.004128,37.057948,37.120168,37.227044,37.267077,37.537798]}]],[[{"lng":[-122.7699381130966,-122.6184650117469,-122.5379350643704,-122.3762584101499,-122.350740452907,-122.431034192973,-122.6073409210521,-122.6095670544504,-122.7699381130966],"lat":[48.22754803703148,48.29415851248351,48.01607228443009,48.034457426396,47.95323583501199,47.91473284410376,48.0309922454932,48.15185985201472,48.22754803703148]}],[{"lng":[-123.2030257854429,-123.0486514635737,-122.9182519103023,-122.7430489605802,-122.7712052575414,-122.9268999275521,-123.1194502745903,-123.2030257854429],"lat":[48.59617787872251,48.62100165866774,48.71350471113018,48.66199066259604,48.56242552692779,48.46087353758417,48.4925756906059,48.59617787872251]}],[{"lng":[-117.0323505245854,-117.0351780007083,-117.0424715266614,-117.0398226029407,-117.0398143721908,-117.0559841394647,-116.9846308775224,-116.9239585378294,-116.9595486133668,-116.9159895159247,-118.1261988917951,-118.9871307197809,-119.1261215735571,-119.2571515235973,-119.6233948457726,-119.6698788838362,-119.9657463059359,-120.2107562273095,-120.5058648605983,-120.6349697833227,-120.8556755444754,-121.0849345067017,-121.5331054017378,-121.7351023649386,-121.8113020698207,-122.1016733976475,-122.2489909610476,-122.6750074028913,-122.7638097786607,-122.8139986812455,-122.9041196848198,-123.115904964552,-123.2801677166332,-123.4308491483167,-123.5476615533855,-123.7242768347481,-123.9093134667038,-124.064632081431,-123.8942584169413,-124.022416498282,-124.0965181300198,-124.089287627116,-123.9916122589538,-124.1767443000677,-124.2363469679908,-124.3193760457857,-124.3559512132043,-124.4305426109196,-124.4897330509559,-124.625508178524,-124.6724235515182,-124.7041513061987,-124.6532423390174,-124.3808729197027,-124.2385809136805,-123.9810304819912,-123.702741815407,-123.5908374801198,-123.2486135290122,-123.1643988006348,-122.8776393634657,-122.7705576248313,-122.6363586922535,-122.5275919867334,-122.4884898604666,-122.51827542608,-122.4948798233999,-122.573735945593,-122.4441964817944,-122.3257311751166,-122.4298394840844,-122.3731387965289,-122.392043021478,-122.2317607946588,-122.3650771474828,-122.4087165266578,-122.5074355600134,-122.537353124033,-122.4252690340493,-122.5003068338991,-122.5358045206743,-122.6474447008564,-122.785666317034,-122.7580346260694,-121.7512520094164,-120.7166040724843,-120.0011992862898,-118.836619917367,-118.1973868818441,-117.0323505245854],"lat":[48.99918900098305,48.37087749579046,47.83900749602457,47.12726692538325,46.42542335781966,46.34552931752514,46.2927034109163,46.17091873450996,46.09905678429265,45.99541213798035,46.00028092452408,45.99985330034283,45.93285724849887,45.93992411064587,45.90563677913564,45.85686476277029,45.82436243904006,45.72594828087478,45.7000450236153,45.74584394305509,45.67154163231073,45.64788929575502,45.72653697189208,45.69403561921402,45.70675777207459,45.58351232135098,45.54774136304601,45.61803374316447,45.65713243368882,45.96097915143628,46.08372909897626,46.18526359195084,46.14483876415122,46.18182301238192,46.25910568715724,46.30115868155074,46.24548850785368,46.32689722750375,46.53702795389269,46.70897385140877,46.74620310003215,46.86771762529693,46.98021685820267,47.09300157701407,47.28728998621656,47.35556195922145,47.54570075787646,47.74625107706417,47.81698983024206,47.887964033499,47.96441455559354,48.18442221038234,48.39069105396416,48.28469906860872,48.26247102451044,48.16476108690699,48.16678313135785,48.13494932485484,48.11574544307804,48.16589434495079,48.04702537115175,48.05343228052055,47.86618674175296,47.90588272007641,47.74360642124289,47.65132145903197,47.51026666118123,47.31842040044843,47.26672452732268,47.39152282378195,47.65892061759818,47.72922068217317,47.80771938085426,48.02987671106514,48.12582203104098,48.32641233358981,48.36466517426327,48.46674820254019,48.59952143256613,48.65616233256094,48.77612758534418,48.77399774501286,48.88506629849991,49.00235781112803,48.99739213553303,49.00018838095099,48.99941910732785,49.0003099209648,49.00040438320524,48.99918900098305]}]],[[{"lng":[-92.01529202552237,-91.8200281012282,-91.51107743585251,-91.22679748108288,-91.0965667051276,-90.83771779055827,-90.75455362629795,-90.88502261826943,-90.9055735202312,-90.75528856072235,-90.41813917729506,-90.21659832049326,-90.12049111775639,-89.09163117521112,-88.77619017803478,-88.61640801743599,-88.50594889232578,-88.41691606195133,-88.10290849684124,-88.09404732268671,-87.99587622929327,-87.87981208187901,-87.78162281689535,-87.81297534230416,-87.86348804389395,-87.64812569962461,-87.74180478339126,-87.66121166008639,-87.59020889402154,-87.63029960942781,-87.81952716026345,-87.82775378223747,-87.98349959256973,-88.00552207016864,-87.76577750936173,-87.61006554589106,-87.4062012426151,-87.26487852857116,-87.23822515335293,-87.03254714635233,-87.04821475168622,-87.18940915600179,-87.20454757929947,-87.30482687986768,-87.48370004151407,-87.54538569506427,-87.51966318035343,-87.64658529029875,-87.7361784886958,-87.70620316746619,-87.79013358849301,-87.79323725924827,-87.86504588767042,-87.91178432346759,-87.86648045668353,-87.88767919142838,-87.82327220817795,-87.76666800826347,-87.81466774515503,-87.80047145187332,-88.78667984515161,-90.07367017448281,-90.64284274974769,-90.72020858539626,-90.95241453512696,-91.05127453083502,-91.10056456695511,-91.14617661334533,-91.17793195221209,-91.05791023057573,-91.20184704025498,-91.21770573392232,-91.26874771490301,-91.24413452530545,-91.28413745860703,-91.44053617652317,-91.58260452360442,-91.71059722323248,-91.87515781773405,-91.92558930859798,-92.05354835934803,-92.21516239100986,-92.34756605626244,-92.51835729594677,-92.80798785897669,-92.75064554900754,-92.79152884901778,-92.74493889889301,-92.75871078403954,-92.64660151217133,-92.77022226508014,-92.88374848547087,-92.86919230447025,-92.78462003901365,-92.70770164661974,-92.64011495346482,-92.36214181507327,-92.29403385542996,-92.29219204847013,-92.21239237138037,-92.08949154345048,-92.01529202552237],"lat":[46.70647105134989,46.69017781480341,46.75745462267749,46.86361161428762,46.86153191110098,46.95744007997322,46.8982719076458,46.75634286237052,46.58352568349198,46.64629063390373,46.5660960507436,46.50176120521122,46.33685360534932,46.13850555947864,46.01593157897741,45.98769984157602,46.01338442137229,45.97532233987192,45.9218685946868,45.78565751302004,45.79543471812698,45.75484284255523,45.67327991433583,45.46415884660095,45.35301993739966,45.33939626841903,45.19705163953785,45.10827993966435,45.09526501175184,44.97686637242459,44.95110954653033,44.89122970582747,44.72019626325761,44.53921805190322,44.64202514680674,44.8383856706873,44.90449125739053,45.08136146402963,45.16725927323497,45.22227403193313,45.08912416282423,44.96863253881524,44.87559378929413,44.80460416593008,44.51135633396294,44.32138810953872,44.17987355676249,44.1046975277564,43.88042475839665,43.67954588967785,43.56305770082749,43.49278665454143,43.39357337960039,43.25040906423769,43.07441528621561,43.00051728519842,42.83532143267086,42.78489957947555,42.64402243126511,42.49192096008414,42.49198373021532,42.50827584499147,42.50848149348297,42.64075850611809,42.68677840268116,42.73700138032611,42.88307849741747,42.90985040028316,43.12887545615383,43.25396887481952,43.34910336201852,43.50055019010122,43.61534849734252,43.77466802335154,43.8470661899335,44.00150269835093,44.02738238639991,44.12048090615219,44.20057551382379,44.33354846917305,44.40137525563215,44.43850319680444,44.55714951509729,44.57518363735841,44.75147031146038,44.93729974532085,45.07964796229027,45.10831014944706,45.29096629178548,45.44163630931365,45.56693981616363,45.57548353804193,45.71756886783873,45.76419732222008,45.89490236855837,45.93247960097163,46.01310487782796,46.07437872398621,46.66604319301565,46.64994251088043,46.74924184454698,46.70647105134989]}]],[[{"lng":[-104.057698,-104.055488,-104.053127,-104.053026,-104.053249,-104.855273,-105.730421,-106.217573,-107.625624,-108.250649,-109.050076,-109.534926,-110.500718,-111.046723,-111.046689,-111.043564,-111.0452047,-111.048974,-111.055199,-110.705272,-110.199503,-109.103445,-109.08301,-108.271201,-107.13418,-106.2637151,-105.076601,-104.057698],"lat":[44.997431,43.853476,43.000585,41.885464,41.001406,40.998048,40.996886,40.997734,41.002124,41.000114,41.000659,40.998143,40.994746,40.997959,42.001567,42.722624,43.5010519,44.474072,45.001321,44.992324,44.996188,45.005904,44.99961,45.000251,45.000109,44.9937884,45.0003474,44.997431]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"white","weight":1,"opacity":1,"fill":true,"fillColor":["#FED471","#DB161F","#FEAE4A","#BC0026","#9D0026","#FFFCC5","#FD893A","#B20026","#FD7634","#FE9C42","#940026","#FE9C42","#F23D24","#FD6C31","#FFF3AF","#B20026","#FEDD7F","#FFFCC5","#FFC863","#940026","#BC0026","#EE3622","#FA4C29","#800026","#F64527","#EE3622","#FD7F37","#FD612F","#FED471","#FFEDA1","#940026","#B20026","#EE3622","#D51220","#FFFFCC","#FD9640","#E1191D","#FFE086","#FFC863","#FEDD7F","#FFEDA1","#FEA848","#FEA848","#FEBB56","#FFEA9A","#FFEDA1","#FEDD7F","#FE9C42","#FEDA78"],"fillOpacity":0.7,"smoothFactor":1,"noClip":false},["<strong>Alabama<\/strong><br/>Unemployment: 4.9%<br/>GDP Growth: -2.3%","<strong>Arizona<\/strong><br/>Unemployment: 7.4%<br/>GDP Growth: -1.3%","<strong>Colorado<\/strong><br/>Unemployment: 5.5%<br/>GDP Growth: 2.9%","<strong>Connecticut<\/strong><br/>Unemployment: 7.9%<br/>GDP Growth: 3.8%","<strong>Florida<\/strong><br/>Unemployment: 8.2%<br/>GDP Growth: 3.3%","<strong>Georgia<\/strong><br/>Unemployment: 3.7%<br/>GDP Growth: -0.3%","<strong>Idaho<\/strong><br/>Unemployment: 6.1%<br/>GDP Growth: -2.3%","<strong>Indiana<\/strong><br/>Unemployment: 8%<br/>GDP Growth: -0.7%","<strong>Kansas<\/strong><br/>Unemployment: 6.3%<br/>GDP Growth: -1.1%","<strong>Louisiana<\/strong><br/>Unemployment: 5.8%<br/>GDP Growth: 0.1%","<strong>Massachusetts<\/strong><br/>Unemployment: 8.3%<br/>GDP Growth: 0%","<strong>Minnesota<\/strong><br/>Unemployment: 5.8%<br/>GDP Growth: -1.3%","<strong>Missouri<\/strong><br/>Unemployment: 6.9%<br/>GDP Growth: 3%","<strong>Montana<\/strong><br/>Unemployment: 6.4%<br/>GDP Growth: 3.6%","<strong>Nevada<\/strong><br/>Unemployment: 4%<br/>GDP Growth: 1.8%","<strong>New Jersey<\/strong><br/>Unemployment: 8%<br/>GDP Growth: 2.2%","<strong>New York<\/strong><br/>Unemployment: 4.7%<br/>GDP Growth: 3.7%","<strong>North Dakota<\/strong><br/>Unemployment: 3.7%<br/>GDP Growth: 0.6%","<strong>Oklahoma<\/strong><br/>Unemployment: 5.1%<br/>GDP Growth: 2.7%","<strong>Pennsylvania<\/strong><br/>Unemployment: 8.3%<br/>GDP Growth: -0.7%","<strong>South Carolina<\/strong><br/>Unemployment: 7.9%<br/>GDP Growth: -1.6%","<strong>South Dakota<\/strong><br/>Unemployment: 7%<br/>GDP Growth: 2.8%","<strong>Texas<\/strong><br/>Unemployment: 6.7%<br/>GDP Growth: 4.2%","<strong>Vermont<\/strong><br/>Unemployment: 8.5%<br/>GDP Growth: 0.6%","<strong>West Virginia<\/strong><br/>Unemployment: 6.8%<br/>GDP Growth: 3.7%","<strong>Arkansas<\/strong><br/>Unemployment: 7%<br/>GDP Growth: 2.6%","<strong>California<\/strong><br/>Unemployment: 6.2%<br/>GDP Growth: 4.6%","<strong>Delaware<\/strong><br/>Unemployment: 6.5%<br/>GDP Growth: 2.1%","<strong>District of Columbia<\/strong><br/>Unemployment: 4.9%<br/>GDP Growth: -2.4%","<strong>Illinois<\/strong><br/>Unemployment: 4.2%<br/>GDP Growth: -1%","<strong>Iowa<\/strong><br/>Unemployment: 8.3%<br/>GDP Growth: 4.8%","<strong>Kentucky<\/strong><br/>Unemployment: 8%<br/>GDP Growth: -1.3%","<strong>Maine<\/strong><br/>Unemployment: 7%<br/>GDP Growth: 4.7%","<strong>Maryland<\/strong><br/>Unemployment: 7.5%<br/>GDP Growth: 1%","<strong>Michigan<\/strong><br/>Unemployment: 3.6%<br/>GDP Growth: 2.2%","<strong>Mississippi<\/strong><br/>Unemployment: 5.9%<br/>GDP Growth: 4.6%","<strong>Nebraska<\/strong><br/>Unemployment: 7.3%<br/>GDP Growth: 4.9%","<strong>New Hampshire<\/strong><br/>Unemployment: 4.6%<br/>GDP Growth: 4.3%","<strong>New Mexico<\/strong><br/>Unemployment: 5.1%<br/>GDP Growth: 4.5%","<strong>North Carolina<\/strong><br/>Unemployment: 4.7%<br/>GDP Growth: 1.2%","<strong>Ohio<\/strong><br/>Unemployment: 4.2%<br/>GDP Growth: -0.5%","<strong>Oregon<\/strong><br/>Unemployment: 5.6%<br/>GDP Growth: 0.4%","<strong>Rhode Island<\/strong><br/>Unemployment: 5.6%<br/>GDP Growth: -2.7%","<strong>Tennessee<\/strong><br/>Unemployment: 5.3%<br/>GDP Growth: -2%","<strong>Utah<\/strong><br/>Unemployment: 4.3%<br/>GDP Growth: -2.4%","<strong>Virginia<\/strong><br/>Unemployment: 4.2%<br/>GDP Growth: -2.4%","<strong>Washington<\/strong><br/>Unemployment: 4.7%<br/>GDP Growth: 1.7%","<strong>Wisconsin<\/strong><br/>Unemployment: 5.8%<br/>GDP Growth: 1.4%","<strong>Wyoming<\/strong><br/>Unemployment: 4.8%<br/>GDP Growth: 0.9%"],null,["Alabama: 4.9%","Arizona: 7.4%","Colorado: 5.5%","Connecticut: 7.9%","Florida: 8.2%","Georgia: 3.7%","Idaho: 6.1%","Indiana: 8%","Kansas: 6.3%","Louisiana: 5.8%","Massachusetts: 8.3%","Minnesota: 5.8%","Missouri: 6.9%","Montana: 6.4%","Nevada: 4%","New Jersey: 8%","New York: 4.7%","North Dakota: 3.7%","Oklahoma: 5.1%","Pennsylvania: 8.3%","South Carolina: 7.9%","South Dakota: 7%","Texas: 6.7%","Vermont: 8.5%","West Virginia: 6.8%","Arkansas: 7%","California: 6.2%","Delaware: 6.5%","District of Columbia: 4.9%","Illinois: 4.2%","Iowa: 8.3%","Kentucky: 8%","Maine: 7%","Maryland: 7.5%","Michigan: 3.6%","Mississippi: 5.9%","Nebraska: 7.3%","New Hampshire: 4.6%","New Mexico: 5.1%","North Carolina: 4.7%","Ohio: 4.2%","Oregon: 5.6%","Rhode Island: 5.6%","Tennessee: 5.3%","Utah: 4.3%","Virginia: 4.2%","Washington: 4.7%","Wisconsin: 5.8%","Wyoming: 4.8%"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"color":"#666","weight":3,"fillOpacity":0.9,"bringToFront":true}]},{"method":"addLegend","args":[{"colors":["#FFFFCC , #FFF3AF 8.16326530612245%, #FFCE6A 28.5714285714286%, #FD903D 48.9795918367347%, #EE3622 69.3877551020408%, #B20026 89.7959183673469%, #800026 "],"labels":["4","5","6","7","8"],"na_color":null,"na_label":"NA","opacity":0.7,"position":"bottomright","type":"numeric","title":"Unemployment Rate (%)","extra":{"p_1":0.08163265306122447,"p_n":0.8979591836734694},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[24.55867445176616,49.384358],"lng":[-124.7041513061987,-66.98240300000001]}},"evals":[],"jsHooks":[]}</script>
<p><strong>TIP:</strong> Interactive maps created with <code>leaflet</code> are great for presentations and can be easily embedded in websites or R Markdown HTML outputs!</p>
</div>
<div id="other-packages-for-map-generation" class="section level5 hasAnchor" number="3.3.2.2.8">
<h5><span class="header-section-number">3.3.2.2.8</span> Other packages for map generation<a href="m3.html#other-packages-for-map-generation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Besides the methods we’ve shown, there are several other alternatives in the <strong>R</strong> ecosystem for generating maps:</p>
<ul>
<li><strong>ggmap</strong>: Combines <code>ggplot2</code> with map tiles from Google Maps, OpenStreetMap, and others</li>
<li><strong>plotly</strong>: Can convert <code>ggplot2</code> maps to interactive versions using <code>ggplotly()</code></li>
<li><strong>mapview</strong>: Quick interactive viewing of spatial data</li>
<li><strong>tmap</strong>: Thematic maps with a grammar similar to <code>ggplot2</code> (though it may have compatibility issues in some environments)</li>
</ul>
</div>
</div>
</div>
<div id="exporting-geographic-data" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Exporting geographic data<a href="m3.html#exporting-geographic-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="writing-vector-data-files" class="section level4 hasAnchor" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> Writing vector data files<a href="m3.html#writing-vector-data-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Just as in reading vector data, the recommended package for writing data is <code>sf</code>. The function equivalent to <code>st_read()</code> regarding data writing is <code>st_write()</code>. There are several types of vector files that can be written: <code>ESRI Shapefile</code> the most common (file extension <code>shp</code>), <code>GPX</code>, <code>KML</code>, <code>GeoJSON</code> and <code>GPKG</code>.</p>
<p>See an example, writing a <em>shapefile</em> <code>.shp</code>:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="m3.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving as shapefile</span></span>
<span id="cb370-2"><a href="m3.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> shape_data_join2, </span>
<span id="cb370-3"><a href="m3.html#cb370-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;us_states_unemployment.shp&quot;</span>,</span>
<span id="cb370-4"><a href="m3.html#cb370-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>) <span class="co"># overwrites if it already exists</span></span>
<span id="cb370-5"><a href="m3.html#cb370-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-6"><a href="m3.html#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Or save as GeoJSON (more modern format)</span></span>
<span id="cb370-7"><a href="m3.html#cb370-7" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> shape_data_join2,</span>
<span id="cb370-8"><a href="m3.html#cb370-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">&quot;us_states_unemployment.geojson&quot;</span>,</span>
<span id="cb370-9"><a href="m3.html#cb370-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="writing-image-files" class="section level4 hasAnchor" number="3.3.3.2">
<h4><span class="header-section-number">3.3.3.2</span> Writing image files<a href="m3.html#writing-image-files" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To save static maps as images:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="m3.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save a ggplot map</span></span>
<span id="cb371-2"><a href="m3.html#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb371-3"><a href="m3.html#cb371-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-4"><a href="m3.html#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb371-5"><a href="m3.html#cb371-5" aria-hidden="true" tabindex="-1"></a>my_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> shape_data_join) <span class="sc">+</span></span>
<span id="cb371-6"><a href="m3.html#cb371-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> unemployment_rate)) <span class="sc">+</span></span>
<span id="cb371-7"><a href="m3.html#cb371-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb371-8"><a href="m3.html#cb371-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US Unemployment Rate by State&quot;</span>) <span class="sc">+</span></span>
<span id="cb371-9"><a href="m3.html#cb371-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb371-10"><a href="m3.html#cb371-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-11"><a href="m3.html#cb371-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as PNG</span></span>
<span id="cb371-12"><a href="m3.html#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;us_unemployment_map.png&quot;</span>, </span>
<span id="cb371-13"><a href="m3.html#cb371-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> my_map,</span>
<span id="cb371-14"><a href="m3.html#cb371-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, </span>
<span id="cb371-15"><a href="m3.html#cb371-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb371-16"><a href="m3.html#cb371-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-17"><a href="m3.html#cb371-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as PDF</span></span>
<span id="cb371-18"><a href="m3.html#cb371-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;us_unemployment_map.pdf&quot;</span>,</span>
<span id="cb371-19"><a href="m3.html#cb371-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> my_map,</span>
<span id="cb371-20"><a href="m3.html#cb371-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb371-21"><a href="m3.html#cb371-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-22"><a href="m3.html#cb371-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using base R for a base plot</span></span>
<span id="cb371-23"><a href="m3.html#cb371-23" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;us_unemployment_base.png&quot;</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="at">res =</span> <span class="dv">100</span>)</span>
<span id="cb371-24"><a href="m3.html#cb371-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(shape_data_join), </span>
<span id="cb371-25"><a href="m3.html#cb371-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> colors[shape_data_join<span class="sc">$</span>color_category],</span>
<span id="cb371-26"><a href="m3.html#cb371-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Unemployment Rate by State&quot;</span>)</span>
<span id="cb371-27"><a href="m3.html#cb371-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>You can also save interactive leaflet maps as HTML:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="m3.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb372-2"><a href="m3.html#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb372-3"><a href="m3.html#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="m3.html#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the leaflet map (as shown above)</span></span>
<span id="cb372-5"><a href="m3.html#cb372-5" aria-hidden="true" tabindex="-1"></a>my_leaflet_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(shape_leaflet) <span class="sc">%&gt;%</span></span>
<span id="cb372-6"><a href="m3.html#cb372-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb372-7"><a href="m3.html#cb372-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb372-8"><a href="m3.html#cb372-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(unemployment_rate),</span>
<span id="cb372-9"><a href="m3.html#cb372-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">1</span>,</span>
<span id="cb372-10"><a href="m3.html#cb372-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="dv">1</span>,</span>
<span id="cb372-11"><a href="m3.html#cb372-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb372-12"><a href="m3.html#cb372-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb372-13"><a href="m3.html#cb372-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;&lt;strong&gt;&quot;</span>, NAME, <span class="st">&quot;&lt;/strong&gt;&lt;br/&gt;&quot;</span>,</span>
<span id="cb372-14"><a href="m3.html#cb372-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;Unemployment: &quot;</span>, unemployment_rate, <span class="st">&quot;%&quot;</span>)</span>
<span id="cb372-15"><a href="m3.html#cb372-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb372-16"><a href="m3.html#cb372-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="at">pal =</span> pal, </span>
<span id="cb372-17"><a href="m3.html#cb372-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="sc">~</span>unemployment_rate,</span>
<span id="cb372-18"><a href="m3.html#cb372-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Unemployment Rate (%)&quot;</span>)</span>
<span id="cb372-19"><a href="m3.html#cb372-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-20"><a href="m3.html#cb372-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as HTML</span></span>
<span id="cb372-21"><a href="m3.html#cb372-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveWidget</span>(my_leaflet_map, </span>
<span id="cb372-22"><a href="m3.html#cb372-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">file =</span> <span class="st">&quot;us_unemployment_interactive.html&quot;</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="section-references-5" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Section References<a href="m3.html#section-references-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Lovelace, R.; Nowosad, J.; Muenchow, J. (2019). <em>Geocomputation with R</em>. CRC Press. Available at: <a href="https://geocompr.robinlovelace.net/">https://geocompr.robinlovelace.net/</a></p></li>
<li><p>Pebesma, E. (2018). Simple Features for R: Standardized Support for Spatial Vector Data. <em>The R Journal</em> 10 (1), 439-446, <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.</p></li>
<li><p>Wickham, H. (2016). <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. URL <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a></p></li>
<li><p>Cheng, J., Karambelkar, B., &amp; Xie, Y. (2021). <em>leaflet: Create Interactive Web Maps with Leaflet</em>. R package. URL <a href="https://rstudio.github.io/leaflet/">https://rstudio.github.io/leaflet/</a></p></li>
<li><p>Bivand, R. S., Pebesma, E., &amp; Gomez-Rubio, V. (2013). <em>Applied spatial data analysis with R</em> (Vol. 2, pp. 1-405). New York: Springer.</p></li>
</ul>
</div>
<div id="exercises-5" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Exercises<a href="m3.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Basic Mapping</strong>:
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Explore the <code>us_states</code> dataset from the <code>spData</code> package and identify other available variables (total_pop_15, median_income_15, etc).</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Create a map showing population density (total_pop_15/AREA) of US states using <code>ggplot2</code>.</li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>Add state abbreviations to your map using <code>geom_sf_text()</code>.</li>
</ol></li>
</ul></li>
<li><strong>Interactive Mapping</strong>:
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Create an interactive map using <code>leaflet</code> showing only the Southeast US region.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Add popup information showing state name, unemployment rate, and GDP growth.</li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>Try changing the base map tiles using <code>addProviderTiles()</code> (hint: try “CartoDB.Positron” or “Esri.WorldImagery”).</li>
</ol></li>
</ul></li>
<li><strong>Data Visualization</strong>:
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Download real unemployment data from the Bureau of Labor Statistics (<a href="https://www.bls.gov/data/">https://www.bls.gov/data/</a>) and create a map with real data.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Create a faceted map showing different regions of the US using <code>facet_wrap()</code> in <code>ggplot2</code>.</li>
</ol></li>
</ul></li>
<li><strong>Florida Focus</strong> (UNF special):
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Create a detailed map focused only on Florida using coordinate limits.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Add a marker for Jacksonville and the UNF campus location (30.2672° N, 81.5102° W).</li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li>Try to find and download Florida county-level shapefiles and create a county map.</li>
</ol></li>
<li><ol start="4" style="list-style-type: lower-alpha">
<li>Save your final map as both a static PNG (using <code>ggsave()</code>) and an interactive HTML file (using <code>saveWidget()</code>).</li>
</ol></li>
</ul></li>
<li><strong>Challenge</strong>:
<ul>
<li>Create a small multiples map showing unemployment rates for the four US Census regions separately.</li>
<li>Add annotations to highlight interesting patterns (e.g., highest/lowest unemployment states).</li>
<li>Customize the color palette to be colorblind-friendly using <code>scale_fill_viridis_c()</code>.</li>
</ul></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="m2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="m4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
